(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    304715,       6891]
NotebookOptionsPosition[    301407,       6776]
NotebookOutlinePosition[    301866,       6794]
CellTagsIndexPosition[    301823,       6791]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Van Kampen' s Linear Noise Approximation
for Nonlinear Stochastic Epidemiological Models\
\>", "Title",
 CellChangeTimes->{{3.503858301306882*^9, 3.503858304019342*^9}, {
  3.503858422964719*^9, 3.5038584609473124`*^9}, {3.50386841835328*^9, 
  3.503868438291895*^9}}],

Cell[CellGroupData[{

Cell["Load Packages", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.503858478421034*^9, 3.503858515546755*^9}, 
   3.503858602787837*^9, {3.508217638349742*^9, 3.5082176394116907`*^9}, {
   3.508556313091056*^9, 3.5085563142377033`*^9}, {3.509000529007238*^9, 
   3.509000529657003*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"<<", " ", "xlr8r.m"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.500814202956324*^9, 3.500814229773182*^9}}],

Cell[BoxData[
 StyleBox["\<\"xlr8r 0.78 (20 Sept 2010) loaded 10 April 2012 at 09:05 \
GMT+01:59 using Mathematica 7.0 for Mac OS X x86 (64-bit) (November 11, 2008) \
(Version 7., Release 0) (MathSBML 2.9.0 [8-Oct-2008])\\nGNU Lesser General \
Public License (LGPL) Terms Apply. \"\>",
  StripOnInput->False,
  FontWeight->Bold]], "Print",
 CellChangeTimes->{{3.543030332649881*^9, 3.543030334232724*^9}}]
}, Open  ]],

Cell[BoxData[""], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Set Directory", "Section",
 CellChangeTimes->{{3.505126867997034*^9, 3.5051269024984617`*^9}, {
  3.508555360895956*^9, 3.508555361505206*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "modelDir", "=", 
     "\"\</Users/tonton/Documents/Simulations/LNA/paper/gamma/I5R5/\>\""}], 
    ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
    "modelDir", "=", 
     "\"\</Users/tonton/Documents/Project/HPA/MCMC_project/\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "modelDir", "=", 
      "\"\</Users/tonton/Documents/Simulations/LNA/paper/endemic/\>\""}], 
     ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sourceDir", "=", 
     RowBox[{"modelDir", "<>", "\"\<src/\>\""}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dataDir", "=", 
     RowBox[{"modelDir", "<>", "\"\<data/\>\""}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.5051268304025793`*^9, 3.505126861805769*^9}, 
   3.505126893756118*^9, {3.5054630127641706`*^9, 3.505463079126287*^9}, {
   3.505473822750883*^9, 3.505473826046803*^9}, {3.5054751972803926`*^9, 
   3.505475202413393*^9}, {3.505483404134598*^9, 3.505483410008545*^9}, {
   3.5055347514188023`*^9, 3.505534756412405*^9}, {3.5057200674672337`*^9, 
   3.5057200688267803`*^9}, {3.508049876397798*^9, 3.5080498841632643`*^9}, {
   3.508217429474165*^9, 3.508217435476462*^9}, 3.51426180134937*^9, {
   3.515055334763256*^9, 3.51505535290458*^9}, {3.515060026206094*^9, 
   3.5150600277396793`*^9}, {3.5150606681142483`*^9, 
   3.5150606683121653`*^9}, {3.515062206949875*^9, 3.515062208012794*^9}, 
   3.515064383034627*^9, {3.515065464388962*^9, 3.515065465826088*^9}, {
   3.515131748806961*^9, 3.5151317493730793`*^9}, {3.515146412782428*^9, 
   3.51514641343779*^9}, {3.515162755275105*^9, 3.515162755856967*^9}, {
   3.515172645423277*^9, 3.515172646846122*^9}, {3.515183496573497*^9, 
   3.515183497551054*^9}, {3.515246390377314*^9, 3.515246390590734*^9}, {
   3.515246470419676*^9, 3.5152464723426847`*^9}, {3.51524654385118*^9, 
   3.515246544113055*^9}, {3.515262916625526*^9, 3.515262919413601*^9}, {
   3.515292718295599*^9, 3.515292720596891*^9}, {3.51529897006988*^9, 
   3.515298970932341*^9}, {3.5153234252712507`*^9, 3.515323425634367*^9}, {
   3.515752613883197*^9, 3.5157526518202257`*^9}, 3.5157529919070063`*^9, {
   3.517219020590363*^9, 3.517219061895253*^9}, {3.518971640787147*^9, 
   3.5189716559238043`*^9}, {3.519121738708563*^9, 3.5191217406436357`*^9}, {
   3.519211715661786*^9, 3.5192117179630136`*^9}, {3.519360178104042*^9, 
   3.519360179829789*^9}, {3.5193972922019777`*^9, 3.519397293962903*^9}, {
   3.521972523999578*^9, 3.521972525375024*^9}, {3.521976190721388*^9, 
   3.5219761934267063`*^9}, {3.521978767891964*^9, 3.521978768971897*^9}, {
   3.521978885997847*^9, 3.521978887435693*^9}, {3.538120581912179*^9, 
   3.538120587740876*^9}, {3.5420868923095293`*^9, 3.542086895642686*^9}}],

Cell[BoxData[""], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Basic Functions to Perform LNA and Moment-Closure", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.508555281538451*^9, 3.508555284413979*^9}, {
  3.508555337177281*^9, 3.5085553715282793`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getReactants", "[", 
     RowBox[{"reac_", ",", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "whichSide", ",", "myPlus", ",", "myTimes", ",", "u", ",", "v", ",", 
        "n", ",", "r", ",", "rAtom", ",", "i"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"whichSide", " ", "=", 
        RowBox[{"ToString", "[", " ", 
         RowBox[{
          RowBox[{"side", "/.", 
           RowBox[{"{", "opt", "}"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{"side", "\[Rule]", " ", "\"\<Left\>\""}], "}"}]}], "]"}]}],
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myTimes", "[", 
         RowBox[{
          RowBox[{"n_", "?", "IntegerQ"}], ",", "u_"}], "]"}], ":=", " ", 
        RowBox[{"{", 
         RowBox[{"u", ",", "n"}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myTimes", "[", 
         RowBox[{"u_", ",", 
          RowBox[{"n_", "?", "IntegerQ"}]}], "]"}], ":=", " ", 
        RowBox[{"{", 
         RowBox[{"u", ",", "n"}], "}"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myPlus", "[", 
         RowBox[{"u_", "?", "AtomQ"}], "]"}], ":=", " ", 
        RowBox[{"{", 
         RowBox[{"u", ",", "1"}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myPlus", "[", 
         RowBox[{"{", "}"}], "]"}], ":=", " ", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myPlus", "[", "]"}], ":=", " ", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myPlus", "[", 
         RowBox[{
          RowBox[{"u_", "?", "ListQ"}], ",", "v___"}], "]"}], ":=", " ", 
        RowBox[{"{", 
         RowBox[{"u", ",", 
          RowBox[{"myPlus", "[", "v", "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myPlus", "[", 
         RowBox[{
          RowBox[{"u_", "?", "AtomQ"}], ",", "v___"}], "]"}], ":=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"u", ",", "1"}], "}"}], ",", 
          RowBox[{"myPlus", "[", "v", "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"whichSide", "\[Equal]", "\"\<Right\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"r", "=", 
           RowBox[{
            RowBox[{"reac", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Times", "\[Rule]", " ", "myTimes"}], ",", 
              RowBox[{"Plus", "\[Rule]", " ", "myPlus"}]}], "}"}]}]}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"r", "=", 
           RowBox[{
            RowBox[{"reac", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Times", "\[Rule]", " ", "myTimes"}], ",", 
              RowBox[{"Plus", "\[Rule]", " ", "myPlus"}]}], "}"}]}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"r", "=", 
        RowBox[{"r", "/.", 
         RowBox[{"{", 
          RowBox[{"\[EmptySet]", "\[Rule]", 
           RowBox[{"{", "}"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"AtomQ", "[", "r", "]"}], ",", 
         RowBox[{
          RowBox[{"r", "=", 
           RowBox[{"{", 
            RowBox[{"r", ",", "1"}], "}"}]}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"r", "=", 
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", "r", "]"}], ",", "2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "r", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"StochMat", "[", 
     RowBox[{"model_", ",", "depReac_", ",", "minS_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "fullSystem", ",", "r", ",", "reactantNames", ",", "productNames", ",",
         " ", "nbRow", ",", "nbCol", ",", "rowk", ",", "reactants", ",", 
        "products", ",", "smat", ",", "i", ",", "j", ",", "k", ",", "S", ",", 
        "Sr", ",", "Sn", ",", "eL"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"{", "depReac", "}"}], "]"}], "\[Equal]", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"fullSystem", "=", "True"}], ",", 
         RowBox[{"fullSystem", "=", "False"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Off", "[", 
        RowBox[{"Part", "::", "partw"}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"r", "=", 
        RowBox[{"lowLevelReactions", "[", "model", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"reactants", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{"getReactants", ",", "r"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"products", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"getReactants", "[", 
            RowBox[{"#", ",", 
             RowBox[{"side", "\[Rule]", "\"\<Right\>\""}]}], "]"}], "&"}], 
          ",", "r"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"reactantNames", "=", 
        RowBox[{"Union", "[", 
         RowBox[{"Flatten", "[", "reactants", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"reactantNames", "=", 
        RowBox[{"Complement", "[", 
         RowBox[{"reactantNames", ",", 
          RowBox[{"Select", "[", 
           RowBox[{"reactantNames", ",", "NumberQ"}], "]"}]}], "]"}]}], ";", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Removes", " ", "potential", " ", "integers", " ", "in", " ", 
         "reactantNames"}], "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"productNames", " ", "=", " ", 
        RowBox[{"Union", "[", 
         RowBox[{"Flatten", "[", "products", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"productNames", "=", 
        RowBox[{"Complement", "[", 
         RowBox[{"productNames", ",", 
          RowBox[{"Select", "[", 
           RowBox[{"productNames", ",", "NumberQ"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"minS", "\[Equal]", "False"}], ",", 
         RowBox[{
          RowBox[{"reactantNames", "=", 
           RowBox[{"Union", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{"reactantNames", ",", "productNames"}], "}"}], "]"}], 
            "]"}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"??", 
         RowBox[{"??", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"reactantNames", "=", 
          RowBox[{"Union", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"reactantNames", ",", "productNames"}], "}"}], "]"}], 
           "]"}]}], ";"}], "\[IndentingNewLine]", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"nbRow", "=", 
        RowBox[{"Length", "[", "reactantNames", "]"}]}], ";", 
       "                    ", 
       StyleBox[
        RowBox[{"(*", " ", "rows", " ", "*)"}],
        FontWeight->"Plain"], 
       StyleBox[" ",
        FontWeight->"Plain"], "\[IndentingNewLine]", 
       RowBox[{"nbCol", "=", 
        RowBox[{"Length", "[", "reactants", "]"}]}], ";", 
       "                             ", 
       StyleBox[
        RowBox[{"(*", " ", "columns", " ", "*)"}],
        FontWeight->"Plain"], 
       StyleBox[" ",
        FontWeight->"Plain"], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"smat", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "nbRow"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "nbCol"}], "}"}]}], "]"}]}], ";", 
       StyleBox[
        RowBox[{"(*", " ", 
         RowBox[{"i", " ", "and", " ", "j", 
          RowBox[{"??", "?"}]}], " ", "*)"}],
        FontWeight->"Plain"], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"k", "=", "1"}], ",", 
         RowBox[{"k", "\[LessEqual]", "nbCol"}], ",", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "\[LessEqual]", 
             RowBox[{"Length", "[", 
              RowBox[{"reactants", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"rowk", "=", 
              RowBox[{
               RowBox[{"Flatten", "[", 
                RowBox[{"Position", "[", 
                 RowBox[{"reactantNames", ",", 
                  RowBox[{"reactants", "[", 
                   RowBox[{"[", 
                    RowBox[{"k", ",", "j", ",", "1"}], "]"}], "]"}]}], "]"}], 
                "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ";", 
             RowBox[{"smat", "=", 
              RowBox[{"ReplacePart", "[", 
               RowBox[{"smat", ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"rowk", ",", "k"}], "}"}], "->", 
                 RowBox[{
                  RowBox[{"smat", "[", 
                   RowBox[{"[", 
                    RowBox[{"rowk", ",", "k"}], "]"}], "]"}], "-", 
                  RowBox[{"reactants", "[", 
                   RowBox[{"[", 
                    RowBox[{"k", ",", "j", ",", "2"}], "]"}], "]"}]}]}]}], 
               "]"}]}], ";", 
             RowBox[{"j", "++"}]}]}], "]"}], ";", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "\[LessEqual]", 
             RowBox[{"Length", "[", 
              RowBox[{"products", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"rowk", "=", 
              RowBox[{
               RowBox[{"Flatten", "[", 
                RowBox[{"Position", "[", 
                 RowBox[{"reactantNames", ",", 
                  RowBox[{"products", "[", 
                   RowBox[{"[", 
                    RowBox[{"k", ",", "j", ",", "1"}], "]"}], "]"}]}], "]"}], 
                "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ";", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"NumberQ", "[", "rowk", "]"}], ",", 
               RowBox[{"smat", "=", 
                RowBox[{"ReplacePart", "[", 
                 RowBox[{"smat", ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"rowk", ",", "k"}], "}"}], "->", 
                   RowBox[{
                    RowBox[{"smat", "[", 
                    RowBox[{"[", 
                    RowBox[{"rowk", ",", "k"}], "]"}], "]"}], "+", 
                    RowBox[{"products", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j", ",", "2"}], "]"}], "]"}]}]}]}], 
                 "]"}]}]}], "]"}], ";", 
             RowBox[{"j", "++"}]}]}], "]"}], ";", 
          RowBox[{"k", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"S", "=", 
        RowBox[{"Evaluate", "[", "smat", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"fullSystem", "\[Equal]", "True"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "chose", " ", "reactant", " ", "to", " ", "eliminate", " ", 
           "according", " ", "to", " ", "their", " ", "order", " ", "in", " ",
            "the", " ", "List", " ", "reactantNames", " ", 
           RowBox[{"(", 
            RowBox[{"needed", " ", "to", " ", "compute", " ", "eL"}], ")"}]}],
           "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"j", "=", "2"}], ";", 
             RowBox[{"Sr", "=", 
              RowBox[{"{", 
               RowBox[{"S", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "}"}]}], ";", 
             RowBox[{"Sn", "=", 
              RowBox[{"{", "}"}]}], ";", 
             RowBox[{"k", "=", "2"}]}], ",", 
            RowBox[{"j", "\[LessEqual]", 
             RowBox[{"Length", "[", "S", "]"}]}], ",", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Last", "[", 
                  RowBox[{"Dimensions", "[", 
                   RowBox[{"Append", "[", 
                    RowBox[{"Sr", ",", 
                    RowBox[{"S", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], "]"}], 
                 "-", 
                 RowBox[{"Length", "[", 
                  RowBox[{"NullSpace", "[", 
                   RowBox[{"Append", "[", 
                    RowBox[{"Sr", ",", 
                    RowBox[{"S", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], "]"}]}], 
                "<", "k"}], ",", 
               RowBox[{"Sn", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"Sn", ",", 
                  RowBox[{"S", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"Sr", "=", 
                 RowBox[{"Append", "[", 
                  RowBox[{"Sr", ",", 
                   RowBox[{"S", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", 
                RowBox[{"k", "++"}]}]}], "]"}], ";", 
             RowBox[{"j", "++"}]}]}], "]"}], ";"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "choose", " ", "reactant", " ", "to", " ", "eliminate", " ", "to", 
           " ", "be", " ", "depReac"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"nbCol", "-", 
              RowBox[{"Length", "[", 
               RowBox[{"NullSpace", "[", "S", "]"}], "]"}]}], "\[Equal]", 
             "nbRow"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Sn", "=", 
              RowBox[{"{", "}"}]}], ";", 
             RowBox[{"Sr", "=", "S"}], ";"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"posDepReactant", "=", 
              RowBox[{"Flatten", "[", 
               RowBox[{"Position", "[", 
                RowBox[{"reactantNames", ",", "depReac"}], "]"}], "]"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"posDepReactant", "\[Equal]", 
                RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<WARNING: the compartment to remove doesn't exist! Retry \
LNA specifying a compartment among:\>\"", ",", "reactantNames"}], "]"}], ";", 
                
                RowBox[{"Abort", "[", "]"}], ";"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Sn", "=", 
                 RowBox[{"Take", "[", 
                  RowBox[{"S", ",", "posDepReactant"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"Sr", "=", 
                 RowBox[{"Drop", "[", 
                  RowBox[{"S", ",", "posDepReactant"}], "]"}]}], ";"}]}], 
              "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"eL", "=", 
        RowBox[{"smat", ".", 
         RowBox[{"Transpose", "[", "Sr", "]"}], ".", 
         RowBox[{"Inverse", "[", 
          RowBox[{"Sr", ".", 
           RowBox[{"Transpose", "[", "Sr", "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"Sr", ",", "Sn", ",", "eL", ",", "S"}], "}"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ReacMat", "[", 
     RowBox[{"model_", ",", "minS_"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "r", ",", "reactantNames", ",", "productNames", ",", " ", "nbRow", ",",
         "nbCol", ",", "k", ",", "reactants", ",", "products", ",", "vee"}], 
       "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r", "=", 
        RowBox[{"lowLevelReactions", "[", "model", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"reactants", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{"getReactants", ",", "r"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"products", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"getReactants", "[", 
            RowBox[{"#", ",", 
             RowBox[{"side", "\[Rule]", "\"\<Right\>\""}]}], "]"}], "&"}], 
          ",", "r"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"reactantNames", "=", 
        RowBox[{"Union", "[", 
         RowBox[{"Flatten", "[", "reactants", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"reactantNames", "=", 
        RowBox[{"Complement", "[", 
         RowBox[{"reactantNames", ",", 
          RowBox[{"Select", "[", 
           RowBox[{"reactantNames", ",", "NumberQ"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"productNames", " ", "=", " ", 
        RowBox[{"Union", "[", 
         RowBox[{"Flatten", "[", "products", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"productNames", "=", 
        RowBox[{"Complement", "[", 
         RowBox[{"productNames", ",", 
          RowBox[{"Select", "[", 
           RowBox[{"productNames", ",", "NumberQ"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"minS", "\[Equal]", "False"}], ",", 
         RowBox[{
          RowBox[{"reactantNames", "=", 
           RowBox[{"Union", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{"reactantNames", ",", "productNames"}], "}"}], "]"}], 
            "]"}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"nbRow", "=", 
        RowBox[{"Length", "[", "reactantNames", "]"}]}], ";", 
       "                    ", 
       StyleBox[
        RowBox[{"(*", " ", "rows", " ", "*)"}],
        FontWeight->"Plain"], 
       StyleBox[" ",
        FontWeight->"Plain"], "\[IndentingNewLine]", 
       RowBox[{"nbCol", "=", 
        RowBox[{"Length", "[", "reactants", "]"}]}], ";", 
       "                             ", 
       StyleBox[
        RowBox[{"(*", " ", "columns", " ", "*)"}],
        FontWeight->"Plain"], 
       StyleBox[" ",
        FontWeight->"Plain"], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"vee", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "nbCol"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"k", "=", "1"}], ",", 
         RowBox[{"k", "\[LessEqual]", "nbCol"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"vee", "=", 
           RowBox[{"ReplacePart", "[", 
            RowBox[{"vee", ",", 
             RowBox[{"Apply", "[", 
              RowBox[{"Times", ",", 
               RowBox[{"Append", "[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"reactants", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"reactants", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j", ",", "2"}], "]"}], "]"}]}], "]"}], 
                   ",", 
                   RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"reactants", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                 ",", 
                 RowBox[{"r", "[", 
                  RowBox[{"[", 
                   RowBox[{"k", ",", "2"}], "]"}], "]"}]}], "]"}]}], "]"}], 
             ",", "k"}], "]"}]}], ";", 
          RowBox[{"k", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"vee", ",", "reactantNames"}], "}"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5085553840174303`*^9, 3.508555413837572*^9}, {
   3.5189727017309017`*^9, 3.518972808384878*^9}, 3.518972878286021*^9, {
   3.5189730494454193`*^9, 3.518973069881339*^9}, {3.518973509984086*^9, 
   3.5189735452269907`*^9}, {3.51900847633066*^9, 3.519008484703102*^9}, {
   3.519008530469379*^9, 3.519008552408545*^9}, {3.5190086130219316`*^9, 
   3.519008625449259*^9}, {3.519008866494025*^9, 3.519008913386792*^9}, {
   3.5190089890911083`*^9, 3.5190090327510023`*^9}, {3.519009067988003*^9, 
   3.5190090947519913`*^9}, {3.51900914739506*^9, 3.5190091492092743`*^9}, {
   3.519011147360001*^9, 3.51901115982825*^9}, {3.5190113536205482`*^9, 
   3.519011363933566*^9}, {3.519011601980165*^9, 3.519011731738365*^9}, {
   3.5190118061996098`*^9, 3.5190118834691257`*^9}, {3.519012085339797*^9, 
   3.519012089234229*^9}, {3.519012752424267*^9, 3.519012786327561*^9}, {
   3.519012982472495*^9, 3.519013059424417*^9}, {3.5190131811108217`*^9, 
   3.519013193903687*^9}, {3.5190136413182497`*^9, 3.519013727498426*^9}, {
   3.519013950630684*^9, 3.519013959751479*^9}, {3.519014112918625*^9, 
   3.519014180176157*^9}, {3.54303271004353*^9, 3.5430327169643517`*^9}, {
   3.543032798486259*^9, 3.543032803802211*^9}, {3.543032847812415*^9, 
   3.543032854603039*^9}, {3.543032946971533*^9, 3.5430329475684958`*^9}, {
   3.543033164104063*^9, 3.543033180812099*^9}, {3.543033223826049*^9, 
   3.543033252078257*^9}, {3.543033315907686*^9, 3.543033323801532*^9}, {
   3.54303341953119*^9, 3.543033445368948*^9}, {3.543033551478224*^9, 
   3.543033582175867*^9}, {3.5430336408925037`*^9, 3.543033649188109*^9}, {
   3.5430338686586113`*^9, 3.5430338689665403`*^9}, {3.543033925423682*^9, 
   3.543033930043202*^9}, 3.54303417379095*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Advanced Functions to Build Models", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.5038585917691507`*^9, 3.503858618987981*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Functions", " ", "to", " ", "build", " ", "the", " ", "model"}], 
   " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Erl", "::", "usage"}], "=", 
     "\"\<Erl[{X->Y,k},N] describes a residence duration in the X state. It \
returns an Erlang distribution, with mean=1/k and shape=N, for the residence \
time in the X compartments by building N successive exponential transitions \
{X1->X2->..->Xn-1->Y1}, each with rate=Nk\>\""}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MassActErl", "::", "usage"}], "=", 
     "\"\<MassActErl[{\!\(\*OverscriptBox[\(X \[Rule] Y\), \
\(Z\)]\),k},\!\(\*SubscriptBox[\(N\), \(X\)]\),\!\(\*SubscriptBox[\(N\), \
\(Z\)]\)] describes an infection process of the hosts in the X state by the \
hosts in the Z state. Infected X hosts enter the Y state. Erlang distribution \
are allowed for the residence duration in the X and Z states.\>\""}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CreateModel", "::", "usage"}], "=", 
     "\"\<CreateModel[myModel] formats and returns myModel constructed with \
Erl and MassActErl functions to match standard syntax\>\""}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SubErlang", "[", 
     RowBox[{"x_", ",", "k_", ",", "index_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"ToExpression", "[", 
        RowBox[{
         RowBox[{"ToString", "[", "x", "]"}], "<>", " ", "\"\<e\>\"", "<>", 
         RowBox[{"ToString", "[", "index", "]"}]}], "]"}], "\[Rule]", " ", 
       RowBox[{"ToExpression", "[", 
        RowBox[{
         RowBox[{"ToString", "[", "x", "]"}], "<>", "\"\<e\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"index", "+", "1"}], "]"}], "]"}]}], "]"}]}], ",", "k"}], 
     "}"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Erl", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x_", "\[Rule]", "y_"}], ",", "k_"}], "}"}], ",", "shape_"}],
       "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"reac", ",", "index", ",", "newk"}], "}"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"shape", "\[Equal]", "1"}], ",", 
         RowBox[{"reac", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"ToExpression", "[", 
              RowBox[{
               RowBox[{"ToString", "[", "x", "]"}], "<>", "\"\<e1\>\""}], 
              "]"}], "\[Rule]", " ", 
             RowBox[{"ToExpression", "[", 
              RowBox[{
               RowBox[{"ToString", "[", "y", "]"}], "<>", "\"\<e1\>\""}], 
              "]"}]}], ",", "k"}], "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"newk", "=", 
           RowBox[{"shape", "*", "k"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"index", "=", 
           RowBox[{"Range", "[", 
            RowBox[{"shape", "-", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"reac", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"SubErlang", "[", 
               RowBox[{"x", ",", "newk", ",", "#"}], "]"}], "&"}], ",", 
             "index"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"reac", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"reac", ",", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"ToExpression", "[", 
                  RowBox[{
                   RowBox[{"ToString", "[", "x", "]"}], "<>", 
                   RowBox[{"ToString", "[", "shape", "]"}]}], "]"}], 
                 "\[Rule]", " ", 
                 RowBox[{"ToExpression", "[", 
                  RowBox[{
                   RowBox[{"ToString", "[", "y", "]"}], "<>", "\"\<e1\>\""}], 
                  "]"}]}], ",", "newk"}], "}"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "reac", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ErlGroup", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x_", "\[Rule]", "y_"}], ",", "k_"}], "}"}], ",", "shape_", 
       ",", "group__", ",", "kindex__"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "reac", ",", "allReac", ",", "index", ",", "newk", ",", "xVar", ",", 
         "yVar", ",", "rate", ",", "xVarIndex", ",", "yVarIndex", ",", 
         "rateIndex", ",", "xV", ",", "yV", ",", "rV"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xVar", "=", 
         RowBox[{"{", "x", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"yVar", "=", 
         RowBox[{"{", "y", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rate", "=", 
         RowBox[{"{", "k", "}"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "<=", 
           RowBox[{"Length", "[", "group", "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"xVar", "=", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Outer", "[", 
              RowBox[{"StringJoin", ",", "xVar", ",", 
               RowBox[{"group", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"yVar", "=", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Outer", "[", 
              RowBox[{"StringJoin", ",", "yVar", ",", 
               RowBox[{"group", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"kindex", ",", "i"}], "]"}], ",", 
             RowBox[{"rate", "=", 
              RowBox[{"Flatten", "[", 
               RowBox[{"Outer", "[", 
                RowBox[{"StringJoin", ",", "rate", ",", 
                 RowBox[{"group", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}]}], ",", 
             RowBox[{"rate", "=", 
              RowBox[{"Flatten", "[", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ConstantArray", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"group", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], "&"}], 
                 ",", "rate"}], "]"}], "]"}]}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", "xVar", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", "yVar", "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"allReac", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"Length", "[", "xVar", "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", 
          RowBox[{
           RowBox[{"xV", "=", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"xVar", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", 
           RowBox[{"yV", "=", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"yVar", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", 
           RowBox[{"rV", "=", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"rate", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"shape", "\[Equal]", "1"}], ",", 
             RowBox[{"reac", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"ToExpression", "[", 
                  RowBox[{
                   RowBox[{"ToString", "[", "xV", "]"}], "<>", "\"\<e1\>\""}],
                   "]"}], "\[Rule]", " ", 
                 RowBox[{"ToExpression", "[", 
                  RowBox[{
                   RowBox[{"ToString", "[", "yV", "]"}], "<>", "\"\<e1\>\""}],
                   "]"}]}], ",", "rV"}], "}"}]}], ",", "\[IndentingNewLine]", 
             
             RowBox[{
              RowBox[{"newk", "=", 
               RowBox[{"shape", "*", "rV"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"index", "=", 
               RowBox[{"Range", "[", 
                RowBox[{"shape", "-", "1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"reac", "=", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"SubErlang", "[", 
                   RowBox[{"xV", ",", "newk", ",", "#"}], "]"}], "&"}], ",", 
                 "index"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"reac", "=", 
               RowBox[{"Join", "[", 
                RowBox[{"reac", ",", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"ToExpression", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", "xV", "]"}], "<>", "\"\<e\>\"", "<>", 
                    RowBox[{"ToString", "[", "shape", "]"}]}], "]"}], 
                    "\[Rule]", " ", 
                    RowBox[{"ToExpression", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", "yV", "]"}], "<>", 
                    "\"\<e1\>\""}], "]"}]}], ",", "newk"}], "}"}], "}"}]}], 
                "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"allReac", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"allReac", ",", 
              RowBox[{"{", "reac", "}"}]}], "]"}]}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "allReac", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Erl2", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x_", "\[Rule]", "y_"}], ",", "p1_", ",", 
         RowBox[{"x_", "\[Rule]", "z_"}], ",", "p2_", ",", "k_"}], "}"}], ",",
        "shape_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "reac", ",", "reac1", ",", "reac2", ",", "index", ",", "newk"}], 
        "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"shape", "\[Equal]", "1"}], ",", 
         RowBox[{"reac", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"ToExpression", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", "x", "]"}], "<>", "\"\<e1\>\""}], 
                "]"}], "\[Rule]", " ", 
               RowBox[{"ToExpression", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", "y", "]"}], "<>", "\"\<e1\>\""}], 
                "]"}]}], ",", 
              RowBox[{"p1", "*", "k"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"ToExpression", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", "x", "]"}], "<>", "\"\<e1\>\""}], 
                "]"}], "\[Rule]", " ", 
               RowBox[{"ToExpression", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", "z", "]"}], "<>", "\"\<e1\>\""}], 
                "]"}]}], ",", 
              RowBox[{"p2", "*", "k"}]}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"newk", "=", 
           RowBox[{"shape", "*", "k"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"index", "=", 
           RowBox[{"Range", "[", 
            RowBox[{"shape", "-", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"reac", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"SubErlang", "[", 
               RowBox[{"x", ",", "newk", ",", "#"}], "]"}], "&"}], ",", 
             "index"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"reac", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"reac", ",", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"ToExpression", "[", 
                  RowBox[{
                   RowBox[{"ToString", "[", "x", "]"}], "<>", 
                   RowBox[{"ToString", "[", "shape", "]"}]}], "]"}], 
                 "\[Rule]", " ", 
                 RowBox[{"ToExpression", "[", 
                  RowBox[{
                   RowBox[{"ToString", "[", "y", "]"}], "<>", "\"\<e1\>\""}], 
                  "]"}]}], ",", 
                RowBox[{"p1", "*", "newk"}]}], "}"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"reac", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"reac", ",", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"ToExpression", "[", 
                  RowBox[{
                   RowBox[{"ToString", "[", "x", "]"}], "<>", 
                   RowBox[{"ToString", "[", "shape", "]"}]}], "]"}], 
                 "\[Rule]", " ", 
                 RowBox[{"ToExpression", "[", 
                  RowBox[{
                   RowBox[{"ToString", "[", "z", "]"}], "<>", "\"\<e1\>\""}], 
                  "]"}]}], ",", 
                RowBox[{"p2", "*", "newk"}]}], "}"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "reac", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SubMassActErl", "[", 
     RowBox[{
     "x_", ",", "y_", ",", "z_", ",", "k_", ",", "xindex_", ",", "zindex_"}], 
     "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      OverscriptBox[
       RowBox[{
        RowBox[{"ToExpression", "[", 
         RowBox[{
          RowBox[{"ToString", "[", "x", "]"}], "<>", "\"\<e\>\"", "<>", 
          RowBox[{"ToString", "[", "xindex", "]"}]}], "]"}], "\[Rule]", 
        RowBox[{"ToExpression", "[", 
         RowBox[{
          RowBox[{"ToString", "[", "y", "]"}], "<>", "\"\<e1\>\""}], "]"}]}], 
       
       RowBox[{"ToExpression", "[", 
        RowBox[{
         RowBox[{"ToString", "[", "z", "]"}], "<>", "\"\<e\>\"", "<>", 
         RowBox[{"ToString", "[", "zindex", "]"}]}], "]"}]], ",", 
      TagBox["k",
       DisplayForm]}], "}"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MassActErl", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         OverscriptBox[
          RowBox[{"x_", "\[Rule]", "y_"}], "z_"], ",", 
         TagBox["k_",
          DisplayForm]}], "}"}], ",", "xshape_", ",", "zshape_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "reac", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"reac", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"a", "=", "1"}], ",", 
          RowBox[{"a", "\[LessEqual]", "xshape"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "1"}], ",", 
             RowBox[{"j", "\[LessEqual]", "zshape"}], ",", 
             RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"reac", "=", 
               RowBox[{"Join", "[", 
                RowBox[{"reac", ",", 
                 RowBox[{"{", 
                  RowBox[{"SubMassActErl", "[", 
                   RowBox[{
                   "x", ",", "y", ",", "z", ",", "k", ",", "a", ",", "j"}], 
                   "]"}], "}"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";", 
           RowBox[{"a", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "reac", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Demo", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x_", "\[Rule]", "y_"}], ",", "k_"}], "}"}], ",", 
       "xshape_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "reac"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"reac", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"y", "\[Equal]", "\"\<\[EmptySet]\>\""}], ",", 
          RowBox[{"dest", "=", "\[EmptySet]"}], ",", 
          RowBox[{"dest", "=", " ", 
           RowBox[{"ToExpression", "[", 
            RowBox[{
             RowBox[{"ToString", "[", "y", "]"}], "<>", "\"\<1\>\""}], 
            "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"a", "=", "1"}], ",", 
          RowBox[{"a", "\[LessEqual]", "xshape"}], ",", 
          RowBox[{"a", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"reac", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"reac", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"ToExpression", "[", 
                  RowBox[{
                   RowBox[{"ToString", "[", "x", "]"}], "<>", " ", 
                   RowBox[{"ToString", "[", "a", "]"}]}], "]"}], "\[Rule]", 
                 " ", "dest"}], ",", "k"}], "}"}]}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "reac", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CreateModel", "[", "x__", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "model", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"model", "=", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", "x", "]"}], ",", "2"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "model", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BuildGroup", "[", 
      RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "<>", 
            RowBox[{"ToString", "[", "#", "]"}]}], "&"}], ",", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", "y"}], "]"}]}], "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GroupTransition", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"compX__", "->", "compY__"}], ",", "shape__"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x_", "\[Rule]", "y_"}], ",", "k_"}], "}"}], ",", "group__", 
       ",", "kindex__"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "myG", ",", "i", ",", "rate", ",", "tmp1", ",", "myGl", ",", "myGr", 
         ",", "allReac", ",", "xVar", ",", "yVar", ",", "xtmp", ",", "ytmp", 
         ",", "rtmp", ",", "tabReac", ",", "reac"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"which", " ", 
         RowBox[{"group", "?"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myG", "=", 
         RowBox[{"Union", "[", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{"Position", "[", 
                RowBox[{"Group", ",", "#"}], "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y"}], "}"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", "myG", "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "myG", "]"}], "\[NotEqual]", "1"}], ",", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<Only transitions within 1 group are allowed\>\"", "]"}], ";", 
           RowBox[{"Return", "[", "0", "]"}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp1", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"group", ",", "myG"}], "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"myGl", "=", 
         RowBox[{"Insert", "[", 
          RowBox[{"tmp1", ",", 
           RowBox[{"{", "x", "}"}], ",", "myG"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"myGr", "=", 
         RowBox[{"Insert", "[", 
          RowBox[{"tmp1", ",", 
           RowBox[{"{", "y", "}"}], ",", "myG"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", "myGr", "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"allReac", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"c", "=", "1"}], ",", 
          RowBox[{"c", "\[LessEqual]", 
           RowBox[{"Length", "[", "compX", "]"}]}], ",", 
          RowBox[{"c", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"xVar", "=", 
            RowBox[{"{", 
             RowBox[{"compX", "[", 
              RowBox[{"[", "c", "]"}], "]"}], "}"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"yVar", "=", 
            RowBox[{"{", 
             RowBox[{"compY", "[", 
              RowBox[{"[", "c", "]"}], "]"}], "}"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"rate", "=", 
            RowBox[{"{", "k", "}"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"i", "=", "1"}], ",", 
             RowBox[{"i", "\[LessEqual]", 
              RowBox[{"Length", "[", "myGl", "]"}]}], ",", 
             RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"xVar", "=", 
               RowBox[{"Flatten", "[", 
                RowBox[{"Outer", "[", 
                 RowBox[{"StringJoin", ",", "xVar", ",", 
                  RowBox[{"myGl", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"yVar", "=", 
               RowBox[{"Flatten", "[", 
                RowBox[{"Outer", "[", 
                 RowBox[{"StringJoin", ",", "yVar", ",", 
                  RowBox[{"myGr", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{"kindex", ",", "i"}], "]"}], ",", 
                RowBox[{"rate", "=", 
                 RowBox[{"Flatten", "[", 
                  RowBox[{"Outer", "[", 
                   RowBox[{"StringJoin", ",", "rate", ",", 
                    RowBox[{"myGl", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}]}], ",", 
                RowBox[{"rate", "=", 
                 RowBox[{"Flatten", "[", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"myGl", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], "&"}], 
                    ",", "rate"}], "]"}], "]"}]}]}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"xtmp", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"ytmp", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"rtmp", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"i", "=", "1"}], ",", 
             RowBox[{"i", "\[LessEqual]", 
              RowBox[{"shape", "[", 
               RowBox[{"[", "c", "]"}], "]"}]}], ",", 
             RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"xtmp", "=", 
               RowBox[{"Flatten", "[", 
                RowBox[{"Join", "[", 
                 RowBox[{"xtmp", ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "<>", "\"\<e\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}]}], "&"}], ",", 
                    "xVar"}], "]"}]}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"ytmp", "=", 
               RowBox[{"Flatten", "[", 
                RowBox[{"Join", "[", 
                 RowBox[{"ytmp", ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "<>", "\"\<e\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}]}], "&"}], ",", 
                    "yVar"}], "]"}]}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"rtmp", "=", 
               RowBox[{"Flatten", "[", 
                RowBox[{"Join", "[", 
                 RowBox[{"rtmp", ",", "rate"}], "]"}], "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"xtmp", "=", 
            RowBox[{"ToExpression", "[", "xtmp", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"ytmp", "=", 
            RowBox[{"ToExpression", "[", "ytmp", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"rtmp", "=", 
            RowBox[{"ToExpression", "[", "rtmp", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"tabReac", "=", 
              RowBox[{"Transpose", "[", 
               RowBox[{"{", 
                RowBox[{"xtmp", ",", "rtmp", ",", "ytmp"}], "}"}], "]"}]}], 
             ";"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"TableForm", "[", "tabReac", "]"}], "]"}], ";"}], 
            "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"reac", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"Length", "[", "tabReac", "]"}], "]"}], ";"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"i", "=", "1"}], ",", 
             RowBox[{"i", "\[LessEqual]", 
              RowBox[{"Length", "[", "xtmp", "]"}]}], ",", 
             RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"reac", "=", 
               RowBox[{"Join", "[", 
                RowBox[{"reac", ",", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"xtmp", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
                    RowBox[{"ytmp", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                    RowBox[{"rtmp", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "}"}], "}"}]}], "]"}]}],
               ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"allReac", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"allReac", ",", "reac"}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"Length", "[", "allReac", "]"}], "]"}], ";"}], "*)"}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "allReac", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GroupTransition2", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"compX__", "->", "compY1__"}], ",", 
         RowBox[{"compX__", "->", "compY2__"}], ",", "pY1_", ",", "shape__"}],
         "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x_", "\[Rule]", "y_"}], ",", "k_"}], "}"}], ",", "group__", 
       ",", "kindex__", ",", "pindex__"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "myG", ",", "i", ",", "rate", ",", "prob", ",", "tmp1", ",", "myGl", 
         ",", "myGr", ",", "allReac", ",", "xVar", ",", "y1Var", ",", "y2Var",
          ",", "xtmp", ",", "y1tmp", ",", "y2tmp", ",", "rtmp", ",", "ptmp", 
         ",", "tabReac", ",", "reac"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"which", " ", 
         RowBox[{"group", "?"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myG", "=", 
         RowBox[{"Union", "[", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{"Position", "[", 
                RowBox[{"Group", ",", "#"}], "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y"}], "}"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", "myG", "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "myG", "]"}], "\[NotEqual]", "1"}], ",", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<Only transitions within 1 group are allowed\>\"", "]"}], ";", 
           RowBox[{"Return", "[", "0", "]"}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp1", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"group", ",", "myG"}], "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"myGl", "=", 
         RowBox[{"Insert", "[", 
          RowBox[{"tmp1", ",", 
           RowBox[{"{", "x", "}"}], ",", "myG"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"myGr", "=", 
         RowBox[{"Insert", "[", 
          RowBox[{"tmp1", ",", 
           RowBox[{"{", "y", "}"}], ",", "myG"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", "myGr", "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"allReac", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"c", "=", "1"}], ",", 
          RowBox[{"c", "\[LessEqual]", 
           RowBox[{"Length", "[", "compX", "]"}]}], ",", 
          RowBox[{"c", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"xVar", "=", 
            RowBox[{"{", 
             RowBox[{"compX", "[", 
              RowBox[{"[", "c", "]"}], "]"}], "}"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"y1Var", "=", 
            RowBox[{"{", 
             RowBox[{"compY1", "[", 
              RowBox[{"[", "c", "]"}], "]"}], "}"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"y2Var", "=", 
            RowBox[{"{", 
             RowBox[{"compY2", "[", 
              RowBox[{"[", "c", "]"}], "]"}], "}"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"rate", "=", 
            RowBox[{"{", "k", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"prob", "=", 
            RowBox[{"{", "pY1", "}"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"i", "=", "1"}], ",", 
             RowBox[{"i", "\[LessEqual]", 
              RowBox[{"Length", "[", "myGl", "]"}]}], ",", 
             RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"xVar", "=", 
               RowBox[{"Flatten", "[", 
                RowBox[{"Outer", "[", 
                 RowBox[{"StringJoin", ",", "xVar", ",", 
                  RowBox[{"myGl", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"y1Var", "=", 
               RowBox[{"Flatten", "[", 
                RowBox[{"Outer", "[", 
                 RowBox[{"StringJoin", ",", "y1Var", ",", 
                  RowBox[{"myGr", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"y2Var", "=", 
               RowBox[{"Flatten", "[", 
                RowBox[{"Outer", "[", 
                 RowBox[{"StringJoin", ",", "y2Var", ",", 
                  RowBox[{"myGr", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{"kindex", ",", "i"}], "]"}], ",", 
                RowBox[{"rate", "=", 
                 RowBox[{"Flatten", "[", 
                  RowBox[{"Outer", "[", 
                   RowBox[{"StringJoin", ",", "rate", ",", 
                    RowBox[{"myGl", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}]}], ",", 
                RowBox[{"rate", "=", 
                 RowBox[{"Flatten", "[", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"myGl", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], "&"}], 
                    ",", "rate"}], "]"}], "]"}]}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{"pindex", ",", "i"}], "]"}], ",", 
                RowBox[{"prob", "=", 
                 RowBox[{"Flatten", "[", 
                  RowBox[{"Outer", "[", 
                   RowBox[{"StringJoin", ",", "prob", ",", 
                    RowBox[{"myGl", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}]}], ",", 
                RowBox[{"prob", "=", 
                 RowBox[{"Flatten", "[", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"myGl", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], "&"}], 
                    ",", "prob"}], "]"}], "]"}]}]}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"xtmp", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"y1tmp", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"y2tmp", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"rtmp", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"ptmp", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"i", "=", "1"}], ",", 
             RowBox[{"i", "\[LessEqual]", 
              RowBox[{"shape", "[", 
               RowBox[{"[", "c", "]"}], "]"}]}], ",", 
             RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"xtmp", "=", 
               RowBox[{"Flatten", "[", 
                RowBox[{"Join", "[", 
                 RowBox[{"xtmp", ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "<>", "\"\<e\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}]}], "&"}], ",", 
                    "xVar"}], "]"}]}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"y1tmp", "=", 
               RowBox[{"Flatten", "[", 
                RowBox[{"Join", "[", 
                 RowBox[{"y1tmp", ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "<>", "\"\<e\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}]}], "&"}], ",", 
                    "y1Var"}], "]"}]}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"y2tmp", "=", 
               RowBox[{"Flatten", "[", 
                RowBox[{"Join", "[", 
                 RowBox[{"y2tmp", ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "<>", "\"\<e\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}]}], "&"}], ",", 
                    "y2Var"}], "]"}]}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"rtmp", "=", 
               RowBox[{"Flatten", "[", 
                RowBox[{"Join", "[", 
                 RowBox[{"rtmp", ",", "rate"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"ptmp", "=", 
               RowBox[{"Flatten", "[", 
                RowBox[{"Join", "[", 
                 RowBox[{"ptmp", ",", "prob"}], "]"}], "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"xtmp", "=", 
            RowBox[{"ToExpression", "[", "xtmp", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"y1tmp", "=", 
            RowBox[{"ToExpression", "[", "y1tmp", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"y2tmp", "=", 
            RowBox[{"ToExpression", "[", "y2tmp", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"rtmp", "=", 
            RowBox[{"ToExpression", "[", "rtmp", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"ptmp", "=", 
            RowBox[{"ToExpression", "[", "ptmp", "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"tabReac", "=", 
              RowBox[{"Transpose", "[", 
               RowBox[{"{", 
                RowBox[{
                "xtmp", ",", "y1tmp", ",", "y2tmp", ",", "rtmp", ",", 
                 "ptmp"}], "}"}], "]"}]}], ";"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"TableForm", "[", "tabReac", "]"}], "]"}], ";"}], 
            "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"reac", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"Length", "[", "tabReac", "]"}], "]"}], ";"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"i", "=", "1"}], ",", 
             RowBox[{"i", "\[LessEqual]", 
              RowBox[{"Length", "[", "xtmp", "]"}]}], ",", 
             RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"reac", "=", 
               RowBox[{"Join", "[", 
                RowBox[{"reac", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"xtmp", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
                    RowBox[{"y1tmp", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"ptmp", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "*", 
                    RowBox[{"rtmp", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"xtmp", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
                    RowBox[{"y2tmp", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"ptmp", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "*", 
                    RowBox[{"rtmp", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}]}], "}"}]}], 
                "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"allReac", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"allReac", ",", "reac"}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"Length", "[", "allReac", "]"}], "]"}], ";"}], "*)"}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "allReac", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MassActErlGroup", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         OverscriptBox[
          RowBox[{"compX_", "\[Rule]", "compY_"}], "compZ_"], ",", 
         TagBox["k_",
          DisplayForm]}], "}"}], ",", "shapeX_", ",", "shapeZ_", ",", 
       "group__", ",", "kindex__"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "i", ",", "j", ",", "s1", ",", "s2", ",", "rate", ",", "allReac", ",",
          "xVar", ",", "yVar", ",", "zVar", ",", "ytmp", ",", "rtmp", ",", 
         "tabReac", ",", "reac"}], "}"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"allReac", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"xVar", "=", 
         RowBox[{"{", "compX", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"yVar", "=", 
         RowBox[{"{", "compY", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"zVar", "=", 
         RowBox[{"{", "compZ", "}"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"rate", "=", 
         RowBox[{"{", "\"\<\>\"", "}"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"Length", "[", "group", "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"xVar", "=", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Outer", "[", 
              RowBox[{"StringJoin", ",", "xVar", ",", 
               RowBox[{"group", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"yVar", "=", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Outer", "[", 
              RowBox[{"StringJoin", ",", "yVar", ",", 
               RowBox[{"group", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"zVar", "=", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Outer", "[", 
              RowBox[{"StringJoin", ",", "zVar", ",", 
               RowBox[{"group", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"kindex", ",", "i"}], "]"}], ",", 
             RowBox[{"rate", "=", 
              RowBox[{"Flatten", "[", 
               RowBox[{"Outer", "[", 
                RowBox[{"StringJoin", ",", "rate", ",", 
                 RowBox[{"group", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}]}], ",", 
             RowBox[{"rate", "=", 
              RowBox[{"Flatten", "[", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ConstantArray", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"group", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], "&"}], 
                 ",", "rate"}], "]"}], "]"}]}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", "xVar", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", "yVar", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", "zVar", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", "rate", "]"}], ";"}], "\[IndentingNewLine]", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"s1", "=", "1"}], ",", 
          RowBox[{"s1", "\[LessEqual]", "shapeX"}], ",", 
          RowBox[{"s1", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"s2", "=", "1"}], ",", 
             RowBox[{"s2", "\[LessEqual]", "shapeZ"}], ",", 
             RowBox[{"s2", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i", "=", "1"}], ",", 
                RowBox[{"i", "\[LessEqual]", 
                 RowBox[{"Length", "[", "xVar", "]"}]}], ",", 
                RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"For", "[", 
                  RowBox[{
                   RowBox[{"j", "=", "1"}], ",", 
                   RowBox[{"j", "\[LessEqual]", 
                    RowBox[{"Length", "[", "zVar", "]"}]}], ",", 
                   RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"rtmp", "=", 
                    RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"rtmp", "=", 
                    RowBox[{"ToExpression", "[", 
                    RowBox[{"StringJoin", "[", 
                    RowBox[{"k", ",", 
                    RowBox[{"rate", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"rate", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"allReac", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"allReac", ",", 
                    RowBox[{"{", 
                    RowBox[{"SubMassActErl", "[", 
                    RowBox[{
                    RowBox[{"xVar", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"yVar", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"zVar", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "rtmp", ",", "s1", 
                    ",", "s2"}], "]"}], "}"}]}], "]"}]}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "allReac", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"InfectionForce", "[", 
      RowBox[{
      "compI_", ",", "shapeI_", ",", "group__", ",", "k_", ",", "kindex__"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "i", ",", "j", ",", "ReplaceByLambda", ",", "ReplaceLambda", ",", 
         "allInfForce", ",", "lambda", ",", "Ivar", ",", "InfForce", ",", 
         "rateR", ",", "rateL", ",", "s1", ",", "rtmp"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"lambda", "=", 
         RowBox[{"{", "\"\<LAMBDA\>\"", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Ivar", "=", 
         RowBox[{"{", "compI", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rateR", "=", 
         RowBox[{"{", "\"\<\>\"", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rateL", "=", 
         RowBox[{"{", "\"\<\>\"", "}"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"Length", "[", "kindex", "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"lambda", "=", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Outer", "[", 
              RowBox[{"StringJoin", ",", "lambda", ",", 
               RowBox[{"group", "[", 
                RowBox[{"[", 
                 RowBox[{"kindex", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"rateL", "=", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Outer", "[", 
              RowBox[{"StringJoin", ",", "rateL", ",", 
               RowBox[{"group", "[", 
                RowBox[{"[", 
                 RowBox[{"kindex", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
             "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"lambda", "=", 
         RowBox[{"ToExpression", "[", "lambda", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", "lambda", "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"Length", "[", "group", "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Ivar", "=", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Outer", "[", 
              RowBox[{"StringJoin", ",", "Ivar", ",", 
               RowBox[{"group", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"kindex", ",", "i"}], "]"}], ",", 
             RowBox[{"rateR", "=", 
              RowBox[{"Flatten", "[", 
               RowBox[{"Outer", "[", 
                RowBox[{"StringJoin", ",", "rateR", ",", 
                 RowBox[{"group", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}]}], ",", 
             RowBox[{"rateR", "=", 
              RowBox[{"Flatten", "[", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ConstantArray", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"group", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], "&"}], 
                 ",", "rateR"}], "]"}], "]"}]}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", "Ivar", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", "rateR", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", "rateL", "]"}], ";"}], "\[IndentingNewLine]", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"allInfForce", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"Length", "[", "lambda", "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"InfForce", "=", "0"}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "1"}], ",", 
             RowBox[{"j", "\[LessEqual]", 
              RowBox[{"Length", "[", "Ivar", "]"}]}], ",", 
             RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"rtmp", "=", 
               RowBox[{"ToExpression", "[", 
                RowBox[{"StringJoin", "[", 
                 RowBox[{"k", ",", 
                  RowBox[{"rateL", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", 
                  RowBox[{"rateR", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"s1", "=", "1"}], ",", 
                RowBox[{"s1", "\[LessEqual]", "shapeI"}], ",", 
                RowBox[{"s1", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"InfForce", "=", 
                  RowBox[{"InfForce", "+", 
                   RowBox[{"rtmp", "*", 
                    RowBox[{"ToExpression", "[", 
                    RowBox[{
                    RowBox[{"Ivar", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "<>", "\"\<e\>\"", "<>", 
                    RowBox[{"ToString", "[", "s1", "]"}]}], "]"}]}]}]}], 
                 ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"allInfForce", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"allInfForce", ",", 
              RowBox[{"{", "InfForce", "}"}]}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"allInfForce", "=", 
         RowBox[{"FullSimplify", "[", "allInfForce", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", "allInfForce", "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"ReplaceByLambda", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"allInfForce", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "->", 
             RowBox[{"lambda", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "lambda", "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ReplaceLambda", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lambda", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "->", 
             RowBox[{"allInfForce", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "lambda", "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"ReplaceByLambda", "//", "TableForm"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"ReplaceLambda", "//", "TableForm"}], "]"}], ";"}], 
         "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"ReplaceLambda", ",", "ReplaceByLambda"}], "}"}], "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.500814271813665*^9, 3.5008143363201323`*^9}, {
   3.500814520998616*^9, 3.500814531347621*^9}, {3.5008146427526503`*^9, 
   3.5008147853239527`*^9}, {3.5008148167504063`*^9, 3.500815145189987*^9}, {
   3.500815179506674*^9, 3.500815557303664*^9}, {3.500815731105194*^9, 
   3.500815754144409*^9}, {3.500816086826592*^9, 3.500816090800301*^9}, {
   3.500816245525743*^9, 3.500816245957572*^9}, {3.5008162792474833`*^9, 
   3.50081631549997*^9}, {3.5008163601786346`*^9, 3.5008165493492413`*^9}, {
   3.5008166099259644`*^9, 3.5008166726969757`*^9}, {3.500816774088002*^9, 
   3.500816855126137*^9}, {3.500816891318595*^9, 3.500816935546069*^9}, {
   3.500819490326524*^9, 3.500819498484372*^9}, {3.5008196613949537`*^9, 
   3.500819664573565*^9}, {3.500819730010458*^9, 3.5008197370637417`*^9}, {
   3.500819995928565*^9, 3.500819996275041*^9}, {3.501777803703361*^9, 
   3.5017778355708313`*^9}, {3.501777991921041*^9, 3.501778114978097*^9}, {
   3.5017794659017677`*^9, 3.5017795102424927`*^9}, {3.501910191569336*^9, 
   3.501910246691819*^9}, {3.501910319611598*^9, 3.5019103303785973`*^9}, {
   3.501910367418435*^9, 3.501910415293529*^9}, 3.50191045615086*^9, {
   3.5019105407040358`*^9, 3.5019105943865223`*^9}, {3.501911092742502*^9, 
   3.501911118204817*^9}, {3.503857684774064*^9, 3.503857686289008*^9}, {
   3.503930474487253*^9, 3.503930635565263*^9}, {3.503931660963709*^9, 
   3.503931662715474*^9}, {3.5054704120907993`*^9, 3.505470519814392*^9}, {
   3.505471172986915*^9, 3.5054711912539186`*^9}, {3.537716698622364*^9, 
   3.537716758874707*^9}, 3.5377168139540167`*^9, 3.5377168597383327`*^9, {
   3.537716899783272*^9, 3.537716982996833*^9}, {3.537717027083125*^9, 
   3.537717028222234*^9}, {3.5377170685121927`*^9, 3.537717141110943*^9}, {
   3.537776430363604*^9, 3.537776431599124*^9}, {3.537780331632895*^9, 
   3.537780337129982*^9}, {3.53778340799708*^9, 3.537783521243572*^9}, {
   3.53778377073761*^9, 3.537783838749002*^9}, {3.537783916897633*^9, 
   3.537783946239012*^9}, {3.5377839888609*^9, 3.53778404557478*^9}, {
   3.537784787896863*^9, 3.537784873181946*^9}, {3.537784943713128*^9, 
   3.537785131700693*^9}, {3.537785240366652*^9, 3.53778524932381*^9}, {
   3.537785286271977*^9, 3.537785293917213*^9}, {3.5377858946914186`*^9, 
   3.537785907740382*^9}, {3.537786011995687*^9, 3.53778607291406*^9}, 
   3.537786237101925*^9, {3.53779425055949*^9, 3.53779425137197*^9}, {
   3.537795421268301*^9, 3.537795491014489*^9}, {3.537795531552105*^9, 
   3.537795535856657*^9}, {3.537798757515395*^9, 3.537798765956551*^9}, 
   3.5378021998638487`*^9, 3.537802419953271*^9, {3.537803123037793*^9, 
   3.537803144741935*^9}, {3.537803328707592*^9, 3.537803329574315*^9}, {
   3.537872959529936*^9, 3.537872991563015*^9}, {3.5378730836774063`*^9, 
   3.5378731419249763`*^9}, {3.537873183499406*^9, 3.5378732586181192`*^9}, {
   3.5378806647616568`*^9, 3.537880810855102*^9}, {3.537882275900167*^9, 
   3.537882289941659*^9}, {3.537882415868532*^9, 3.537882423786601*^9}, {
   3.537883479270224*^9, 3.5378835388559847`*^9}, {3.537884056534667*^9, 
   3.537884057177374*^9}, {3.537884191419437*^9, 3.537884193785638*^9}, {
   3.5378848416203136`*^9, 3.5378849007515173`*^9}, {3.537885495891815*^9, 
   3.537885502300173*^9}, {3.5378855529057713`*^9, 3.537885679084193*^9}, 
   3.537946518595881*^9, {3.537946573824342*^9, 3.5379465957163067`*^9}, {
   3.537946627226448*^9, 3.537946666054797*^9}, {3.537946706409905*^9, 
   3.5379467285824842`*^9}, {3.5381427744380493`*^9, 3.538142779886845*^9}, {
   3.538144164672535*^9, 3.538144170205257*^9}, {3.538222839719208*^9, 
   3.538222840658935*^9}, {3.538226942387911*^9, 3.538226945750682*^9}, {
   3.5383997192964287`*^9, 3.538399721564554*^9}, {3.538400308522791*^9, 
   3.53840031058259*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Other Useful Functions", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.5039315866416893`*^9, 3.503931621131475*^9}, {
  3.508555375718794*^9, 3.5085553793428097`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Aggregate", "[", 
     RowBox[{"name_", ",", "reacNames_", ",", "covMat_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"allClass", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ToExpression", "[", 
             RowBox[{"Union", "[", 
              RowBox[{"StringCases", "[", 
               RowBox[{
                RowBox[{"ToString", "[", "reacNames", "]"}], ",", 
                RowBox[{"#", "~~", 
                 RowBox[{"(", 
                  RowBox[{"x", ":", 
                   RowBox[{"DigitCharacter", ".."}]}], ")"}]}]}], "]"}], 
              "]"}], "]"}], "&"}], ",", "name"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"meanClass", "=", 
        RowBox[{"Total", "[", "allClass", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"vect", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"Length", "[", "reacNames", "]"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ind", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"reacNames", ",", "#"}], "]"}], "&"}], ",", "allClass"}],
           "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"vect", "[", 
         RowBox[{"[", "ind", "]"}], "]"}], "=", "1"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"varClass", "=", 
        RowBox[{"vect", ".", "covMat", ".", "vect"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"meanClass", ",", "varClass"}], "}"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"coefCorr", "[", 
     RowBox[{"lhs_", ",", "rhs_", ",", "reacNames_", ",", "covMat_"}], "]"}], 
    ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"allClassLhs", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ToExpression", "[", 
             RowBox[{"Union", "[", 
              RowBox[{"StringCases", "[", 
               RowBox[{
                RowBox[{"ToString", "[", "reacNames", "]"}], ",", 
                RowBox[{"#", "~~", 
                 RowBox[{"(", 
                  RowBox[{"x", ":", 
                   RowBox[{"DigitCharacter", ".."}]}], ")"}]}]}], "]"}], 
              "]"}], "]"}], "&"}], ",", "lhs"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"allClassRhs", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ToExpression", "[", 
             RowBox[{"Union", "[", 
              RowBox[{"StringCases", "[", 
               RowBox[{
                RowBox[{"ToString", "[", "reacNames", "]"}], ",", 
                RowBox[{"#", "~~", 
                 RowBox[{"(", 
                  RowBox[{"x", ":", 
                   RowBox[{"DigitCharacter", ".."}]}], ")"}]}]}], "]"}], 
              "]"}], "]"}], "&"}], ",", "rhs"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"vectLhs", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"Length", "[", "reacNames", "]"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"indLhs", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"reacNames", ",", "#"}], "]"}], "&"}], ",", 
           "allClassLhs"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"vectLhs", "[", 
         RowBox[{"[", "indLhs", "]"}], "]"}], "=", "1"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"varClassLhs", "=", 
        RowBox[{"vectLhs", ".", "covMat", ".", "vectLhs"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"vectRhs", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"Length", "[", "reacNames", "]"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"indRhs", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"reacNames", ",", "#"}], "]"}], "&"}], ",", 
           "allClassRhs"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"vectRhs", "[", 
         RowBox[{"[", "indRhs", "]"}], "]"}], "=", "1"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"varClassRhs", "=", 
        RowBox[{"vectRhs", ".", "covMat", ".", "vectRhs"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"covSum", "=", 
        RowBox[{"Total", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Extract", "[", 
           RowBox[{"covMat", ",", 
            RowBox[{"Tuples", "[", 
             RowBox[{"{", 
              RowBox[{"indLhs", ",", "indRhs"}], "}"}], "]"}]}], "]"}], "]"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"coef", "=", 
        RowBox[{"covSum", "/", 
         RowBox[{"(", 
          RowBox[{
           SqrtBox["varClassLhs"], "*", 
           SqrtBox["varClassRhs"]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "coef", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"lastClass", "[", 
     RowBox[{"name_", ",", "shape_"}], "]"}], ":=", 
    RowBox[{"ToExpression", "[", 
     RowBox[{
      RowBox[{"ToString", "[", "name", "]"}], "<>", 
      RowBox[{"ToString", "[", "shape", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"equiClass", "[", 
     RowBox[{"nameList_", ",", "shapeList_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "nameList", "]"}], "\[NotEqual]", 
          RowBox[{"Length", "[", "shapeList", "]"}]}], ",", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<ERROR: arg1 and arg2 differ in length!\>\"", 
           "]"}], ";", 
          RowBox[{"Abort", "[", "]"}], ";"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"replace", "=", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"i", "=", "1"}], ",", 
            RowBox[{"i", "\[LessEqual]", 
             RowBox[{"Length", "[", "nameList", "]"}]}], ",", 
            RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"replace", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"replace", ",", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"ToExpression", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"nameList", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "<>", " ", 
                    RowBox[{"ToString", "[", "k", "]"}]}], "]"}], "\[Rule]", 
                   " ", 
                   RowBox[{"ToExpression", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"nameList", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "<>", 
                    RowBox[{"ToString", "[", "1", "]"}]}], "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"k", ",", "2", ",", 
                    RowBox[{"shapeList", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}]}], 
               "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "replace", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"StableEquilibriumNSolve", "[", 
     RowBox[{"sysEDO_", ",", "variables_", ",", "param_", ",", "opt_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"dim", ",", "Jac"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dim", "=", 
        RowBox[{"Length", "[", "sysEDO", "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"Jac", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"sysEDO", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
              RowBox[{"variables", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "dim"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "dim"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"QSD", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"sysEDO", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "/.", 
           RowBox[{
            RowBox[{"sysEDO", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], "\[Rule]", "0"}]}], ",", 
          
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "dim"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"QSDnum", "=", 
        RowBox[{"FullSimplify", "[", 
         RowBox[{
          RowBox[{"QSD", "/.", "opt"}], "/.", "param"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"solQSDnum", "=", 
        RowBox[{"NSolve", "[", 
         RowBox[{"QSDnum", ",", "variables"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nSol", "=", 
        RowBox[{"Length", "[", "solQSDnum", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"EigenSol", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Eigenvalues", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Jac", "/.", 
              RowBox[{"solQSDnum", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "/.", "opt"}], "/.", 
            "param"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "nSol"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"vpMaxRe", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"Re", "[", 
            RowBox[{"Eigenvalues", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Jac", "/.", 
                RowBox[{"solQSDnum", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "/.", "opt"}], "/.", 
              "param"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "nSol"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"vpNeg", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"vpMaxRe", ",", 
          RowBox[{
           RowBox[{"Negative", "[", "#", "]"}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"vpNegPos", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"Negative", "[", "vpMaxRe", "]"}], ",", "True"}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"stableSol", "=", 
        RowBox[{"solQSDnum", "[", 
         RowBox[{"[", "vpNegPos", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<solQSDnum= \>\"", ",", 
         RowBox[{"TableForm", "[", "solQSDnum", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<EigenVal of sol:\>\"", ",", 
         RowBox[{"TableForm", "[", "EigenSol", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Max Re(eigenVal)= \>\"", ",", "vpMaxRe"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Stable solution: \>\"", ",", 
         RowBox[{"TableForm", "[", "stableSol", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "stableSol", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"StableEquilibriumLNAnSolve", "[", 
     RowBox[{
     "sysLNA_", ",", "idPOP_", ",", "idVAR_", ",", "param_", ",", "opt_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "dim", ",", "Jac", ",", "sysO1", ",", "QSDLNA", ",", "QSDO1", ",", 
        "QSDO1num", ",", "solO1num", ",", "nSol", ",", "EigenSol", ",", 
        "vpMaxRe", ",", "vpNeg", ",", "vpNegPos", ",", "stableSolO1", ",", 
        "QSDO2", ",", "QSDO2num", ",", "solO2num"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dim", "=", 
        RowBox[{"Length", "[", "idPOP", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sysO1", "=", 
        RowBox[{"Take", "[", 
         RowBox[{"sysLNA", ",", "dim"}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"Jac", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"sysO1", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
                RowBox[{"idPOP", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", "dim"}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "dim"}], "}"}]}], "]"}], "/.", 
          "opt"}], "/.", "param"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"QSDLNA", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"sysLNA", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "/.", 
           RowBox[{
            RowBox[{"sysLNA", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], "\[Rule]", "0"}]}], ",", 
          
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "sysLNA", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"QSDO1", "=", 
        RowBox[{"Take", "[", 
         RowBox[{"QSDLNA", ",", "dim"}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"QSDO1num", "=", 
        RowBox[{"FullSimplify", "[", 
         RowBox[{
          RowBox[{"QSDO1", "/.", "opt"}], "/.", "param"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<dim= \>\"", ",", "dim"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<sysO1:\>\"", ",", 
           RowBox[{"TableForm", "[", "sysO1", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Jac= \>\"", ",", 
           RowBox[{"MatrixForm", "[", "Jac", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<QSDO1: \>\"", ",", 
           RowBox[{"TableForm", "[", "QSDO1", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<QSDO1num: \>\"", ",", 
           RowBox[{"TableForm", "[", "QSDO1num", "]"}]}], "]"}], ";"}], 
        "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"solO1num", "=", 
        RowBox[{"NSolve", "[", 
         RowBox[{"QSDO1num", ",", 
          RowBox[{"idPOP", "/.", "opt"}], ",", 
          RowBox[{"WorkingPrecision", "\[Rule]", "30"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nSol", "=", 
        RowBox[{"Length", "[", "solO1num", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"EigenSol", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Eigenvalues", "[", 
           RowBox[{"Jac", "/.", 
            RowBox[{"solO1num", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "nSol"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"vpMaxRe", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"Re", "[", 
            RowBox[{"Eigenvalues", "[", 
             RowBox[{"Jac", "/.", 
              RowBox[{"solO1num", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "nSol"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"vpNeg", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"vpMaxRe", ",", 
          RowBox[{
           RowBox[{"Negative", "[", "#", "]"}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"vpNegPos", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"Negative", "[", "vpMaxRe", "]"}], ",", "True"}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"stableSolO1", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"solO1num", "[", 
          RowBox[{"[", "vpNegPos", "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<solO1num= \>\"", ",", 
           RowBox[{"TableForm", "[", "solO1num", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<EigenVal of solO1num:\>\"", ",", 
           RowBox[{"TableForm", "[", "EigenSol", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Max Re(eigenVal)= \>\"", ",", "vpMaxRe"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Stable solution: \>\"", ",", 
           RowBox[{"TableForm", "[", "stableSolO1", "]"}]}], "]"}], ";"}], 
        "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"stableSolO1", "\[Equal]", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"Return", "[", "stableSolO1", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"QSDO2", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Drop", "[", 
          RowBox[{"QSDLNA", ",", "dim"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"QSDO2num", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"FullSimplify", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"QSDO2", "/.", "opt"}], "/.", "param"}], "/.", 
           "stableSolO1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<stableSolO1: \>\"", ",", "stableSolO1"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<QSDO2: \>\"", ",", 
           RowBox[{"TableForm", "[", "QSDO2", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<QSDO2num: \>\"", ",", 
           RowBox[{"TableForm", "[", "QSDO2num", "]"}]}], "]"}], ";"}], 
        "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"solO2num", "=", 
        RowBox[{"NSolve", "[", 
         RowBox[{"QSDO2num", ",", 
          RowBox[{"Drop", "[", 
           RowBox[{"idVAR", ",", "dim"}], "]"}], ",", 
          RowBox[{"WorkingPrecision", "\[Rule]", "30"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"stableSolO1", ",", "solO2num"}], "}"}], "]"}], "]"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LNAtoMVN", "[", "model_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"replace", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "[", "model", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{"lowLevelReactions", "[", "myModel", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1", ",", "1"}], "]"}], "]"}], "]"}], 
             "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"x1", "=", 
              RowBox[{
               RowBox[{"lowLevelReactions", "[", "myModel", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1", ",", "1", ",", "1"}], "]"}], "]"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"x2", "=", 
              RowBox[{
               RowBox[{"lowLevelReactions", "[", "myModel", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1", ",", "1", ",", "2"}], "]"}], "]"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"replace", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"replace", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"x1", " ", "x2"}], "\[Rule]", " ", 
                  RowBox[{
                   RowBox[{"x1", " ", "x2"}], "+", " ", 
                   RowBox[{"ToExpression", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", "x1", "]"}], "<>", 
                    RowBox[{"ToString", "[", "x2", "]"}]}], "]"}]}]}], 
                 "}"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "replace", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"removeT", "[", "variables_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Mr", ",", "res"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Mr", "=", 
        RowBox[{"Length", "[", "variables", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ToExpression", "[", 
               RowBox[{"StringJoin", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"variables", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], ",", "\"\<'\>\"", 
                 ",", "\"\<[t]\>\""}], "]"}], "]"}], "->", 
              RowBox[{"ToExpression", "[", 
               RowBox[{"StringJoin", "[", 
                RowBox[{"\"\<d\>\"", ",", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"variables", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "]"}], "]"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", "Mr"}], "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"variables", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", "t", "]"}], "\[Rule]", 
              " ", 
              RowBox[{"variables", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", "Mr"}], "}"}]}], "]"}]}], "}"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "res", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"addT", "[", "variables_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Mr", ",", "res"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Mr", "=", 
        RowBox[{"Length", "[", "variables", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ToExpression", "[", 
               RowBox[{"StringJoin", "[", 
                RowBox[{"\"\<d\>\"", ",", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"variables", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "]"}], "]"}], 
              "\[Rule]", 
              RowBox[{"ToExpression", "[", 
               RowBox[{"StringJoin", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"variables", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], ",", "\"\<'\>\"", 
                 ",", "\"\<[t]\>\""}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", "Mr"}], "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"variables", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "\[Rule]", 
              RowBox[{
               RowBox[{"variables", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", "t", "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", "Mr"}], "}"}]}], "]"}]}], "}"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "res", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"reel", "[", "sol_", "]"}], ":=", 
   RowBox[{"Select", "[", 
    RowBox[{"sol", ",", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"MemberQ", "[", 
        RowBox[{"#1", ",", "__Complex", ",", "Infinity"}], "]"}]}], "&"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"complex", "[", "sol_", "]"}], ":=", 
    RowBox[{"Select", "[", 
     RowBox[{"sol", ",", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"#1", ",", "__Complex", ",", "Infinity"}], "]"}], "&"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MacroTransform", "[", 
     RowBox[{"variables_", ",", "popSize_"}], "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"variables", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{"variables", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "/", "popSize"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "variables", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MtoCparam", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Beta]", "\[Rule]", "betaM"}], ",", 
      RowBox[{"\[Epsilon]", "\[Rule]", "epsM"}], ",", 
      RowBox[{"\[Nu]", "\[Rule]", "nuM"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "gammaM"}], ",", 
      RowBox[{"\[Tau]", "\[Rule]", "tauM"}], ",", 
      RowBox[{"\[Mu]", "\[Rule]", "muM"}], ",", 
      RowBox[{"\[Sigma]", "->", "sigmaM"}], ",", 
      RowBox[{"\[CapitalOmega]", "\[Rule]", "popM"}], ",", 
      RowBox[{"\[Alpha]", "\[Rule]", "alphaM"}], ",", 
      RowBox[{"R0", "\[Rule]", "RzeroM"}], ",", 
      RowBox[{"m", "\[Rule]", "mM"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MtoLatex", "[", "param_", "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "->", 
        RowBox[{"TeXForm", "[", "#", "]"}]}], "&"}], ",", "param"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"seqVal", "[", 
     RowBox[{
     "minVal_", ",", "maxVal_", ",", "length_", ",", "digits_", ",", "log_"}],
      "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"min", ",", "max", ",", "di", ",", "vect"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"log", "==", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"min", "=", "minVal"}], ";", 
          RowBox[{"max", "=", "maxVal"}], ";"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"min", "=", 
           RowBox[{"Log", "[", 
            RowBox[{"10", ",", "minVal"}], "]"}]}], ";", 
          RowBox[{"max", "=", 
           RowBox[{"Log", "[", 
            RowBox[{"10", ",", "maxVal"}], "]"}]}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"di", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"max", "-", "min"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"length", "-", "1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"vect", "=", 
        RowBox[{"Range", "[", 
         RowBox[{"min", ",", "max", ",", "di"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"log", "\[NotEqual]", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"vect", "=", 
           RowBox[{"10", "^", "vect"}]}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Return", "[", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"NumberForm", "[", 
              RowBox[{
               RowBox[{"N", "[", "#", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"100", ",", "digits"}], "}"}]}], "]"}], "&"}], ",", 
            "vect"}], "]"}], "]"}], ";"}], "\[IndentingNewLine]", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"N", "[", "vect", "]"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"eqIncidence", "[", "list_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nbInc", "=", 
        RowBox[{"Length", "[", "list", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"incVect", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"eqVect", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", "nbInc"}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"shape", "=", 
           RowBox[{"Length", "[", 
            RowBox[{"list", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"newInc", "=", 
           RowBox[{"ToExpression", "[", 
            RowBox[{
             RowBox[{"ToString", "[", "INC", "]"}], "<>", " ", 
             RowBox[{"ToString", "[", "i", "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"newEq", "=", 
           RowBox[{
            RowBox[{"ToExpression", "[", 
             RowBox[{
              RowBox[{"ToString", "[", "dINC", "]"}], "<>", " ", 
              RowBox[{"ToString", "[", "i", "]"}]}], "]"}], "\[Equal]", 
            RowBox[{
             RowBox[{"list", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "shape", ",", "2"}], "]"}], "]"}], "*", 
             RowBox[{"list", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "shape", ",", "1", ",", "1"}], "]"}], 
              "]"}]}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"incVect", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"incVect", ",", 
             RowBox[{"{", "newInc", "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"eqVect", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"eqVect", ",", 
             RowBox[{"{", "newEq", "}"}]}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"incVect", ",", "eqVect"}], "}"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"eqIncidenceGroup", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x_", "\[Rule]", "y_"}], ",", "k_"}], "}"}], ",", "shapeX_", 
      ",", "group_", ",", "kIndex_", ",", "incIndex_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"xVar", ",", "rate", ",", "inc", ",", "tmp1", ",", "tmp2"}], 
       "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"xVar", "=", 
        RowBox[{"{", "x", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"rate", "=", 
        RowBox[{"{", "k", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"inc", "=", 
        RowBox[{"{", "\"\<INC\>\"", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "[", "group", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"xVar", "=", 
           RowBox[{"Flatten", "[", 
            RowBox[{"Outer", "[", 
             RowBox[{"StringJoin", ",", "xVar", ",", 
              RowBox[{"group", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"kIndex", ",", "i"}], "]"}], ",", 
            RowBox[{"rate", "=", 
             RowBox[{"Flatten", "[", 
              RowBox[{"Outer", "[", 
               RowBox[{"StringJoin", ",", "rate", ",", 
                RowBox[{"group", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}]}], ",", 
            RowBox[{"rate", "=", 
             RowBox[{"Flatten", "[", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ConstantArray", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"Length", "[", 
                    RowBox[{"group", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], "&"}], 
                ",", "rate"}], "]"}], "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"incIndex", ",", "i"}], "]"}], ",", 
            RowBox[{"inc", "=", 
             RowBox[{"Flatten", "[", 
              RowBox[{"Outer", "[", 
               RowBox[{"StringJoin", ",", "inc", ",", 
                RowBox[{"group", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}]}], ",", 
            RowBox[{"inc", "=", 
             RowBox[{"Flatten", "[", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ConstantArray", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"Length", "[", 
                    RowBox[{"group", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], "&"}], 
                ",", "inc"}], "]"}], "]"}]}]}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"xVar", "=", 
        RowBox[{"ToExpression", "[", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "<>", "\"\<e\>\"", "<>", 
             RowBox[{"ToString", "[", "shapeX", "]"}]}], "&"}], ",", "xVar"}],
           "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"rate", "=", 
        RowBox[{"shapeX", "*", 
         RowBox[{"ToExpression", "[", "rate", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tmp1", "=", 
        RowBox[{"xVar", "*", "rate"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"TODO", ":", " ", 
         RowBox[{"add", " ", "ERLANG"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", "xVar", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", "rate", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", "inc", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", "tmp1", "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"incVect", "=", 
        RowBox[{"Union", "[", "inc", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nbInc", "=", 
        RowBox[{"Length", "[", "incVect", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"eqVect", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", "nbInc"}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tmp2", "=", 
           RowBox[{"Flatten", "[", 
            RowBox[{"Position", "[", 
             RowBox[{"inc", ",", 
              RowBox[{"incVect", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"newEq", "=", 
           RowBox[{
            RowBox[{"ToExpression", "[", 
             RowBox[{"\"\<d\>\"", "<>", " ", 
              RowBox[{"ToString", "[", 
               RowBox[{"incVect", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], "\[Equal]", 
            RowBox[{"Simplify", "[", 
             RowBox[{"Total", "[", 
              RowBox[{"tmp1", "[", 
               RowBox[{"[", "tmp2", "]"}], "]"}], "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"eqVect", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"eqVect", ",", 
             RowBox[{"{", "newEq", "}"}]}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"incVect", ",", "eqVect"}], "}"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DefineInC", "[", 
     RowBox[{
     "compX__", ",", "shape__", ",", "group__", ",", "inc__", ",", "kname__", 
      ",", "kindex__"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "tmp", ",", "tmp1", ",", "define", ",", "define1", ",", "define2", ",",
         "define3", ",", "define4", ",", "define5", ",", "i", ",", "k", ",", 
        "kgroup", ",", "kVar", ",", "kinC", ",", "allVar", ",", "xVar", ",", 
        "Eindex"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"allVar", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"define", "=", 
          RowBox[{"{", "}"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"c", "=", "1"}], ",", 
         RowBox[{"c", "\[LessEqual]", 
          RowBox[{"Length", "[", "compX", "]"}]}], ",", 
         RowBox[{"c", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"xVar", "=", 
           RowBox[{"{", 
            RowBox[{"compX", "[", 
             RowBox[{"[", "c", "]"}], "]"}], "}"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"i", "=", "1"}], ",", 
            RowBox[{"i", "\[LessEqual]", 
             RowBox[{"Length", "[", "group", "]"}]}], ",", 
            RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"xVar", "=", 
              RowBox[{"Flatten", "[", 
               RowBox[{"Outer", "[", 
                RowBox[{"StringJoin", ",", "xVar", ",", 
                 RowBox[{"group", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Eindex", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\"\<e\>\"", "<>", 
               RowBox[{"ToString", "[", "#", "]"}]}], "&"}], ",", 
             RowBox[{"Range", "[", 
              RowBox[{"shape", "[", 
               RowBox[{"[", "c", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"xVar", "=", 
           RowBox[{"ToExpression", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Outer", "[", 
              RowBox[{"StringJoin", ",", "xVar", ",", "Eindex"}], "]"}], 
             "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"allVar", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"allVar", ",", "xVar"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", "allVar", "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"variable", " ", "y"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"define1", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"\"\<#define \>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"allVar", "[", 
              RowBox[{"[", "#", "]"}], "]"}], "]"}], "<>", "\"\< y[\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"#", "-", "1"}], "]"}], "<>", "\"\<]\\n\>\""}], "&"}], 
          ",", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "allVar", "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"define2", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"\"\<#define \>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"inc", "[", 
              RowBox[{"[", "#", "]"}], "]"}], "]"}], "<>", "\"\< y[\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"#", "-", "1", "+", 
              RowBox[{"Length", "[", "allVar", "]"}]}], "]"}], "<>", 
            "\"\<]\\n\>\""}], "&"}], ",", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "inc", "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"derivative", " ", "f"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"define3", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"\"\<#define \>\"", "<>", "\"\<d\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"allVar", "[", 
              RowBox[{"[", "#", "]"}], "]"}], "]"}], "<>", "\"\< f[\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"#", "-", "1"}], "]"}], "<>", "\"\<]\\n\>\""}], "&"}], 
          ",", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "allVar", "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"define4", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"\"\<#define \>\"", "<>", "\"\<d\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"inc", "[", 
              RowBox[{"[", "#", "]"}], "]"}], "]"}], "<>", "\"\< f[\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"#", "-", "1", "+", 
              RowBox[{"Length", "[", "allVar", "]"}]}], "]"}], "<>", 
            "\"\<]\\n\>\""}], "&"}], ",", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "inc", "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", "combine", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"define", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"define1", ",", "define2", ",", "define3", ",", "define4"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"k", "=", "1"}], ",", 
         RowBox[{"k", "\[LessEqual]", 
          RowBox[{"Length", "[", "kname", "]"}]}], ",", 
         RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"kgroup", "=", 
           RowBox[{"kindex", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"kVar", "=", 
           RowBox[{"{", 
            RowBox[{"kname", "[", 
             RowBox[{"[", "k", "]"}], "]"}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"kinC", "=", 
           RowBox[{"{", 
            RowBox[{"\"\<m->\>\"", "<>", 
             RowBox[{"kname", "[", 
              RowBox[{"[", "k", "]"}], "]"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"i", "=", "1"}], ",", 
            RowBox[{"i", "\[LessEqual]", 
             RowBox[{"Length", "[", "kgroup", "]"}]}], ",", 
            RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"tmp", "=", 
              RowBox[{"group", "[", 
               RowBox[{"[", 
                RowBox[{"kgroup", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"kVar", "=", 
              RowBox[{"Flatten", "[", 
               RowBox[{"Outer", "[", 
                RowBox[{"StringJoin", ",", "kVar", ",", "tmp"}], "]"}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"tmp1", "=", 
              RowBox[{"Flatten", "[", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\"\<[\>\"", "<>", 
                   RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<]\>\""}], 
                  "&"}], ",", 
                 RowBox[{"Flatten", "[", 
                  RowBox[{"Range", "[", 
                   RowBox[{"Length", "[", "tmp", "]"}], "]"}], "]"}]}], "]"}],
                "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"kinC", "=", 
              RowBox[{"Flatten", "[", 
               RowBox[{"Outer", "[", 
                RowBox[{"StringJoin", ",", "kinC", ",", "tmp1"}], "]"}], 
               "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"TableForm", "[", 
              RowBox[{"Transpose", "[", 
               RowBox[{"{", 
                RowBox[{"kVar", ",", "kinC"}], "}"}], "]"}], "]"}], "]"}], 
            ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"define5", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\"\<#define \>\"", "<>", 
               RowBox[{"kVar", "[", 
                RowBox[{"[", "#", "]"}], "]"}], "<>", "\"\< \>\"", "<>", 
               RowBox[{"kinC", "[", 
                RowBox[{"[", "#", "]"}], "]"}], "<>", "\"\<\\n\>\""}], "&"}], 
             ",", 
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "kVar", "]"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"define", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"define", ",", "define5"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"define", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<#define N_VAR_TOT\>\"", "<>", "\"\< \>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{
               RowBox[{"Length", "[", "allVar", "]"}], "+", 
               RowBox[{"Length", "[", "inc", "]"}]}], "]"}], "<>", 
             "\"\<\\n\>\""}], "}"}], ",", "define"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "define", "]"}], ";"}]}], "\[IndentingNewLine]",
      "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"setEqualQ", "[", 
    RowBox[{"set1_", ",", "set2_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "element", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"element", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"set1", ",", "#"}], "]"}], "&"}], ",", "set2"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{"Boole", "[", "element", "]"}], "]"}], "\[Equal]", 
        RowBox[{"Length", "[", "set1", "]"}], "\[Equal]", 
        RowBox[{"Length", "[", "set2", "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.503931652430071*^9, 3.5039316684356213`*^9}, {
   3.5039317352649307`*^9, 3.503931777167405*^9}, {3.504006475117003*^9, 
   3.504006540602824*^9}, {3.504006798161331*^9, 3.504006832689712*^9}, {
   3.5051090120221567`*^9, 3.505109179238134*^9}, {3.505109230953433*^9, 
   3.505109298286006*^9}, {3.505109382246744*^9, 3.505109416843199*^9}, {
   3.5051094520957527`*^9, 3.505109508427977*^9}, {3.5051095568848047`*^9, 
   3.505109583726145*^9}, {3.505110592783545*^9, 3.5051106242437162`*^9}, {
   3.505110671668599*^9, 3.5051109115667057`*^9}, {3.5051109574920597`*^9, 
   3.5051109657451982`*^9}, {3.505114349536834*^9, 3.5051144133246527`*^9}, {
   3.505114459405879*^9, 3.505114533639329*^9}, {3.505115348722878*^9, 
   3.505115581408637*^9}, {3.505115620812188*^9, 3.505115657355709*^9}, 
   3.505115731457777*^9, {3.505115822949164*^9, 3.505115827868964*^9}, {
   3.505116576887793*^9, 3.505116577447426*^9}, {3.5051266885856237`*^9, 
   3.505126690153006*^9}, {3.505133435333157*^9, 3.505133453084918*^9}, {
   3.505721653683106*^9, 3.5057216630913754`*^9}, {3.508220700755231*^9, 
   3.508220720794347*^9}, {3.508220997019558*^9, 3.508221206864019*^9}, {
   3.508221259642457*^9, 3.508221260728919*^9}, 3.508221299984314*^9, {
   3.508233003251686*^9, 3.508233193721431*^9}, {3.5082332242942266`*^9, 
   3.5082332438373623`*^9}, {3.508242665796986*^9, 3.508242667370145*^9}, {
   3.5082429804669867`*^9, 3.508242982351369*^9}, {3.50855718729802*^9, 
   3.5085573139110613`*^9}, {3.508557469430073*^9, 3.5085575005884457`*^9}, {
   3.508557540020686*^9, 3.50855768866395*^9}, {3.50855782410049*^9, 
   3.508557887122409*^9}, {3.508558134288465*^9, 3.508558138462493*^9}, {
   3.50855866170992*^9, 3.508558717776969*^9}, {3.508558750796769*^9, 
   3.5085588399085217`*^9}, {3.5085589225290947`*^9, 3.508558963089836*^9}, {
   3.5085593668776073`*^9, 3.5085593731676188`*^9}, {3.5085601686492443`*^9, 
   3.5085602222827578`*^9}, {3.5091054535914803`*^9, 3.509105455079126*^9}, {
   3.5091075759666243`*^9, 3.509107665340506*^9}, {3.51512807301173*^9, 
   3.5151281304482718`*^9}, {3.515128442220673*^9, 3.5151287936700706`*^9}, {
   3.515128825666894*^9, 3.515128843773323*^9}, {3.515128899068712*^9, 
   3.51512889967791*^9}, 3.515128945705866*^9, {3.51512918099055*^9, 
   3.515129214897251*^9}, {3.515129245829791*^9, 3.515129299671228*^9}, {
   3.515129461974975*^9, 3.515129487149781*^9}, {3.515130555718296*^9, 
   3.515130595383963*^9}, {3.515130647657531*^9, 3.515130650486668*^9}, {
   3.51513141076676*^9, 3.515131472951288*^9}, {3.5151315681800632`*^9, 
   3.515131569060789*^9}, {3.515137216264924*^9, 3.515137219871705*^9}, {
   3.5151413630745497`*^9, 3.515141364357573*^9}, {3.515142812432412*^9, 
   3.515142818230397*^9}, {3.5151428621947193`*^9, 3.5151428852086353`*^9}, {
   3.5151432193483667`*^9, 3.515143222266892*^9}, {3.515143351723795*^9, 
   3.515143378956753*^9}, {3.515143669194446*^9, 3.5151437138636503`*^9}, 
   3.515143777625208*^9, {3.515143817204527*^9, 3.515143852518837*^9}, {
   3.5151442085768223`*^9, 3.515144226886971*^9}, {3.5151442960984497`*^9, 
   3.5151442999271517`*^9}, {3.5151454756085873`*^9, 
   3.5151454777546883`*^9}, {3.515146547062976*^9, 3.515146559507414*^9}, {
   3.515146646450364*^9, 3.5151466612164717`*^9}, {3.51514673866543*^9, 
   3.51514674500703*^9}, {3.515154248042964*^9, 3.5151542541854258`*^9}, {
   3.5151544440565233`*^9, 3.5151544673163*^9}, {3.515154550104725*^9, 
   3.515154553175598*^9}, {3.515155005516841*^9, 3.515155011019969*^9}, {
   3.515155136404602*^9, 3.515155143060155*^9}, {3.515155366271298*^9, 
   3.5151553691571913`*^9}, {3.515155442258769*^9, 3.5151554446989937`*^9}, 
   3.5151586148227873`*^9, {3.515172948575107*^9, 3.5151729950938463`*^9}, {
   3.515173039479808*^9, 3.5151730503475924`*^9}, {3.5151730835164423`*^9, 
   3.5151730870981283`*^9}, {3.515173118300248*^9, 3.515173156741034*^9}, {
   3.515173191908737*^9, 3.5151731922325087`*^9}, {3.515761872915986*^9, 
   3.515761873875711*^9}, {3.515762300185762*^9, 3.51576234680964*^9}, {
   3.519018059261589*^9, 3.5190180634104843`*^9}, {3.521809618539432*^9, 
   3.521809623466984*^9}, {3.52180969318498*^9, 3.521809721465785*^9}, {
   3.521809790412545*^9, 3.521810069760973*^9}, {3.521810359155867*^9, 
   3.521810385526849*^9}, {3.521811932590822*^9, 3.521812026881817*^9}, {
   3.521812086952302*^9, 3.521812122720352*^9}, {3.5218122158565273`*^9, 
   3.521812280187544*^9}, {3.521812985902546*^9, 3.5218129978766747`*^9}, {
   3.5218131008612957`*^9, 3.5218131215517693`*^9}, {3.538220064430868*^9, 
   3.538220065358972*^9}, {3.538221682000169*^9, 3.5382216929002132`*^9}, {
   3.538221760657445*^9, 3.538221767834813*^9}, {3.538232586768313*^9, 
   3.538232587175486*^9}, {3.538394319796039*^9, 3.5383943206434183`*^9}, {
   3.538394391382955*^9, 3.538394407352644*^9}, {3.5383944991450033`*^9, 
   3.5383945240208673`*^9}, {3.5383946051427727`*^9, 
   3.5383946131058064`*^9}, {3.538394712281659*^9, 3.538394746117084*^9}, {
   3.538395397591234*^9, 3.538395401932266*^9}, {3.5383954860904617`*^9, 
   3.538395502912567*^9}, {3.53839555006131*^9, 3.538395561166546*^9}, {
   3.538395679721747*^9, 3.538395729479363*^9}, {3.538395765488494*^9, 
   3.538395903361155*^9}, 3.5383959617883377`*^9, {3.538396087916423*^9, 
   3.5383960899125843`*^9}, {3.538396176726966*^9, 3.538396242573151*^9}, {
   3.538396278291213*^9, 3.538396308858493*^9}, {3.538396340510689*^9, 
   3.538396549133607*^9}, {3.538396582333761*^9, 3.538396637261207*^9}, {
   3.538396670772332*^9, 3.538396734270035*^9}, {3.538396779111845*^9, 
   3.5383967840234623`*^9}, {3.5383968975972*^9, 3.5383969131603127`*^9}, 
   3.538396948135943*^9, {3.538396985226083*^9, 3.538397015347419*^9}, {
   3.542109048553166*^9, 3.5421090492346354`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Deterministic Model", "Section",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.50385865487392*^9, 3.5038586710568533`*^9}, {
  3.508581953660261*^9, 3.5085819697388773`*^9}, {3.538120900024852*^9, 
  3.538120903645667*^9}, {3.538120938213523*^9, 3.53812095733048*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DETER", "[", 
    RowBox[{"myModel_", ",", "myDepReac_", ",", "popSize_", ",", "minSys_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "fullSystem", ",", "P", ",", "Q", ",", "Rmat", ",", "lenRea", ",", 
       "lenR", ",", "j", ",", "k", ",", "Rr", ",", "Rn", ",", "ztab", ",", 
       "q", ",", "indReactants", ",", "indLink", ",", "depReactants", ",", 
       "depLink", ",", "indNot", ",", "depNot", ",", "depsubrhs", ",", 
       "depsub", ",", " ", "newNu", ",", " ", "Mr", ",", " ", "allReactants", 
       ",", " ", "posRedReactants", ",", "Amat", ",", " ", "addT", ",", 
       "removeT", ",", "AA", ",", "BB", ",", "sysEDO1", ",", "sysEDO2", ",", 
       "covMat", ",", "covEDO", ",", "covEDOtr", ",", "sysEDO3", ",", 
       "sysMath", ",", "variable"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"{", "myDepReac", "}"}], "]"}], "\[Equal]", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"fullSystem", "=", "True"}], ",", 
        RowBox[{"fullSystem", "=", "False"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Off", "[", 
       RowBox[{"Transpose", "::", "nmtx"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Off", "[", 
       RowBox[{"Dot", "::", "dotsh"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"P", "=", 
       RowBox[{"StochMat", "[", 
        RowBox[{"myModel", ",", "myDepReac", ",", "minSys"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Q", "=", 
       RowBox[{"ReacMat", "[", 
        RowBox[{"myModel", ",", "minSys"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<P1=\>\"", ",", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"P", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<P2=\>\"", ",", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"P", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<P3=\>\"", ",", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"P", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<P4=\>\"", ",", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"P", "[", 
            RowBox[{"[", "4", "]"}], "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Q1=\>\"", ",", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"Q", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Q2=\>\"", ",", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"Q", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}], ";"}], 
       "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Rmat", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"P", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"Q", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "}"}], "]"}], ",", "2"}], "]"}]}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"lenRea", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"P", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lenR", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"P", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"j", "=", "1"}], ";", 
         RowBox[{"ztab", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", "lenRea"}], "}"}]}], "]"}]}], ";", 
         RowBox[{"q", "=", "1"}], ";", 
         RowBox[{"Rr", "=", 
          RowBox[{"{", "}"}]}], ";", 
         RowBox[{"Rn", "=", 
          RowBox[{"{", "}"}]}], ";"}], ",", 
        RowBox[{"j", "\[LessEqual]", "lenR"}], ",", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"P", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "j"}], "]"}], "]"}], "\[Equal]", 
            RowBox[{"ReplacePart", "[", 
             RowBox[{"ztab", ",", 
              RowBox[{"q", "\[Rule]", "1"}]}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"Rr", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"Rr", ",", 
               RowBox[{"Rmat", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"q", "<", "lenRea"}], ",", 
              RowBox[{"q", "++"}]}], "]"}]}], ",", 
           RowBox[{"Rn", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"Rn", ",", 
              RowBox[{"Rmat", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}]}], "]"}], ";", 
         RowBox[{"j", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"fullSystem", "\[Equal]", "True"}], ",", 
        RowBox[{
         RowBox[{"indReactants", "=", 
          RowBox[{
           RowBox[{"Transpose", "[", "Rmat", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}]}], ";"}], ",", 
        RowBox[{
         RowBox[{"indReactants", "=", 
          RowBox[{
           RowBox[{"Transpose", "[", "Rr", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}]}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"indLink", "=", 
       StyleBox[
        RowBox[{"IdentityMatrix", "[", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"Transpose", "[", "Rr", "]"}], "]"}], "-", "1"}], "]"}], 
        "MR"]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       StyleBox["depReactants", "MR"], 
       StyleBox["=", "MR"], 
       RowBox[{
        RowBox[{"Transpose", "[", "Rn", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"depReactants", "\[NotEqual]", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"depLink", "=", 
          RowBox[{"Take", "[", 
           RowBox[{"Rn", ",", "1", ",", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"Transpose", "[", "Rn", "]"}], "]"}], "-", "1"}]}], 
           "]"}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"cutNum", "[", "a_", "]"}], ":=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"NumberQ", "[", "a", "]"}], ",", "a", ",", "0"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"indNot", "=", 
         RowBox[{"Map", "[", 
          RowBox[{"cutNum", ",", "indReactants"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"depNot", "=", 
         RowBox[{"Map", "[", 
          RowBox[{"cutNum", ",", "depReactants"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<indNot\>\"", ",", "indNot"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<depNot\>\"", ",", "depNot"}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"depsubrhs", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"1", "+", 
           RowBox[{"depLink", ".", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", "indReactants", "}"}], "]"}]}], "-", 
           RowBox[{"depLink", ".", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", "indNot", "}"}], "]"}]}], "-", "depNot"}], "]"}]}], 
        ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"depsubrhs", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"1", "+", 
         RowBox[{"depLink", ".", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", "indReactants", "}"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"depsub", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"depReactants", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
          RowBox[{"depsubrhs", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "depReactants", "]"}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"fullSystem", "\[Equal]", "True"}], ",", 
        RowBox[{
         RowBox[{"newNu", "=", 
          RowBox[{"FullSimplify", "[", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"P", "[", 
              RowBox[{"[", "4", "]"}], "]"}], ".", 
             RowBox[{"Q", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "]"}]}], ";"}], ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Substitution:\>\"", ",", "depsub"}], "]"}], ";", 
         RowBox[{"newNu", "=", 
          RowBox[{"FullSimplify", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"P", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ".", 
              RowBox[{"Q", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/.", "depsub"}], 
           "]"}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"fullSystem", "\[Equal]", "True"}], ",", 
          RowBox[{
           RowBox[{"newNu", "=", 
            RowBox[{
             RowBox[{"P", "[", 
              RowBox[{"[", "4", "]"}], "]"}], ".", 
             RowBox[{"Q", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], ",", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Substitution:\>\"", ",", "depsub"}], "]"}], ";", 
           RowBox[{"newNu", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"P", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ".", 
              RowBox[{"Q", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "/.", "depsub"}]}], ";"}]}], 
         "]"}], ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Mr", "=", 
       RowBox[{"Length", "[", "indReactants", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Leading", " ", "order"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"sysEDO1", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ToExpression", "[", 
            RowBox[{"StringJoin", "[", 
             RowBox[{"\"\<d\>\"", ",", 
              RowBox[{"ToString", "[", 
               RowBox[{"indReactants", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], "]"}], 
           "\[Equal]", 
           RowBox[{"newNu", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "Mr"}], "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"LNA", " ", "EDO", " ", "system"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"sysEDO", "=", "sysEDO1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"stateNames", "=", "indReactants"}], ";", "\[IndentingNewLine]", 
      RowBox[{"sysVariables", "=", "indReactants"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Macro", " ", "evolution", " ", "of", " ", "original", " ", "values"}],
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{"toMacro", "=", 
       RowBox[{"MacroTransform", "[", 
        RowBox[{"sysVariables", ",", "popSize"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sysMacroEDO", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
           RowBox[{"Simplify", "[", 
            RowBox[{
             RowBox[{"popSize", "*", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "/.", "toMacro"}], "]"}]}], 
          "&"}], ",", "sysEDO"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{
        "sysEDO", ",", "sysMacroEDO", ",", "sysVariables", ",", 
         "stateNames"}], "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.500814202956324*^9, 3.500814253274349*^9}, 
   3.500816703260749*^9, {3.5008169905542707`*^9, 3.500817044005178*^9}, {
   3.500817141497213*^9, 3.500817241362173*^9}, {3.500817278609146*^9, 
   3.500817314974272*^9}, {3.5008173485836153`*^9, 3.500817361036531*^9}, {
   3.500817412333232*^9, 3.500817493758741*^9}, {3.5008175532467623`*^9, 
   3.500817577167967*^9}, {3.5008180245240192`*^9, 3.500818036157631*^9}, {
   3.500818124311508*^9, 3.500818127125259*^9}, {3.500818256461898*^9, 
   3.5008182733621893`*^9}, {3.5008183914690523`*^9, 
   3.5008184386504993`*^9}, {3.500818529750062*^9, 3.500818544090307*^9}, {
   3.500818644536435*^9, 3.500818661346386*^9}, {3.5008186984079227`*^9, 
   3.5008187145660887`*^9}, {3.500818836900712*^9, 3.5008188830543823`*^9}, {
   3.500818919679946*^9, 3.500818935855049*^9}, {3.500819085561036*^9, 
   3.5008192631196213`*^9}, {3.50082002601724*^9, 3.50082004839575*^9}, {
   3.5015892006708317`*^9, 3.5015892329279537`*^9}, {3.501589271628261*^9, 
   3.501589288018651*^9}, {3.501589334567622*^9, 3.501589346822753*^9}, {
   3.501589410026935*^9, 3.501589420552783*^9}, {3.501589896195101*^9, 
   3.501589897074326*^9}, {3.501589934516415*^9, 3.501590015910177*^9}, {
   3.501590085081457*^9, 3.5015900901317043`*^9}, {3.501590135674244*^9, 
   3.501590186937948*^9}, {3.5015902558530807`*^9, 3.5015902682693853`*^9}, {
   3.5015903657072277`*^9, 3.501590453016349*^9}, {3.501590586054147*^9, 
   3.501590658427402*^9}, {3.501590758210886*^9, 3.501590864630787*^9}, {
   3.5015909496072683`*^9, 3.501590997956476*^9}, {3.501591034593027*^9, 
   3.501591093774575*^9}, {3.5015911474765882`*^9, 3.5015912051086283`*^9}, {
   3.5015912413074827`*^9, 3.501591252808672*^9}, {3.501591283641614*^9, 
   3.501591305735592*^9}, {3.50159133925727*^9, 3.501591377174369*^9}, {
   3.501591474099841*^9, 3.501591526643257*^9}, {3.5015915627989397`*^9, 
   3.50159168930028*^9}, {3.501591722580958*^9, 3.501591723072647*^9}, {
   3.501591767455564*^9, 3.501591777268897*^9}, {3.501591839235797*^9, 
   3.50159196863834*^9}, {3.501592105425858*^9, 3.501592258709094*^9}, {
   3.501592333651495*^9, 3.501592411861868*^9}, {3.5015924493187*^9, 
   3.501592569470077*^9}, {3.5015926876984873`*^9, 3.501592701565598*^9}, {
   3.501592833228506*^9, 3.501592859240447*^9}, {3.501593240898468*^9, 
   3.501593243678808*^9}, {3.501593277618371*^9, 3.501593281362372*^9}, {
   3.501593801410775*^9, 3.501593850503757*^9}, {3.50159390558106*^9, 
   3.50159391676608*^9}, {3.501593950469055*^9, 3.501593961589562*^9}, {
   3.501594123210226*^9, 3.501594125096012*^9}, {3.501594168329073*^9, 
   3.501594209811829*^9}, {3.50159424322575*^9, 3.501594244231522*^9}, {
   3.5015942970973797`*^9, 3.5015943009821243`*^9}, {3.5017567934135923`*^9, 
   3.50175681460049*^9}, {3.501756886229829*^9, 3.501756912225891*^9}, {
   3.501760507408586*^9, 3.5017605764944887`*^9}, {3.50176168905372*^9, 
   3.501761842183104*^9}, {3.501779289499463*^9, 3.501779293283409*^9}, {
   3.501836642092835*^9, 3.501836796785788*^9}, {3.5018368742271214`*^9, 
   3.501836897661233*^9}, {3.501836927683316*^9, 3.501836946976473*^9}, {
   3.501837236898961*^9, 3.5018372422658577`*^9}, {3.5018374106428757`*^9, 
   3.501837427415703*^9}, {3.501837497238186*^9, 3.5018375111145973`*^9}, {
   3.501837934759139*^9, 3.501837935734437*^9}, 3.501838320021544*^9, {
   3.501838376082945*^9, 3.501838478407754*^9}, {3.5018389046502333`*^9, 
   3.5018389055152884`*^9}, 3.5018397885051107`*^9, 3.501840076323604*^9, {
   3.501840458131143*^9, 3.501840470542633*^9}, {3.501840912798571*^9, 
   3.50184091318699*^9}, {3.501840963100153*^9, 3.501841008975113*^9}, {
   3.501841104347001*^9, 3.501841124311014*^9}, {3.5018427588106213`*^9, 
   3.501842759617301*^9}, {3.501842803933488*^9, 3.501842805125291*^9}, {
   3.501843037408782*^9, 3.5018430462215137`*^9}, 3.501844093565434*^9, {
   3.501844539319475*^9, 3.50184467761652*^9}, {3.501844909751954*^9, 
   3.501844918022581*^9}, {3.502709032262999*^9, 3.502709116182613*^9}, {
   3.50270914829482*^9, 3.502709153018046*^9}, {3.5027092064366093`*^9, 
   3.50270935671161*^9}, {3.50270938681321*^9, 3.5027093912289257`*^9}, {
   3.502709504163587*^9, 3.5027095598195343`*^9}, {3.502709602592147*^9, 
   3.502709683768689*^9}, {3.502709731355948*^9, 3.502709739403449*^9}, {
   3.502709799936329*^9, 3.502709828438332*^9}, {3.502709866022735*^9, 
   3.5027098801231194`*^9}, {3.502709916683381*^9, 3.502709916821282*^9}, {
   3.5027099612484703`*^9, 3.502710050256667*^9}, {3.5032202520509872`*^9, 
   3.503220261935375*^9}, {3.5032203092900333`*^9, 3.503220336483589*^9}, {
   3.50322040664935*^9, 3.503220418117881*^9}, {3.503220497955768*^9, 
   3.503220514237865*^9}, {3.503220547681425*^9, 3.503220595867696*^9}, {
   3.503220684211583*^9, 3.503220688947147*^9}, {3.503220795839267*^9, 
   3.503220816530952*^9}, {3.50322084911425*^9, 3.5032209339105988`*^9}, {
   3.503221153207135*^9, 3.503221206965473*^9}, {3.503221243538705*^9, 
   3.503221289570095*^9}, 3.503221376335395*^9, {3.5032214089499598`*^9, 
   3.503221415855123*^9}, {3.5032214659714947`*^9, 3.503221483558918*^9}, {
   3.5032215508755083`*^9, 3.5032215762216988`*^9}, {3.503221609786262*^9, 
   3.50322177039764*^9}, {3.503221830156843*^9, 3.503221876772914*^9}, {
   3.503221924396203*^9, 3.5032219909279222`*^9}, {3.503222098220314*^9, 
   3.5032221303260307`*^9}, {3.503222215087638*^9, 3.503222368818746*^9}, {
   3.503222470512844*^9, 3.503222558063435*^9}, {3.5032226625772257`*^9, 
   3.503222764599165*^9}, {3.503222798833864*^9, 3.503222863794632*^9}, {
   3.503222913461396*^9, 3.5032229669508266`*^9}, {3.5032230002117777`*^9, 
   3.5032230344152117`*^9}, {3.503223130226016*^9, 3.503223136654405*^9}, {
   3.503223494307424*^9, 3.50322351411934*^9}, {3.5032236606193933`*^9, 
   3.503223665484614*^9}, {3.50322416379357*^9, 3.503224165030635*^9}, {
   3.50322425289736*^9, 3.50322425391748*^9}, {3.503224326115527*^9, 
   3.503224401886589*^9}, {3.5032244540134497`*^9, 3.503224456142191*^9}, {
   3.503224743635631*^9, 3.503224763927919*^9}, {3.5032247972332287`*^9, 
   3.503224807645279*^9}, {3.5032248435487967`*^9, 3.503224881257214*^9}, {
   3.5032249725968657`*^9, 3.503225076699244*^9}, {3.503225139400979*^9, 
   3.503225149557029*^9}, {3.5032252088278418`*^9, 3.503225269168787*^9}, {
   3.503225313578712*^9, 3.503225316344367*^9}, {3.503225427442062*^9, 
   3.5032254391243067`*^9}, {3.503225581523946*^9, 3.503225595107964*^9}, {
   3.503225840320819*^9, 3.503225915502914*^9}, {3.50322601926186*^9, 
   3.5032260233870983`*^9}, {3.5032260749401407`*^9, 
   3.5032261236072483`*^9}, {3.503226245196363*^9, 3.503226272101569*^9}, {
   3.5032265102730083`*^9, 3.503226514278317*^9}, {3.503226635935527*^9, 
   3.503226667038439*^9}, {3.50322670825487*^9, 3.5032267554197702`*^9}, {
   3.503226878622574*^9, 3.503226888005927*^9}, {3.503227003674787*^9, 
   3.503227008488118*^9}, {3.5032270563393917`*^9, 3.503227071458201*^9}, {
   3.503227181387896*^9, 3.503227215661654*^9}, {3.503227246647037*^9, 
   3.503227254204567*^9}, {3.503227291832375*^9, 3.503227339986227*^9}, {
   3.5032274897935753`*^9, 3.50322750497127*^9}, {3.5032275416804333`*^9, 
   3.503227567260741*^9}, {3.503227676653788*^9, 3.503227707413381*^9}, {
   3.5032277914630737`*^9, 3.503227794820382*^9}, {3.50322782500597*^9, 
   3.503227925536275*^9}, {3.503228505975463*^9, 3.5032285095740147`*^9}, {
   3.503228794400751*^9, 3.503228799085327*^9}, {3.5032288573319063`*^9, 
   3.503228977314055*^9}, {3.503229067694858*^9, 3.503229116520956*^9}, {
   3.503229240945857*^9, 3.503229259101128*^9}, {3.503229300662578*^9, 
   3.503229352061714*^9}, {3.503229771994917*^9, 3.503229780482964*^9}, {
   3.5032298710559998`*^9, 3.503229899402483*^9}, {3.50322995371657*^9, 
   3.5032299607687273`*^9}, {3.5032303028492393`*^9, 
   3.5032303110948277`*^9}, {3.503230470326502*^9, 3.503230587958315*^9}, {
   3.503230635819048*^9, 3.50323063729051*^9}, {3.503230727876966*^9, 
   3.503230752358171*^9}, {3.503230822689516*^9, 3.503230895187997*^9}, {
   3.503230928694106*^9, 3.503231147263459*^9}, {3.503231291322208*^9, 
   3.5032313211903563`*^9}, {3.503312413335384*^9, 3.503312415298255*^9}, {
   3.503312497990237*^9, 3.503312511223579*^9}, {3.503312553012299*^9, 
   3.503312565369504*^9}, {3.5033126544406843`*^9, 3.503312661849669*^9}, 
   3.503312725240098*^9, {3.503313530574052*^9, 3.503313567862811*^9}, {
   3.503313619196107*^9, 3.5033136208584213`*^9}, {3.503313714984661*^9, 
   3.503313723587675*^9}, 3.503313803802964*^9, {3.50331470179662*^9, 
   3.503314805260847*^9}, {3.503314843186391*^9, 3.5033152248312883`*^9}, {
   3.503915911571391*^9, 3.503915938539248*^9}, {3.5039290495896482`*^9, 
   3.503929053331979*^9}, {3.503929093934103*^9, 3.503929097052113*^9}, {
   3.503929307915305*^9, 3.503929317641646*^9}, {3.503929485284007*^9, 
   3.50392948758808*^9}, {3.504540254656847*^9, 3.5045402735279093`*^9}, {
   3.504540784519569*^9, 3.504540788504834*^9}, {3.505125331301826*^9, 
   3.505125423267878*^9}, {3.505125490756886*^9, 3.505125504944283*^9}, {
   3.505131138471437*^9, 3.505131145262773*^9}, {3.5051341794615593`*^9, 
   3.505134179843864*^9}, {3.508220163709033*^9, 3.5082202020776033`*^9}, {
   3.508220324401371*^9, 3.5082203300390778`*^9}, {3.508220365162839*^9, 
   3.508220376510133*^9}, {3.508505031717572*^9, 3.508505086677404*^9}, {
   3.508555956312378*^9, 3.508555959951187*^9}, {3.508556419144752*^9, 
   3.5085564548369713`*^9}, {3.508556651293191*^9, 3.508556663213809*^9}, {
   3.508557704243528*^9, 3.508557816294629*^9}, {3.5085579388588448`*^9, 
   3.5085579682238903`*^9}, {3.508558060930043*^9, 3.508558065041367*^9}, {
   3.50855810203683*^9, 3.508558313786778*^9}, {3.5085583714713917`*^9, 
   3.5085583766857862`*^9}, {3.508559857378956*^9, 3.508559884459517*^9}, {
   3.508559942917953*^9, 3.508559943237259*^9}, {3.508562325167931*^9, 
   3.508562327165303*^9}, {3.50876525707226*^9, 3.5087652605734043`*^9}, {
   3.5190082826665907`*^9, 3.5190082850469007`*^9}, {3.5190087802066193`*^9, 
   3.519008804537435*^9}, {3.519009298733073*^9, 3.519009357192658*^9}, {
   3.519009416527968*^9, 3.519009524186778*^9}, {3.519009669717607*^9, 
   3.5190096737464333`*^9}, {3.519009756507593*^9, 3.5190097630755243`*^9}, {
   3.51900996867323*^9, 3.519010041284154*^9}, {3.5190100757980947`*^9, 
   3.519010124794989*^9}, {3.519010158793667*^9, 3.519010169344494*^9}, {
   3.519010224529624*^9, 3.519010237856852*^9}, {3.519010340007743*^9, 
   3.519010361636495*^9}, {3.5190112518154583`*^9, 3.5190113417570143`*^9}, {
   3.519011436725338*^9, 3.5190115873422117`*^9}, {3.5190125107547903`*^9, 
   3.519012549269664*^9}, {3.5190125818019953`*^9, 3.519012611651585*^9}, {
   3.51901264872115*^9, 3.519012677499354*^9}, {3.5190127257488127`*^9, 
   3.519012733173991*^9}, {3.519012797105114*^9, 3.519012833456759*^9}, {
   3.519013199158762*^9, 3.5190132150923367`*^9}, {3.519013737510749*^9, 
   3.51901378708852*^9}, {3.519013840343103*^9, 3.519013859843556*^9}, {
   3.519014065990581*^9, 3.5190140993655767`*^9}, {3.519996866498139*^9, 
   3.519996869560082*^9}, {3.521958235508481*^9, 3.521958238065535*^9}, {
   3.524385486091024*^9, 3.524385489579084*^9}, {3.524385713595922*^9, 
   3.5243857249763937`*^9}, {3.538137370883482*^9, 3.538137374866637*^9}, {
   3.538137454321868*^9, 3.5381374583904123`*^9}, {3.538137522315853*^9, 
   3.5381375782862453`*^9}, {3.538144366863512*^9, 3.538144373313039*^9}, {
   3.53814442208993*^9, 3.53814442318501*^9}, {3.538222801725128*^9, 
   3.538222802571752*^9}, {3.5382229276836023`*^9, 3.5382229520618*^9}, {
   3.538399464510435*^9, 3.538399524078133*^9}, {3.538400279131171*^9, 
   3.538400296199617*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Linear Noise Approximation (LNA) ", "Section",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.50385865487392*^9, 3.5038586710568533`*^9}, {
  3.508581953660261*^9, 3.5085819697388773`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LNA", "[", 
    RowBox[{"myModel_", ",", "myDepReac_", ",", "popSize_", ",", "minSys_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "fullSystem", ",", "P", ",", "Q", ",", "Rmat", ",", "lenRea", ",", 
       "lenR", ",", "j", ",", "k", ",", "Rr", ",", "Rn", ",", "ztab", ",", 
       "q", ",", "indReactants", ",", "indLink", ",", "depReactants", ",", 
       "depLink", ",", "indNot", ",", "depNot", ",", "depsubrhs", ",", 
       "depsub", ",", " ", "newNu", ",", " ", "Mr", ",", " ", "allReactants", 
       ",", " ", "posRedReactants", ",", "Amat", ",", " ", "Bmat", ",", 
       "addT", ",", "removeT", ",", "AA", ",", "BB", ",", "sysEDO1", ",", 
       "sysEDO2", ",", "covMat", ",", "covEDO", ",", "covEDOtr", ",", 
       "sysEDO3", ",", "sysMath", ",", "variable"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"{", "myDepReac", "}"}], "]"}], "\[Equal]", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"fullSystem", "=", "True"}], ",", 
        RowBox[{"fullSystem", "=", "False"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Off", "[", 
       RowBox[{"Transpose", "::", "nmtx"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Off", "[", 
       RowBox[{"Dot", "::", "dotsh"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"P", "=", 
       RowBox[{"StochMat", "[", 
        RowBox[{"myModel", ",", "myDepReac", ",", "minSys"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Q", "=", 
       RowBox[{"ReacMat", "[", 
        RowBox[{"myModel", ",", "minSys"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<P1=\>\"", ",", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"P", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<P2=\>\"", ",", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"P", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<P3=\>\"", ",", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"P", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<P4=\>\"", ",", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"P", "[", 
            RowBox[{"[", "4", "]"}], "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Q1=\>\"", ",", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"Q", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Q2=\>\"", ",", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"Q", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}], ";"}], 
       "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Rmat", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"P", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"Q", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "}"}], "]"}], ",", "2"}], "]"}]}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"lenRea", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"P", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lenR", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"P", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"j", "=", "1"}], ";", 
         RowBox[{"ztab", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", "lenRea"}], "}"}]}], "]"}]}], ";", 
         RowBox[{"q", "=", "1"}], ";", 
         RowBox[{"Rr", "=", 
          RowBox[{"{", "}"}]}], ";", 
         RowBox[{"Rn", "=", 
          RowBox[{"{", "}"}]}], ";"}], ",", 
        RowBox[{"j", "\[LessEqual]", "lenR"}], ",", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"P", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "j"}], "]"}], "]"}], "\[Equal]", 
            RowBox[{"ReplacePart", "[", 
             RowBox[{"ztab", ",", 
              RowBox[{"q", "\[Rule]", "1"}]}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"Rr", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"Rr", ",", 
               RowBox[{"Rmat", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"q", "<", "lenRea"}], ",", 
              RowBox[{"q", "++"}]}], "]"}]}], ",", 
           RowBox[{"Rn", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"Rn", ",", 
              RowBox[{"Rmat", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}]}], "]"}], ";", 
         RowBox[{"j", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"fullSystem", "\[Equal]", "True"}], ",", 
        RowBox[{
         RowBox[{"indReactants", "=", 
          RowBox[{
           RowBox[{"Transpose", "[", "Rmat", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}]}], ";"}], ",", 
        RowBox[{
         RowBox[{"indReactants", "=", 
          RowBox[{
           RowBox[{"Transpose", "[", "Rr", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}]}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"indLink", "=", 
       StyleBox[
        RowBox[{"IdentityMatrix", "[", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"Transpose", "[", "Rr", "]"}], "]"}], "-", "1"}], "]"}], 
        "MR"]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       StyleBox["depReactants", "MR"], 
       StyleBox["=", "MR"], 
       RowBox[{
        RowBox[{"Transpose", "[", "Rn", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"depReactants", "\[NotEqual]", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"depLink", "=", 
          RowBox[{"Take", "[", 
           RowBox[{"Rn", ",", "1", ",", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"Transpose", "[", "Rn", "]"}], "]"}], "-", "1"}]}], 
           "]"}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"cutNum", "[", "a_", "]"}], ":=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"NumberQ", "[", "a", "]"}], ",", "a", ",", "0"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"indNot", "=", 
         RowBox[{"Map", "[", 
          RowBox[{"cutNum", ",", "indReactants"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"depNot", "=", 
         RowBox[{"Map", "[", 
          RowBox[{"cutNum", ",", "depReactants"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<indNot\>\"", ",", "indNot"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<depNot\>\"", ",", "depNot"}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"depsubrhs", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"1", "+", 
           RowBox[{"depLink", ".", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", "indReactants", "}"}], "]"}]}], "-", 
           RowBox[{"depLink", ".", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", "indNot", "}"}], "]"}]}], "-", "depNot"}], "]"}]}], 
        ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"depsubrhs", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"1", "+", 
         RowBox[{"depLink", ".", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", "indReactants", "}"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"depsub", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"depReactants", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
          RowBox[{"depsubrhs", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "depReactants", "]"}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"fullSystem", "\[Equal]", "True"}], ",", 
        RowBox[{
         RowBox[{"newNu", "=", 
          RowBox[{"Simplify", "[", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"P", "[", 
              RowBox[{"[", "4", "]"}], "]"}], ".", 
             RowBox[{"Q", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "]"}]}], ";"}], ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Substitution:\>\"", ",", "depsub"}], "]"}], ";", 
         RowBox[{"newNu", "=", 
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"P", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ".", 
              RowBox[{"Q", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/.", "depsub"}], 
           "]"}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Mr", "=", 
       RowBox[{"Length", "[", "indReactants", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Amat", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"newNu", "[", 
              RowBox[{"[", "k", "]"}], "]"}], ",", 
             RowBox[{"indReactants", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "Mr"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "Mr"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"fullSystem", "\[Equal]", "True"}], ",", 
        RowBox[{
         RowBox[{"Bmat", "=", 
          RowBox[{"Simplify", "[", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"P", "[", 
              RowBox[{"[", "4", "]"}], "]"}], ".", 
             RowBox[{"DiagonalMatrix", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"Q", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ".", 
             RowBox[{"Transpose", "[", 
              RowBox[{"P", "[", 
               RowBox[{"[", "4", "]"}], "]"}], "]"}]}], ")"}], "]"}]}], ";"}],
         ",", 
        RowBox[{
         RowBox[{"Bmat", "=", 
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"P", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ".", 
              RowBox[{"DiagonalMatrix", "[", 
               RowBox[{"Flatten", "[", 
                RowBox[{"Q", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ".", 
              RowBox[{"Transpose", "[", 
               RowBox[{"P", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ")"}], "/.", 
            "depsub"}], "]"}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<newNu :\>\"", ",", 
        RowBox[{"MatrixForm", "[", "newNu", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Bmat :\>\"", ",", 
        RowBox[{"MatrixForm", "[", "Bmat", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Leading", " ", "order"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"sysEDO1", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ToExpression", "[", 
            RowBox[{"StringJoin", "[", 
             RowBox[{"\"\<d\>\"", ",", 
              RowBox[{"ToString", "[", 
               RowBox[{"indReactants", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], "]"}], 
           "\[Equal]", 
           RowBox[{"newNu", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "Mr"}], "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Next", " ", "to", " ", "leading", " ", "order"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"covMat", "=", 
       RowBox[{"ToExpression", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"StringJoin", "[", 
           RowBox[{
            RowBox[{"ToString", "[", 
             RowBox[{"indReactants", "[", 
              RowBox[{"[", 
               RowBox[{"Min", "[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"ToString", "[", 
             RowBox[{"indReactants", "[", 
              RowBox[{"[", 
               RowBox[{"Max", "[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], "]"}]}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "Mr"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "Mr"}], "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"covEDO", "=", 
       RowBox[{
        RowBox[{"Amat", ".", "covMat"}], "+", 
        RowBox[{"covMat", ".", 
         RowBox[{"Transpose", "[", "Amat", "]"}]}], "+", "Bmat"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"covEDO", "=", 
       RowBox[{"Simplify", "[", "covEDO", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"covEDOtr", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"LowerTriangularize", "[", "covEDO", "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{"0", "\[Rule]", 
           RowBox[{"{", "}"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"sysEDO2", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ToExpression", "[", 
            RowBox[{"StringJoin", "[", 
             RowBox[{"\"\<d\>\"", ",", 
              RowBox[{"ToString", "[", 
               RowBox[{"covMat", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}]}], "]"}], "]"}],
            "\[Equal]", 
           RowBox[{"covEDO", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "Mr"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "i", ",", "Mr"}], "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"LNA", " ", "EDO", " ", "system"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"sysEDO", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"sysEDO1", ",", "sysEDO2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"stateNames", "=", "indReactants"}], ";", "\[IndentingNewLine]", 
      RowBox[{"sysVariables", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{"indReactants", ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"covMat", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "Mr"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "i", ",", "Mr"}], "}"}]}], "]"}]}], "}"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Macro", " ", "evolution", " ", "of", " ", "original", " ", "values"}],
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{"toMacro", "=", 
       RowBox[{"MacroTransform", "[", 
        RowBox[{"sysVariables", ",", "popSize"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sysMacroEDO", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "==", 
           RowBox[{"Simplify", "[", 
            RowBox[{
             RowBox[{"popSize", "*", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "/.", "toMacro"}], "]"}]}], 
          "&"}], ",", "sysEDO"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{
        "sysEDO", ",", "sysMacroEDO", ",", "sysVariables", ",", "stateNames", 
         ",", "covMat", ",", "Amat"}], "}"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.500814202956324*^9, 3.500814253274349*^9}, 
   3.500816703260749*^9, {3.5008169905542707`*^9, 3.500817044005178*^9}, {
   3.500817141497213*^9, 3.500817241362173*^9}, {3.500817278609146*^9, 
   3.500817314974272*^9}, {3.5008173485836153`*^9, 3.500817361036531*^9}, {
   3.500817412333232*^9, 3.500817493758741*^9}, {3.5008175532467623`*^9, 
   3.500817577167967*^9}, {3.5008180245240192`*^9, 3.500818036157631*^9}, {
   3.500818124311508*^9, 3.500818127125259*^9}, {3.500818256461898*^9, 
   3.5008182733621893`*^9}, {3.5008183914690523`*^9, 
   3.5008184386504993`*^9}, {3.500818529750062*^9, 3.500818544090307*^9}, {
   3.500818644536435*^9, 3.500818661346386*^9}, {3.5008186984079227`*^9, 
   3.5008187145660887`*^9}, {3.500818836900712*^9, 3.5008188830543823`*^9}, {
   3.500818919679946*^9, 3.500818935855049*^9}, {3.500819085561036*^9, 
   3.5008192631196213`*^9}, {3.50082002601724*^9, 3.50082004839575*^9}, {
   3.5015892006708317`*^9, 3.5015892329279537`*^9}, {3.501589271628261*^9, 
   3.501589288018651*^9}, {3.501589334567622*^9, 3.501589346822753*^9}, {
   3.501589410026935*^9, 3.501589420552783*^9}, {3.501589896195101*^9, 
   3.501589897074326*^9}, {3.501589934516415*^9, 3.501590015910177*^9}, {
   3.501590085081457*^9, 3.5015900901317043`*^9}, {3.501590135674244*^9, 
   3.501590186937948*^9}, {3.5015902558530807`*^9, 3.5015902682693853`*^9}, {
   3.5015903657072277`*^9, 3.501590453016349*^9}, {3.501590586054147*^9, 
   3.501590658427402*^9}, {3.501590758210886*^9, 3.501590864630787*^9}, {
   3.5015909496072683`*^9, 3.501590997956476*^9}, {3.501591034593027*^9, 
   3.501591093774575*^9}, {3.5015911474765882`*^9, 3.5015912051086283`*^9}, {
   3.5015912413074827`*^9, 3.501591252808672*^9}, {3.501591283641614*^9, 
   3.501591305735592*^9}, {3.50159133925727*^9, 3.501591377174369*^9}, {
   3.501591474099841*^9, 3.501591526643257*^9}, {3.5015915627989397`*^9, 
   3.50159168930028*^9}, {3.501591722580958*^9, 3.501591723072647*^9}, {
   3.501591767455564*^9, 3.501591777268897*^9}, {3.501591839235797*^9, 
   3.50159196863834*^9}, {3.501592105425858*^9, 3.501592258709094*^9}, {
   3.501592333651495*^9, 3.501592411861868*^9}, {3.5015924493187*^9, 
   3.501592569470077*^9}, {3.5015926876984873`*^9, 3.501592701565598*^9}, {
   3.501592833228506*^9, 3.501592859240447*^9}, {3.501593240898468*^9, 
   3.501593243678808*^9}, {3.501593277618371*^9, 3.501593281362372*^9}, {
   3.501593801410775*^9, 3.501593850503757*^9}, {3.50159390558106*^9, 
   3.50159391676608*^9}, {3.501593950469055*^9, 3.501593961589562*^9}, {
   3.501594123210226*^9, 3.501594125096012*^9}, {3.501594168329073*^9, 
   3.501594209811829*^9}, {3.50159424322575*^9, 3.501594244231522*^9}, {
   3.5015942970973797`*^9, 3.5015943009821243`*^9}, {3.5017567934135923`*^9, 
   3.50175681460049*^9}, {3.501756886229829*^9, 3.501756912225891*^9}, {
   3.501760507408586*^9, 3.5017605764944887`*^9}, {3.50176168905372*^9, 
   3.501761842183104*^9}, {3.501779289499463*^9, 3.501779293283409*^9}, {
   3.501836642092835*^9, 3.501836796785788*^9}, {3.5018368742271214`*^9, 
   3.501836897661233*^9}, {3.501836927683316*^9, 3.501836946976473*^9}, {
   3.501837236898961*^9, 3.5018372422658577`*^9}, {3.5018374106428757`*^9, 
   3.501837427415703*^9}, {3.501837497238186*^9, 3.5018375111145973`*^9}, {
   3.501837934759139*^9, 3.501837935734437*^9}, 3.501838320021544*^9, {
   3.501838376082945*^9, 3.501838478407754*^9}, {3.5018389046502333`*^9, 
   3.5018389055152884`*^9}, 3.5018397885051107`*^9, 3.501840076323604*^9, {
   3.501840458131143*^9, 3.501840470542633*^9}, {3.501840912798571*^9, 
   3.50184091318699*^9}, {3.501840963100153*^9, 3.501841008975113*^9}, {
   3.501841104347001*^9, 3.501841124311014*^9}, {3.5018427588106213`*^9, 
   3.501842759617301*^9}, {3.501842803933488*^9, 3.501842805125291*^9}, {
   3.501843037408782*^9, 3.5018430462215137`*^9}, 3.501844093565434*^9, {
   3.501844539319475*^9, 3.50184467761652*^9}, {3.501844909751954*^9, 
   3.501844918022581*^9}, {3.502709032262999*^9, 3.502709116182613*^9}, {
   3.50270914829482*^9, 3.502709153018046*^9}, {3.5027092064366093`*^9, 
   3.50270935671161*^9}, {3.50270938681321*^9, 3.5027093912289257`*^9}, {
   3.502709504163587*^9, 3.5027095598195343`*^9}, {3.502709602592147*^9, 
   3.502709683768689*^9}, {3.502709731355948*^9, 3.502709739403449*^9}, {
   3.502709799936329*^9, 3.502709828438332*^9}, {3.502709866022735*^9, 
   3.5027098801231194`*^9}, {3.502709916683381*^9, 3.502709916821282*^9}, {
   3.5027099612484703`*^9, 3.502710050256667*^9}, {3.5032202520509872`*^9, 
   3.503220261935375*^9}, {3.5032203092900333`*^9, 3.503220336483589*^9}, {
   3.50322040664935*^9, 3.503220418117881*^9}, {3.503220497955768*^9, 
   3.503220514237865*^9}, {3.503220547681425*^9, 3.503220595867696*^9}, {
   3.503220684211583*^9, 3.503220688947147*^9}, {3.503220795839267*^9, 
   3.503220816530952*^9}, {3.50322084911425*^9, 3.5032209339105988`*^9}, {
   3.503221153207135*^9, 3.503221206965473*^9}, {3.503221243538705*^9, 
   3.503221289570095*^9}, 3.503221376335395*^9, {3.5032214089499598`*^9, 
   3.503221415855123*^9}, {3.5032214659714947`*^9, 3.503221483558918*^9}, {
   3.5032215508755083`*^9, 3.5032215762216988`*^9}, {3.503221609786262*^9, 
   3.50322177039764*^9}, {3.503221830156843*^9, 3.503221876772914*^9}, {
   3.503221924396203*^9, 3.5032219909279222`*^9}, {3.503222098220314*^9, 
   3.5032221303260307`*^9}, {3.503222215087638*^9, 3.503222368818746*^9}, {
   3.503222470512844*^9, 3.503222558063435*^9}, {3.5032226625772257`*^9, 
   3.503222764599165*^9}, {3.503222798833864*^9, 3.503222863794632*^9}, {
   3.503222913461396*^9, 3.5032229669508266`*^9}, {3.5032230002117777`*^9, 
   3.5032230344152117`*^9}, {3.503223130226016*^9, 3.503223136654405*^9}, {
   3.503223494307424*^9, 3.50322351411934*^9}, {3.5032236606193933`*^9, 
   3.503223665484614*^9}, {3.50322416379357*^9, 3.503224165030635*^9}, {
   3.50322425289736*^9, 3.50322425391748*^9}, {3.503224326115527*^9, 
   3.503224401886589*^9}, {3.5032244540134497`*^9, 3.503224456142191*^9}, {
   3.503224743635631*^9, 3.503224763927919*^9}, {3.5032247972332287`*^9, 
   3.503224807645279*^9}, {3.5032248435487967`*^9, 3.503224881257214*^9}, {
   3.5032249725968657`*^9, 3.503225076699244*^9}, {3.503225139400979*^9, 
   3.503225149557029*^9}, {3.5032252088278418`*^9, 3.503225269168787*^9}, {
   3.503225313578712*^9, 3.503225316344367*^9}, {3.503225427442062*^9, 
   3.5032254391243067`*^9}, {3.503225581523946*^9, 3.503225595107964*^9}, {
   3.503225840320819*^9, 3.503225915502914*^9}, {3.50322601926186*^9, 
   3.5032260233870983`*^9}, {3.5032260749401407`*^9, 
   3.5032261236072483`*^9}, {3.503226245196363*^9, 3.503226272101569*^9}, {
   3.5032265102730083`*^9, 3.503226514278317*^9}, {3.503226635935527*^9, 
   3.503226667038439*^9}, {3.50322670825487*^9, 3.5032267554197702`*^9}, {
   3.503226878622574*^9, 3.503226888005927*^9}, {3.503227003674787*^9, 
   3.503227008488118*^9}, {3.5032270563393917`*^9, 3.503227071458201*^9}, {
   3.503227181387896*^9, 3.503227215661654*^9}, {3.503227246647037*^9, 
   3.503227254204567*^9}, {3.503227291832375*^9, 3.503227339986227*^9}, {
   3.5032274897935753`*^9, 3.50322750497127*^9}, {3.5032275416804333`*^9, 
   3.503227567260741*^9}, {3.503227676653788*^9, 3.503227707413381*^9}, {
   3.5032277914630737`*^9, 3.503227794820382*^9}, {3.50322782500597*^9, 
   3.503227925536275*^9}, {3.503228505975463*^9, 3.5032285095740147`*^9}, {
   3.503228794400751*^9, 3.503228799085327*^9}, {3.5032288573319063`*^9, 
   3.503228977314055*^9}, {3.503229067694858*^9, 3.503229116520956*^9}, {
   3.503229240945857*^9, 3.503229259101128*^9}, {3.503229300662578*^9, 
   3.503229352061714*^9}, {3.503229771994917*^9, 3.503229780482964*^9}, {
   3.5032298710559998`*^9, 3.503229899402483*^9}, {3.50322995371657*^9, 
   3.5032299607687273`*^9}, {3.5032303028492393`*^9, 
   3.5032303110948277`*^9}, {3.503230470326502*^9, 3.503230587958315*^9}, {
   3.503230635819048*^9, 3.50323063729051*^9}, {3.503230727876966*^9, 
   3.503230752358171*^9}, {3.503230822689516*^9, 3.503230895187997*^9}, {
   3.503230928694106*^9, 3.503231147263459*^9}, {3.503231291322208*^9, 
   3.5032313211903563`*^9}, {3.503312413335384*^9, 3.503312415298255*^9}, {
   3.503312497990237*^9, 3.503312511223579*^9}, {3.503312553012299*^9, 
   3.503312565369504*^9}, {3.5033126544406843`*^9, 3.503312661849669*^9}, 
   3.503312725240098*^9, {3.503313530574052*^9, 3.503313567862811*^9}, {
   3.503313619196107*^9, 3.5033136208584213`*^9}, {3.503313714984661*^9, 
   3.503313723587675*^9}, 3.503313803802964*^9, {3.50331470179662*^9, 
   3.503314805260847*^9}, {3.503314843186391*^9, 3.5033152248312883`*^9}, {
   3.503915911571391*^9, 3.503915938539248*^9}, {3.5039290495896482`*^9, 
   3.503929053331979*^9}, {3.503929093934103*^9, 3.503929097052113*^9}, {
   3.503929307915305*^9, 3.503929317641646*^9}, {3.503929485284007*^9, 
   3.50392948758808*^9}, {3.504540254656847*^9, 3.5045402735279093`*^9}, {
   3.504540784519569*^9, 3.504540788504834*^9}, {3.505125331301826*^9, 
   3.505125423267878*^9}, {3.505125490756886*^9, 3.505125504944283*^9}, {
   3.505131138471437*^9, 3.505131145262773*^9}, {3.5051341794615593`*^9, 
   3.505134179843864*^9}, {3.508220163709033*^9, 3.5082202020776033`*^9}, {
   3.508220324401371*^9, 3.5082203300390778`*^9}, {3.508220365162839*^9, 
   3.508220376510133*^9}, {3.508505031717572*^9, 3.508505086677404*^9}, {
   3.508555956312378*^9, 3.508555959951187*^9}, {3.508556419144752*^9, 
   3.5085564548369713`*^9}, {3.508556651293191*^9, 3.508556663213809*^9}, {
   3.508557704243528*^9, 3.508557816294629*^9}, {3.5085579388588448`*^9, 
   3.5085579682238903`*^9}, {3.508558060930043*^9, 3.508558065041367*^9}, {
   3.50855810203683*^9, 3.508558313786778*^9}, {3.5085583714713917`*^9, 
   3.5085583766857862`*^9}, {3.508559857378956*^9, 3.508559884459517*^9}, {
   3.508559942917953*^9, 3.508559943237259*^9}, {3.508562325167931*^9, 
   3.508562327165303*^9}, {3.50876525707226*^9, 3.5087652605734043`*^9}, {
   3.5190082826665907`*^9, 3.5190082850469007`*^9}, {3.5190087802066193`*^9, 
   3.519008804537435*^9}, {3.519009298733073*^9, 3.519009357192658*^9}, {
   3.519009416527968*^9, 3.519009524186778*^9}, {3.519009669717607*^9, 
   3.5190096737464333`*^9}, {3.519009756507593*^9, 3.5190097630755243`*^9}, {
   3.51900996867323*^9, 3.519010041284154*^9}, {3.5190100757980947`*^9, 
   3.519010124794989*^9}, {3.519010158793667*^9, 3.519010169344494*^9}, {
   3.519010224529624*^9, 3.519010237856852*^9}, {3.519010340007743*^9, 
   3.519010361636495*^9}, {3.5190112518154583`*^9, 3.5190113417570143`*^9}, {
   3.519011436725338*^9, 3.5190115873422117`*^9}, {3.5190125107547903`*^9, 
   3.519012549269664*^9}, {3.5190125818019953`*^9, 3.519012611651585*^9}, {
   3.51901264872115*^9, 3.519012677499354*^9}, {3.5190127257488127`*^9, 
   3.519012733173991*^9}, {3.519012797105114*^9, 3.519012833456759*^9}, {
   3.519013199158762*^9, 3.5190132150923367`*^9}, {3.519013737510749*^9, 
   3.51901378708852*^9}, {3.519013840343103*^9, 3.519013859843556*^9}, {
   3.519014065990581*^9, 3.5190140993655767`*^9}, {3.519996866498139*^9, 
   3.519996869560082*^9}, {3.521958235508481*^9, 3.521958238065535*^9}, {
   3.524385486091024*^9, 3.524385489579084*^9}, {3.524385713595922*^9, 
   3.5243857249763937`*^9}, {3.5420909741637707`*^9, 3.54209099073094*^9}, {
   3.5420913113870983`*^9, 3.5420913140905247`*^9}, {3.542091938684204*^9, 
   3.542091961281679*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Moment Closure Technique (Normal and Lognormal)", "Section",
 InitializationGroup->True,
 CellChangeTimes->{{3.50858197662055*^9, 3.508582011952196*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MomentClosure", "[", 
    RowBox[{"myModel_", ",", "myDepReac_", ",", "popSize_", ",", "minSys_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "fullSystem", ",", "P", ",", "Q", ",", "Rmat", ",", "lenRea", ",", 
       "lenR", ",", "j", ",", "k", ",", "Rr", ",", "Rn", ",", "ztab", ",", 
       "q", ",", "indReactants", ",", "indLink", ",", "depReactants", ",", 
       "depLink", ",", "indNot", ",", "depNot", ",", "depsubrhs", ",", 
       "depsub", ",", " ", "newNu", ",", " ", "Mr", ",", " ", "allReactants", 
       ",", " ", "posRedReactants", ",", "Amat", ",", " ", "addT", ",", 
       "removeT", ",", "AA", ",", "BB", ",", "sysEDO1", ",", "sysEDO2", ",", 
       "covMat", ",", "covEDO", ",", "covEDOtr", ",", "sysEDO3", ",", 
       "sysMath", ",", "variable"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"{", "myDepReac", "}"}], "]"}], "\[Equal]", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"fullSystem", "=", "True"}], ",", 
        RowBox[{"fullSystem", "=", "False"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Off", "[", 
       RowBox[{"Transpose", "::", "nmtx"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Off", "[", 
       RowBox[{"Dot", "::", "dotsh"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"P", "=", 
       RowBox[{"StochMat", "[", 
        RowBox[{"myModel", ",", "myDepReac", ",", "minSys"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Q", "=", 
       RowBox[{"ReacMat", "[", 
        RowBox[{"myModel", ",", "minSys"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<P1=\>\"", ",", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"P", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<P2=\>\"", ",", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"P", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<P3=\>\"", ",", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"P", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<P4=\>\"", ",", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"P", "[", 
            RowBox[{"[", "4", "]"}], "]"}], "]"}]}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Rmat", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"P", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"Q", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "}"}], "]"}], ",", "2"}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"lenRea", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"P", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lenR", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"P", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"j", "=", "1"}], ";", 
         RowBox[{"ztab", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", "lenRea"}], "}"}]}], "]"}]}], ";", 
         RowBox[{"q", "=", "1"}], ";", 
         RowBox[{"Rr", "=", 
          RowBox[{"{", "}"}]}], ";", 
         RowBox[{"Rn", "=", 
          RowBox[{"{", "}"}]}], ";"}], ",", 
        RowBox[{"j", "\[LessEqual]", "lenR"}], ",", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"P", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "j"}], "]"}], "]"}], "\[Equal]", 
            RowBox[{"ReplacePart", "[", 
             RowBox[{"ztab", ",", 
              RowBox[{"q", "\[Rule]", "1"}]}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"Rr", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"Rr", ",", 
               RowBox[{"Rmat", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"q", "<", "lenRea"}], ",", 
              RowBox[{"q", "++"}]}], "]"}]}], ",", 
           RowBox[{"Rn", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"Rn", ",", 
              RowBox[{"Rmat", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}]}], "]"}], ";", 
         RowBox[{"j", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"fullSystem", "\[Equal]", "True"}], ",", 
        RowBox[{
         RowBox[{"indReactants", "=", 
          RowBox[{
           RowBox[{"Transpose", "[", "Rmat", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}]}], ";"}], ",", 
        RowBox[{
         RowBox[{"indReactants", "=", 
          RowBox[{
           RowBox[{"Transpose", "[", "Rr", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}]}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"indLink", "=", 
       StyleBox[
        RowBox[{"IdentityMatrix", "[", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"Transpose", "[", "Rr", "]"}], "]"}], "-", "1"}], "]"}], 
        "MR"]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       StyleBox["depReactants", "MR"], 
       StyleBox["=", "MR"], 
       RowBox[{
        RowBox[{"Transpose", "[", "Rn", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"depReactants", "\[NotEqual]", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"depLink", "=", 
          RowBox[{"Take", "[", 
           RowBox[{"Rn", ",", "1", ",", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"Transpose", "[", "Rn", "]"}], "]"}], "-", "1"}]}], 
           "]"}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"cutNum", "[", "a_", "]"}], ":=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"NumberQ", "[", "a", "]"}], ",", "a", ",", "0"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"indNot", "=", 
         RowBox[{"Map", "[", 
          RowBox[{"cutNum", ",", "indReactants"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"depNot", "=", 
         RowBox[{"Map", "[", 
          RowBox[{"cutNum", ",", "depReactants"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<indNot\>\"", ",", "indNot"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<depNot\>\"", ",", "depNot"}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"depsubrhs", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"1", "+", 
           RowBox[{"depLink", ".", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", "indReactants", "}"}], "]"}]}], "-", 
           RowBox[{"depLink", ".", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", "indNot", "}"}], "]"}]}], "-", "depNot"}], "]"}]}], 
        ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"depsubrhs", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"1", "+", 
         RowBox[{"depLink", ".", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", "indReactants", "}"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"depsub", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"depReactants", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
          RowBox[{"depsubrhs", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "depReactants", "]"}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Mr", "=", 
       RowBox[{"Length", "[", "indReactants", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"covMat", "=", 
       RowBox[{"ToExpression", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"StringJoin", "[", 
           RowBox[{
            RowBox[{"ToString", "[", 
             RowBox[{"indReactants", "[", 
              RowBox[{"[", 
               RowBox[{"Min", "[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"ToString", "[", 
             RowBox[{"indReactants", "[", 
              RowBox[{"[", 
               RowBox[{"Max", "[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], "]"}]}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "Mr"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "Mr"}], "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"thirdOCM", "=", 
       RowBox[{"ToExpression", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"StringJoin", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"indReactants", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"Sort", "[", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "j", ",", "k"}], "}"}], "]"}], "[", 
                 RowBox[{"[", "l", "]"}], "]"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"l", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "Mr"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "Mr"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "Mr"}], "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"sysVariables", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{"indReactants", ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"covMat", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "Mr"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "i", ",", "Mr"}], "}"}]}], "]"}]}], "}"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"toMacro", "=", 
       RowBox[{"MacroTransform", "[", 
        RowBox[{"sysVariables", ",", "popSize"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"fullSystem", "\[Equal]", "True"}], ",", 
        RowBox[{
         RowBox[{"newNu", "=", 
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{"popSize", "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"P", "[", 
                RowBox[{"[", "4", "]"}], "]"}], ".", 
               RowBox[{"Q", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "/.", "toMacro"}], 
           "]"}]}], ";"}], ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Substitution:\>\"", ",", "depsub"}], "]"}], ";", 
         RowBox[{"newNu", "=", 
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"popSize", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"P", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ".", 
                RowBox[{"Q", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "/.", "depsub"}], 
            "/.", "toMacro"}], "]"}]}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"corrNu", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"newNu", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"indReactants", "[", 
               RowBox[{"[", "j", "]"}], "]"}], ",", 
              RowBox[{"indReactants", "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], "]"}], "*", 
            RowBox[{"covMat", "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", "k"}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "Mr"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", "Mr"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "Mr"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<newNu: \>\"", ",", 
          RowBox[{"TableForm", "[", "newNu", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<corrNu: \>\"", ",", 
          RowBox[{"TableForm", "[", "corrNu", "]"}]}], "]"}], ";"}], 
       "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Amat", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"newNu", "[", 
              RowBox[{"[", "k", "]"}], "]"}], ",", 
             RowBox[{"indReactants", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "Mr"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "Mr"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"fullSystem", "\[Equal]", "True"}], ",", 
        RowBox[{
         RowBox[{"Bmat", "=", 
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{"popSize", "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"P", "[", 
                RowBox[{"[", "4", "]"}], "]"}], ".", 
               RowBox[{"DiagonalMatrix", "[", 
                RowBox[{"Flatten", "[", 
                 RowBox[{"Q", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ".", 
               RowBox[{"Transpose", "[", 
                RowBox[{"P", "[", 
                 RowBox[{"[", "4", "]"}], "]"}], "]"}]}], ")"}]}], "/.", 
            "toMacro"}], "]"}]}], ";"}], ",", 
        RowBox[{
         RowBox[{"Bmat", "=", 
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"popSize", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"P", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ".", 
                RowBox[{"DiagonalMatrix", "[", 
                 RowBox[{"Flatten", "[", 
                  RowBox[{"Q", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ".", 
                RowBox[{"Transpose", "[", 
                 RowBox[{"P", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ")"}]}], "/.", 
             "depsub"}], "/.", "toMacro"}], "]"}]}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Cmat", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"Bmat", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
                RowBox[{"indReactants", "[", 
                 RowBox[{"[", "k", "]"}], "]"}], ",", 
                RowBox[{"indReactants", "[", 
                 RowBox[{"[", "l", "]"}], "]"}]}], "]"}], "*", 
              RowBox[{"covMat", "[", 
               RowBox[{"[", 
                RowBox[{"k", ",", "l"}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "1", ",", "Mr"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"l", ",", "1", ",", "Mr"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "Mr"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "Mr"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Dmat", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"newNu", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", 
                RowBox[{"indReactants", "[", 
                 RowBox[{"[", "k", "]"}], "]"}], ",", 
                RowBox[{"indReactants", "[", 
                 RowBox[{"[", "l", "]"}], "]"}]}], "]"}], "*", 
              RowBox[{"thirdOCM", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "k", ",", "l"}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "1", ",", "Mr"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"l", ",", "1", ",", "Mr"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "Mr"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "Mr"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Amat :\>\"", ",", 
          RowBox[{"MatrixForm", "[", "Amat", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Bmat :\>\"", ",", 
          RowBox[{"MatrixForm", "[", "Bmat", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Cmat :\>\"", ",", 
          RowBox[{"MatrixForm", "[", "Cmat", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Dmat :\>\"", ",", 
          RowBox[{"MatrixForm", "[", "Dmat", "]"}]}], "]"}], ";"}], 
       "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"First", " ", "order", " ", "cumulants"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"sysEDO1", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ToExpression", "[", 
            RowBox[{"StringJoin", "[", 
             RowBox[{"\"\<d\>\"", ",", 
              RowBox[{"ToString", "[", 
               RowBox[{"indReactants", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], "]"}], 
           "\[Equal]", 
           RowBox[{
            RowBox[{"newNu", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "+", 
            RowBox[{
             RowBox[{"corrNu", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "/", "2"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "Mr"}], "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Second", " ", "order", " ", "cumulants"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"covEDO", "=", 
       RowBox[{
        RowBox[{"Amat", ".", "covMat"}], "+", 
        RowBox[{"covMat", ".", 
         RowBox[{"Transpose", "[", "Amat", "]"}]}], "+", "Bmat", "+", 
        RowBox[{"Cmat", "/", "2"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Dmat", "+", 
           RowBox[{"Transpose", "[", "Dmat", "]"}]}], ")"}], "/", "2"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"covEDO", "=", 
       RowBox[{"Simplify", "[", "covEDO", "]"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Multi", "-", 
        RowBox[{"variate", " ", "normal", " ", 
         RowBox[{"(", "MVN", ")"}], " ", "closure"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"MVNclosure", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[Rule]", "0"}], "&"}], ",", 
         RowBox[{"Flatten", "[", "thirdOCM", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<MVNclosure: \>\"", ",", "MVNclosure"}], "]"}], ";"}], 
       "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"sysEDO2MVN", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ToExpression", "[", 
             RowBox[{"StringJoin", "[", 
              RowBox[{"\"\<d\>\"", ",", 
               RowBox[{"ToString", "[", 
                RowBox[{"covMat", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}]}], "]"}], 
             "]"}], "\[Equal]", 
            RowBox[{"covEDO", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "/.", "MVNclosure"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "Mr"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "i", ",", "Mr"}], "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sysEDOMVN", "=", 
       RowBox[{"Collect", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{"sysEDO1", ",", "sysEDO2MVN"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "\[Beta]", ",", "\[Nu]", ",", "\[Gamma]", ",", "\[CapitalOmega]"}], 
          "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Multi", "-", 
        RowBox[{"variate", " ", "lognormal", " ", 
         RowBox[{"(", "MVL", ")"}], " ", "closure"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"MVLapp", "[", 
        RowBox[{"M_", ",", "C_", ",", "x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "res", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"res", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"C", "[", 
                RowBox[{"[", 
                 RowBox[{"x", ",", "y"}], "]"}], "]"}], 
               RowBox[{"C", "[", 
                RowBox[{"[", 
                 RowBox[{"x", ",", "z"}], "]"}], "]"}], 
               RowBox[{"C", "[", 
                RowBox[{"[", 
                 RowBox[{"y", ",", "z"}], "]"}], "]"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"M", "[", 
                RowBox[{"[", "x", "]"}], "]"}], 
               RowBox[{"M", "[", 
                RowBox[{"[", "y", "]"}], "]"}], 
               RowBox[{"M", "[", 
                RowBox[{"[", "z", "]"}], "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"C", "[", 
                RowBox[{"[", 
                 RowBox[{"x", ",", "z"}], "]"}], "]"}], 
               RowBox[{"C", "[", 
                RowBox[{"[", 
                 RowBox[{"y", ",", "z"}], "]"}], "]"}]}], ")"}], "/", 
             RowBox[{"M", "[", 
              RowBox[{"[", "z", "]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"C", "[", 
                RowBox[{"[", 
                 RowBox[{"x", ",", "y"}], "]"}], "]"}], 
               RowBox[{"C", "[", 
                RowBox[{"[", 
                 RowBox[{"y", ",", "z"}], "]"}], "]"}]}], ")"}], "/", 
             RowBox[{"M", "[", 
              RowBox[{"[", "y", "]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"C", "[", 
                RowBox[{"[", 
                 RowBox[{"x", ",", "z"}], "]"}], "]"}], 
               RowBox[{"C", "[", 
                RowBox[{"[", 
                 RowBox[{"x", ",", "y"}], "]"}], "]"}]}], ")"}], "/", 
             RowBox[{"M", "[", 
              RowBox[{"[", "x", "]"}], "]"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "res", "]"}], ";"}]}], "\[IndentingNewLine]",
         "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"MVLclosure", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ToExpression", "[", 
            RowBox[{"StringJoin", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"ToString", "[", 
                RowBox[{"indReactants", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"Sort", "[", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "j", ",", "k"}], "}"}], "]"}], "[", 
                   RowBox[{"[", "l", "]"}], "]"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"l", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}], 
            "]"}], "\[Rule]", 
           RowBox[{"MVLapp", "[", 
            RowBox[{
            "indReactants", ",", "covMat", ",", "i", ",", "j", ",", "k"}], 
            "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "Mr"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "Mr"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "Mr"}], "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<MVLclosure: \>\"", ",", "MVLclosure"}], "]"}], ";"}], 
       "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"sysEDO2MVL", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ToExpression", "[", 
             RowBox[{"StringJoin", "[", 
              RowBox[{"\"\<d\>\"", ",", 
               RowBox[{"ToString", "[", 
                RowBox[{"covMat", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}]}], "]"}], 
             "]"}], "\[Equal]", 
            RowBox[{"covEDO", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "/.", "MVLclosure"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "Mr"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "i", ",", "Mr"}], "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sysEDOMVL", "=", 
       RowBox[{"Collect", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{"sysEDO1", ",", "sysEDO2MVL"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "\[Beta]", ",", "\[Nu]", ",", "\[Gamma]", ",", "\[CapitalOmega]"}], 
          "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"stateNames", "=", "indReactants"}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{
        "sysEDOMVN", ",", "sysEDOMVL", ",", "sysVariables", ",", "stateNames",
          ",", "covMat"}], "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.508562425676931*^9, 3.508562451662395*^9}, {
   3.508562616894307*^9, 3.5085626315853987`*^9}, {3.5085626768297586`*^9, 
   3.5085627505638514`*^9}, {3.5085627914072104`*^9, 3.508562861420038*^9}, {
   3.508562901810334*^9, 3.508562920964875*^9}, {3.50856300733505*^9, 
   3.508563023355031*^9}, {3.5085630592688503`*^9, 3.508563112008296*^9}, {
   3.508563294500642*^9, 3.508563303710711*^9}, {3.5085633820223618`*^9, 
   3.508563387917309*^9}, {3.508563423204727*^9, 3.508563470807879*^9}, {
   3.5085635018946543`*^9, 3.5085635168451147`*^9}, {3.508563589677704*^9, 
   3.5085636037514133`*^9}, {3.508563757504479*^9, 3.508563803062903*^9}, {
   3.508563859992351*^9, 3.5085638859993973`*^9}, {3.508563950908658*^9, 
   3.5085639760167522`*^9}, {3.508564152886282*^9, 3.508564347441098*^9}, {
   3.5085644164040833`*^9, 3.508564505910637*^9}, {3.508564593499589*^9, 
   3.508564595651429*^9}, 3.508577184275786*^9, 3.5085772224522753`*^9, {
   3.508578237148683*^9, 3.508578291318115*^9}, {3.508578324937591*^9, 
   3.508578435562903*^9}, {3.5085785774473953`*^9, 3.508578578999283*^9}, {
   3.50857861149015*^9, 3.508578625723152*^9}, {3.5085787326930027`*^9, 
   3.508578864317881*^9}, {3.5085788948805513`*^9, 3.508578929699882*^9}, {
   3.508578975648169*^9, 3.5085789826360083`*^9}, 3.508579043177136*^9, {
   3.5085790743909483`*^9, 3.5085791486945972`*^9}, {3.508579295638495*^9, 
   3.508579346107732*^9}, {3.5085794212742653`*^9, 3.508579442378255*^9}, {
   3.508579534671522*^9, 3.508579624270667*^9}, {3.508579665490734*^9, 
   3.508579697526099*^9}, {3.5085797457377243`*^9, 3.508579814649344*^9}, {
   3.50858005878618*^9, 3.5085801358072*^9}, {3.508580421595688*^9, 
   3.508580433528611*^9}, {3.508580590233698*^9, 3.508580687443798*^9}, 
   3.5085808756953993`*^9, {3.5085809436974173`*^9, 3.5085811992173443`*^9}, {
   3.508581229275381*^9, 3.508581232174737*^9}, {3.5085813608311577`*^9, 
   3.508581366372287*^9}, {3.508581412162533*^9, 3.508581414305492*^9}, {
   3.508581446605685*^9, 3.508581500965081*^9}, {3.5085815559362173`*^9, 
   3.508581563861903*^9}, {3.508581640495463*^9, 3.508581641004726*^9}, {
   3.50858167536549*^9, 3.508581677192884*^9}, {3.508581717061356*^9, 
   3.508581745855801*^9}, 3.508581836640073*^9, {3.5190162244401283`*^9, 
   3.519016278297846*^9}, {3.51901634846865*^9, 3.519016371442625*^9}, {
   3.519016742758952*^9, 3.519016841614249*^9}, {3.519016890031357*^9, 
   3.5190168986506653`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Diffusion Approximation", "Section",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.50385865487392*^9, 3.5038586710568533`*^9}, {
  3.508581953660261*^9, 3.5085819697388773`*^9}, {3.542092010282501*^9, 
  3.54209201500732*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DiffApp", "[", 
    RowBox[{
    "myModel_", ",", "myDepReac_", ",", "popSize_", ",", "minSys_", ",", 
     "newOrder_", ",", "assumptions_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "fullSystem", ",", "P", ",", "Q", ",", "Rmat", ",", "lenRea", ",", 
       "lenR", ",", "j", ",", "k", ",", "Rr", ",", "Rn", ",", "ztab", ",", 
       "q", ",", "stateVar", ",", "indLink", ",", "depReactants", ",", 
       "depLink", ",", "indNot", ",", "depNot", ",", "depsubrhs", ",", 
       "depsub", ",", " ", "Avect", ",", " ", "Mr", ",", " ", "allReactants", 
       ",", " ", "posRedReactants", ",", "Amat", ",", " ", "Dmat", ",", 
       "Lmat"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"{", "myDepReac", "}"}], "]"}], "\[Equal]", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"fullSystem", "=", "True"}], ",", 
        RowBox[{"fullSystem", "=", "False"}]}], "]"}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"fullSystem", " ", "=", " ", 
        RowBox[{
        "True", " ", "if", " ", "there", " ", "are", " ", "no", " ", 
         "dependent", " ", "reactions"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Off", "[", 
       RowBox[{"Transpose", "::", "nmtx"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Off", "[", 
       RowBox[{"Dot", "::", "dotsh"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"P", "=", 
       RowBox[{"StochMat", "[", 
        RowBox[{"myModel", ",", "myDepReac", ",", "minSys"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Q", "=", 
       RowBox[{"ReacMat", "[", 
        RowBox[{"myModel", ",", "minSys"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "\"\<P\>\"", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "P", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "\"\<Q\>\"", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "Q", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<P1=\>\"", ",", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"P", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<P2=\>\"", ",", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"P", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<P3=\>\"", ",", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"P", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<P4=\>\"", ",", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"P", "[", 
            RowBox[{"[", "4", "]"}], "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Q1=\>\"", ",", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"Q", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Q2=\>\"", ",", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"Q", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}], ";"}], 
       "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Rmat", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"P", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"Q", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "}"}], "]"}], ",", "2"}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "\"\<Rmat\>\"", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "Rmat", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"lenRea", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"P", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lenR", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"P", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"j", "=", "1"}], ";", 
         RowBox[{"ztab", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", "lenRea"}], "}"}]}], "]"}]}], ";", 
         RowBox[{"q", "=", "1"}], ";", 
         RowBox[{"Rr", "=", 
          RowBox[{"{", "}"}]}], ";", 
         RowBox[{"Rn", "=", 
          RowBox[{"{", "}"}]}], ";"}], ",", 
        RowBox[{"j", "\[LessEqual]", "lenR"}], ",", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"P", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "j"}], "]"}], "]"}], "\[Equal]", 
            RowBox[{"ReplacePart", "[", 
             RowBox[{"ztab", ",", 
              RowBox[{"q", "\[Rule]", "1"}]}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"Rr", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"Rr", ",", 
               RowBox[{"Rmat", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"q", "<", "lenRea"}], ",", 
              RowBox[{"q", "++"}]}], "]"}]}], ",", 
           RowBox[{"Rn", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"Rn", ",", 
              RowBox[{"Rmat", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}]}], "]"}], ";", 
         RowBox[{"j", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"fullSystem", "\[Equal]", "True"}], ",", 
        RowBox[{
         RowBox[{"stateVar", "=", 
          RowBox[{
           RowBox[{"Transpose", "[", "Rmat", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}]}], ";"}], ",", 
        RowBox[{
         RowBox[{"stateVar", "=", 
          RowBox[{
           RowBox[{"Transpose", "[", "Rr", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}]}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"indLink", "=", 
       StyleBox[
        RowBox[{"IdentityMatrix", "[", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"Transpose", "[", "Rr", "]"}], "]"}], "-", "1"}], "]"}], 
        "MR"]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       StyleBox["depReactants", "MR"], 
       StyleBox["=", "MR"], 
       RowBox[{
        RowBox[{"Transpose", "[", "Rn", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"depReactants", "\[NotEqual]", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"depLink", "=", 
          RowBox[{"Take", "[", 
           RowBox[{"Rn", ",", "1", ",", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"Transpose", "[", "Rn", "]"}], "]"}], "-", "1"}]}], 
           "]"}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"depsubrhs", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"1", "+", 
         RowBox[{"depLink", ".", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", "stateVar", "}"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"depsub", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"depReactants", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
          RowBox[{"depsubrhs", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "depReactants", "]"}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"fullSystem", "\[Equal]", "True"}], ",", 
        RowBox[{
         RowBox[{"Avect", "=", 
          RowBox[{"Simplify", "[", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"P", "[", 
              RowBox[{"[", "4", "]"}], "]"}], ".", 
             RowBox[{"Q", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "]"}]}], ";"}], ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Substitution:\>\"", ",", "depsub"}], "]"}], ";", 
         RowBox[{"Avect", "=", 
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"P", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ".", 
              RowBox[{"Q", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/.", "depsub"}], 
           "]"}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"fullSystem", "\[Equal]", "True"}], ",", 
        RowBox[{
         RowBox[{"Dmat", "=", 
          RowBox[{"Simplify", "[", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"P", "[", 
              RowBox[{"[", "4", "]"}], "]"}], ".", 
             RowBox[{"DiagonalMatrix", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"Q", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ".", 
             RowBox[{"Transpose", "[", 
              RowBox[{"P", "[", 
               RowBox[{"[", "4", "]"}], "]"}], "]"}]}], ")"}], "]"}]}], ";"}],
         ",", 
        RowBox[{
         RowBox[{"Dmat", "=", 
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"P", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ".", 
              RowBox[{"DiagonalMatrix", "[", 
               RowBox[{"Flatten", "[", 
                RowBox[{"Q", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ".", 
              RowBox[{"Transpose", "[", 
               RowBox[{"P", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ")"}], "/.", 
            "depsub"}], "]"}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"reorder", " ", "the", " ", "variables"}], ",", " ", 
        RowBox[{
        "matrix", " ", "and", " ", "vector", " ", "according", " ", "to", " ",
          "the", " ", "input", " ", "newOrder"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"setEqualQ", "[", 
         RowBox[{"newOrder", ",", "stateVar"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"newIndex", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"stateVar", ",", "#"}], "]"}], "&"}], ",", 
             "newOrder"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"stateVar", "=", 
          RowBox[{"stateVar", "[", 
           RowBox[{"[", "newIndex", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Avect", "=", 
          RowBox[{"Avect", "[", 
           RowBox[{"[", "newIndex", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Mr", "=", 
          RowBox[{"Length", "[", "stateVar", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tmp", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Dmat", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"newIndex", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"newIndex", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "Mr"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "Mr"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Dmat", "=", "tmp"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<New order: \>\"", ",", "stateVar"}], "]"}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Keep default order: \>\"", ",", "stateVar"}], "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Lmat", "=", 
       RowBox[{
        RowBox[{"1", "/", 
         RowBox[{"Sqrt", "[", "popSize", "]"}]}], "*", 
        RowBox[{"FullSimplify", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"CholeskyDecomposition", "[", "Dmat", "]"}], "]"}], ",", 
          RowBox[{"Assumptions", "\[Rule]", "assumptions"}]}], "]"}]}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<stateVar :\>\"", ",", 
        RowBox[{"MatrixForm", "[", "stateVar", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Avect :\>\"", ",", 
        RowBox[{"MatrixForm", "[", "Avect", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Dmat :\>\"", ",", 
        RowBox[{"MatrixForm", "[", "Dmat", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Lmat :\>\"", ",", 
        RowBox[{"MatrixForm", "[", "Lmat", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"stateVar", ",", "Avect", ",", "Dmat", ",", "Lmat"}], "}"}], 
       "]"}], ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.500814202956324*^9, 3.500814253274349*^9}, 
   3.500816703260749*^9, {3.5008169905542707`*^9, 3.500817044005178*^9}, {
   3.500817141497213*^9, 3.500817241362173*^9}, {3.500817278609146*^9, 
   3.500817314974272*^9}, {3.5008173485836153`*^9, 3.500817361036531*^9}, {
   3.500817412333232*^9, 3.500817493758741*^9}, {3.5008175532467623`*^9, 
   3.500817577167967*^9}, {3.5008180245240192`*^9, 3.500818036157631*^9}, {
   3.500818124311508*^9, 3.500818127125259*^9}, {3.500818256461898*^9, 
   3.5008182733621893`*^9}, {3.5008183914690523`*^9, 
   3.5008184386504993`*^9}, {3.500818529750062*^9, 3.500818544090307*^9}, {
   3.500818644536435*^9, 3.500818661346386*^9}, {3.5008186984079227`*^9, 
   3.5008187145660887`*^9}, {3.500818836900712*^9, 3.5008188830543823`*^9}, {
   3.500818919679946*^9, 3.500818935855049*^9}, {3.500819085561036*^9, 
   3.5008192631196213`*^9}, {3.50082002601724*^9, 3.50082004839575*^9}, {
   3.5015892006708317`*^9, 3.5015892329279537`*^9}, {3.501589271628261*^9, 
   3.501589288018651*^9}, {3.501589334567622*^9, 3.501589346822753*^9}, {
   3.501589410026935*^9, 3.501589420552783*^9}, {3.501589896195101*^9, 
   3.501589897074326*^9}, {3.501589934516415*^9, 3.501590015910177*^9}, {
   3.501590085081457*^9, 3.5015900901317043`*^9}, {3.501590135674244*^9, 
   3.501590186937948*^9}, {3.5015902558530807`*^9, 3.5015902682693853`*^9}, {
   3.5015903657072277`*^9, 3.501590453016349*^9}, {3.501590586054147*^9, 
   3.501590658427402*^9}, {3.501590758210886*^9, 3.501590864630787*^9}, {
   3.5015909496072683`*^9, 3.501590997956476*^9}, {3.501591034593027*^9, 
   3.501591093774575*^9}, {3.5015911474765882`*^9, 3.5015912051086283`*^9}, {
   3.5015912413074827`*^9, 3.501591252808672*^9}, {3.501591283641614*^9, 
   3.501591305735592*^9}, {3.50159133925727*^9, 3.501591377174369*^9}, {
   3.501591474099841*^9, 3.501591526643257*^9}, {3.5015915627989397`*^9, 
   3.50159168930028*^9}, {3.501591722580958*^9, 3.501591723072647*^9}, {
   3.501591767455564*^9, 3.501591777268897*^9}, {3.501591839235797*^9, 
   3.50159196863834*^9}, {3.501592105425858*^9, 3.501592258709094*^9}, {
   3.501592333651495*^9, 3.501592411861868*^9}, {3.5015924493187*^9, 
   3.501592569470077*^9}, {3.5015926876984873`*^9, 3.501592701565598*^9}, {
   3.501592833228506*^9, 3.501592859240447*^9}, {3.501593240898468*^9, 
   3.501593243678808*^9}, {3.501593277618371*^9, 3.501593281362372*^9}, {
   3.501593801410775*^9, 3.501593850503757*^9}, {3.50159390558106*^9, 
   3.50159391676608*^9}, {3.501593950469055*^9, 3.501593961589562*^9}, {
   3.501594123210226*^9, 3.501594125096012*^9}, {3.501594168329073*^9, 
   3.501594209811829*^9}, {3.50159424322575*^9, 3.501594244231522*^9}, {
   3.5015942970973797`*^9, 3.5015943009821243`*^9}, {3.5017567934135923`*^9, 
   3.50175681460049*^9}, {3.501756886229829*^9, 3.501756912225891*^9}, {
   3.501760507408586*^9, 3.5017605764944887`*^9}, {3.50176168905372*^9, 
   3.501761842183104*^9}, {3.501779289499463*^9, 3.501779293283409*^9}, {
   3.501836642092835*^9, 3.501836796785788*^9}, {3.5018368742271214`*^9, 
   3.501836897661233*^9}, {3.501836927683316*^9, 3.501836946976473*^9}, {
   3.501837236898961*^9, 3.5018372422658577`*^9}, {3.5018374106428757`*^9, 
   3.501837427415703*^9}, {3.501837497238186*^9, 3.5018375111145973`*^9}, {
   3.501837934759139*^9, 3.501837935734437*^9}, 3.501838320021544*^9, {
   3.501838376082945*^9, 3.501838478407754*^9}, {3.5018389046502333`*^9, 
   3.5018389055152884`*^9}, 3.5018397885051107`*^9, 3.501840076323604*^9, {
   3.501840458131143*^9, 3.501840470542633*^9}, {3.501840912798571*^9, 
   3.50184091318699*^9}, {3.501840963100153*^9, 3.501841008975113*^9}, {
   3.501841104347001*^9, 3.501841124311014*^9}, {3.5018427588106213`*^9, 
   3.501842759617301*^9}, {3.501842803933488*^9, 3.501842805125291*^9}, {
   3.501843037408782*^9, 3.5018430462215137`*^9}, 3.501844093565434*^9, {
   3.501844539319475*^9, 3.50184467761652*^9}, {3.501844909751954*^9, 
   3.501844918022581*^9}, {3.502709032262999*^9, 3.502709116182613*^9}, {
   3.50270914829482*^9, 3.502709153018046*^9}, {3.5027092064366093`*^9, 
   3.50270935671161*^9}, {3.50270938681321*^9, 3.5027093912289257`*^9}, {
   3.502709504163587*^9, 3.5027095598195343`*^9}, {3.502709602592147*^9, 
   3.502709683768689*^9}, {3.502709731355948*^9, 3.502709739403449*^9}, {
   3.502709799936329*^9, 3.502709828438332*^9}, {3.502709866022735*^9, 
   3.5027098801231194`*^9}, {3.502709916683381*^9, 3.502709916821282*^9}, {
   3.5027099612484703`*^9, 3.502710050256667*^9}, {3.5032202520509872`*^9, 
   3.503220261935375*^9}, {3.5032203092900333`*^9, 3.503220336483589*^9}, {
   3.50322040664935*^9, 3.503220418117881*^9}, {3.503220497955768*^9, 
   3.503220514237865*^9}, {3.503220547681425*^9, 3.503220595867696*^9}, {
   3.503220684211583*^9, 3.503220688947147*^9}, {3.503220795839267*^9, 
   3.503220816530952*^9}, {3.50322084911425*^9, 3.5032209339105988`*^9}, {
   3.503221153207135*^9, 3.503221206965473*^9}, {3.503221243538705*^9, 
   3.503221289570095*^9}, 3.503221376335395*^9, {3.5032214089499598`*^9, 
   3.503221415855123*^9}, {3.5032214659714947`*^9, 3.503221483558918*^9}, {
   3.5032215508755083`*^9, 3.5032215762216988`*^9}, {3.503221609786262*^9, 
   3.50322177039764*^9}, {3.503221830156843*^9, 3.503221876772914*^9}, {
   3.503221924396203*^9, 3.5032219909279222`*^9}, {3.503222098220314*^9, 
   3.5032221303260307`*^9}, {3.503222215087638*^9, 3.503222368818746*^9}, {
   3.503222470512844*^9, 3.503222558063435*^9}, {3.5032226625772257`*^9, 
   3.503222764599165*^9}, {3.503222798833864*^9, 3.503222863794632*^9}, {
   3.503222913461396*^9, 3.5032229669508266`*^9}, {3.5032230002117777`*^9, 
   3.5032230344152117`*^9}, {3.503223130226016*^9, 3.503223136654405*^9}, {
   3.503223494307424*^9, 3.50322351411934*^9}, {3.5032236606193933`*^9, 
   3.503223665484614*^9}, {3.50322416379357*^9, 3.503224165030635*^9}, {
   3.50322425289736*^9, 3.50322425391748*^9}, {3.503224326115527*^9, 
   3.503224401886589*^9}, {3.5032244540134497`*^9, 3.503224456142191*^9}, {
   3.503224743635631*^9, 3.503224763927919*^9}, {3.5032247972332287`*^9, 
   3.503224807645279*^9}, {3.5032248435487967`*^9, 3.503224881257214*^9}, {
   3.5032249725968657`*^9, 3.503225076699244*^9}, {3.503225139400979*^9, 
   3.503225149557029*^9}, {3.5032252088278418`*^9, 3.503225269168787*^9}, {
   3.503225313578712*^9, 3.503225316344367*^9}, {3.503225427442062*^9, 
   3.5032254391243067`*^9}, {3.503225581523946*^9, 3.503225595107964*^9}, {
   3.503225840320819*^9, 3.503225915502914*^9}, {3.50322601926186*^9, 
   3.5032260233870983`*^9}, {3.5032260749401407`*^9, 
   3.5032261236072483`*^9}, {3.503226245196363*^9, 3.503226272101569*^9}, {
   3.5032265102730083`*^9, 3.503226514278317*^9}, {3.503226635935527*^9, 
   3.503226667038439*^9}, {3.50322670825487*^9, 3.5032267554197702`*^9}, {
   3.503226878622574*^9, 3.503226888005927*^9}, {3.503227003674787*^9, 
   3.503227008488118*^9}, {3.5032270563393917`*^9, 3.503227071458201*^9}, {
   3.503227181387896*^9, 3.503227215661654*^9}, {3.503227246647037*^9, 
   3.503227254204567*^9}, {3.503227291832375*^9, 3.503227339986227*^9}, {
   3.5032274897935753`*^9, 3.50322750497127*^9}, {3.5032275416804333`*^9, 
   3.503227567260741*^9}, {3.503227676653788*^9, 3.503227707413381*^9}, {
   3.5032277914630737`*^9, 3.503227794820382*^9}, {3.50322782500597*^9, 
   3.503227925536275*^9}, {3.503228505975463*^9, 3.5032285095740147`*^9}, {
   3.503228794400751*^9, 3.503228799085327*^9}, {3.5032288573319063`*^9, 
   3.503228977314055*^9}, {3.503229067694858*^9, 3.503229116520956*^9}, {
   3.503229240945857*^9, 3.503229259101128*^9}, {3.503229300662578*^9, 
   3.503229352061714*^9}, {3.503229771994917*^9, 3.503229780482964*^9}, {
   3.5032298710559998`*^9, 3.503229899402483*^9}, {3.50322995371657*^9, 
   3.5032299607687273`*^9}, {3.5032303028492393`*^9, 
   3.5032303110948277`*^9}, {3.503230470326502*^9, 3.503230587958315*^9}, {
   3.503230635819048*^9, 3.50323063729051*^9}, {3.503230727876966*^9, 
   3.503230752358171*^9}, {3.503230822689516*^9, 3.503230895187997*^9}, {
   3.503230928694106*^9, 3.503231147263459*^9}, {3.503231291322208*^9, 
   3.5032313211903563`*^9}, {3.503312413335384*^9, 3.503312415298255*^9}, {
   3.503312497990237*^9, 3.503312511223579*^9}, {3.503312553012299*^9, 
   3.503312565369504*^9}, {3.5033126544406843`*^9, 3.503312661849669*^9}, 
   3.503312725240098*^9, {3.503313530574052*^9, 3.503313567862811*^9}, {
   3.503313619196107*^9, 3.5033136208584213`*^9}, {3.503313714984661*^9, 
   3.503313723587675*^9}, 3.503313803802964*^9, {3.50331470179662*^9, 
   3.503314805260847*^9}, {3.503314843186391*^9, 3.5033152248312883`*^9}, {
   3.503915911571391*^9, 3.503915938539248*^9}, {3.5039290495896482`*^9, 
   3.503929053331979*^9}, {3.503929093934103*^9, 3.503929097052113*^9}, {
   3.503929307915305*^9, 3.503929317641646*^9}, {3.503929485284007*^9, 
   3.50392948758808*^9}, {3.504540254656847*^9, 3.5045402735279093`*^9}, {
   3.504540784519569*^9, 3.504540788504834*^9}, {3.505125331301826*^9, 
   3.505125423267878*^9}, {3.505125490756886*^9, 3.505125504944283*^9}, {
   3.505131138471437*^9, 3.505131145262773*^9}, {3.5051341794615593`*^9, 
   3.505134179843864*^9}, {3.508220163709033*^9, 3.5082202020776033`*^9}, {
   3.508220324401371*^9, 3.5082203300390778`*^9}, {3.508220365162839*^9, 
   3.508220376510133*^9}, {3.508505031717572*^9, 3.508505086677404*^9}, {
   3.508555956312378*^9, 3.508555959951187*^9}, {3.508556419144752*^9, 
   3.5085564548369713`*^9}, {3.508556651293191*^9, 3.508556663213809*^9}, {
   3.508557704243528*^9, 3.508557816294629*^9}, {3.5085579388588448`*^9, 
   3.5085579682238903`*^9}, {3.508558060930043*^9, 3.508558065041367*^9}, {
   3.50855810203683*^9, 3.508558313786778*^9}, {3.5085583714713917`*^9, 
   3.5085583766857862`*^9}, {3.508559857378956*^9, 3.508559884459517*^9}, {
   3.508559942917953*^9, 3.508559943237259*^9}, {3.508562325167931*^9, 
   3.508562327165303*^9}, {3.50876525707226*^9, 3.5087652605734043`*^9}, {
   3.5190082826665907`*^9, 3.5190082850469007`*^9}, {3.5190087802066193`*^9, 
   3.519008804537435*^9}, {3.519009298733073*^9, 3.519009357192658*^9}, {
   3.519009416527968*^9, 3.519009524186778*^9}, {3.519009669717607*^9, 
   3.5190096737464333`*^9}, {3.519009756507593*^9, 3.5190097630755243`*^9}, {
   3.51900996867323*^9, 3.519010041284154*^9}, {3.5190100757980947`*^9, 
   3.519010124794989*^9}, {3.519010158793667*^9, 3.519010169344494*^9}, {
   3.519010224529624*^9, 3.519010237856852*^9}, {3.519010340007743*^9, 
   3.519010361636495*^9}, {3.5190112518154583`*^9, 3.5190113417570143`*^9}, {
   3.519011436725338*^9, 3.5190115873422117`*^9}, {3.5190125107547903`*^9, 
   3.519012549269664*^9}, {3.5190125818019953`*^9, 3.519012611651585*^9}, {
   3.51901264872115*^9, 3.519012677499354*^9}, {3.5190127257488127`*^9, 
   3.519012733173991*^9}, {3.519012797105114*^9, 3.519012833456759*^9}, {
   3.519013199158762*^9, 3.5190132150923367`*^9}, {3.519013737510749*^9, 
   3.51901378708852*^9}, {3.519013840343103*^9, 3.519013859843556*^9}, {
   3.519014065990581*^9, 3.5190140993655767`*^9}, {3.519996866498139*^9, 
   3.519996869560082*^9}, {3.521958235508481*^9, 3.521958238065535*^9}, {
   3.524385486091024*^9, 3.524385489579084*^9}, {3.524385713595922*^9, 
   3.5243857249763937`*^9}, {3.5420909741637707`*^9, 3.54209099073094*^9}, {
   3.5420913113870983`*^9, 3.5420913140905247`*^9}, {3.542091938684204*^9, 
   3.542091961281679*^9}, {3.542092020788396*^9, 3.542092102467328*^9}, {
   3.542092186194542*^9, 3.542092240134481*^9}, {3.542093723919176*^9, 
   3.5420937674088173`*^9}, {3.542094563230324*^9, 3.54209457049115*^9}, {
   3.54209464576996*^9, 3.5420946621262903`*^9}, {3.542094699324876*^9, 
   3.542094742304194*^9}, {3.542094775561886*^9, 3.542094833186226*^9}, {
   3.5420948654432364`*^9, 3.542094955242296*^9}, {3.542101531777444*^9, 
   3.542101557181837*^9}, {3.542101693284286*^9, 3.542101701011834*^9}, {
   3.542105071183419*^9, 3.5421050748518553`*^9}, {3.542106495718102*^9, 
   3.542106519461451*^9}, {3.542106551949572*^9, 3.5421066101227818`*^9}, {
   3.542106648589525*^9, 3.542106685745919*^9}, {3.542109114165081*^9, 
   3.5421093359670763`*^9}, {3.542109533939166*^9, 3.54210977695971*^9}, {
   3.542109857071991*^9, 3.542109894122899*^9}, {3.5421100389381638`*^9, 
   3.542110096220475*^9}, {3.542110161609565*^9, 3.542110170424622*^9}, {
   3.542110278851565*^9, 3.5421102890804043`*^9}, {3.542110406129607*^9, 
   3.54211057151763*^9}, {3.5421106685392103`*^9, 3.5421106702854548`*^9}, {
   3.542110723975095*^9, 3.5421107703452473`*^9}, {3.542110801086648*^9, 
   3.542110856445962*^9}, {3.5421109208185673`*^9, 3.542110943470491*^9}, {
   3.542111030388316*^9, 3.54211105891398*^9}, {3.542111212024136*^9, 
   3.542111474515984*^9}, {3.543031971681348*^9, 3.543032004578548*^9}, {
   3.5430392546699*^9, 3.543039283018929*^9}, {3.543044212631835*^9, 
   3.54304422310667*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Examples", "Section",
 CellChangeTimes->{{3.50322127721903*^9, 3.50322127991324*^9}, {
  3.503858721837595*^9, 3.503858724252759*^9}}],

Cell[CellGroupData[{

Cell["SIR model", "Subsection",
 CellChangeTimes->{{3.503858745130529*^9, 3.503858758042487*^9}, 
   3.50386413846111*^9, {3.503864201281396*^9, 3.5038642182930307`*^9}, 
   3.503864282805839*^9, {3.503914977443581*^9, 3.5039149786178703`*^9}, {
   3.505470197674055*^9, 3.5054701995136967`*^9}, {3.507474010170445*^9, 
   3.507474012600816*^9}, {3.508072943396172*^9, 3.508072947819689*^9}, {
   3.518973325030971*^9, 3.518973328124818*^9}}],

Cell[CellGroupData[{

Cell["Model formulation", "Subsubsection",
 CellChangeTimes->{{3.503858998026267*^9, 3.503859017808187*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"modelName", "=", "\"\<SIR\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ishape", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rshape", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SIRmodel", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"MassActErl", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         OverscriptBox[
          RowBox[{"\"\<S\>\"", "\[Rule]", "\"\<I\>\""}], "\"\<I\>\""], ",", 
         "\[Beta]"}], "}"}], ",", "1", ",", "Ishape"}], "]"}], ",", 
     RowBox[{"Erl", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<I\>\"", "\[Rule]", "\"\<R\>\""}], ",", "\[Nu]"}], "}"}],
        ",", "Ishape"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"assumptions", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Se1", ">", "0"}], ",", 
      RowBox[{"Ie1", ">", "0"}], ",", 
      RowBox[{"Re1", ">", "0"}], ",", 
      RowBox[{"\[Beta]", ">", "0"}], ",", 
      RowBox[{"\[Nu]", ">", "0"}], ",", 
      RowBox[{"\[Gamma]", ">", "0"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"tu", " ", "peux", " ", "aussi", " ", 
    RowBox[{"t", "'"}], "amuser", " ", "avec", " ", 
    RowBox[{"\[CCedilla]a", ":"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Erl", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<R\>\"", "\[Rule]", "\"\<S\>\""}], ",", "\[Gamma]"}], 
       "}"}], ",", "Rshape"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[EmptySet]", "\[Rule]", "Se1"}], ",", "\[Mu]"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Se1", "\[Rule]", "\[EmptySet]"}], ",", "\[Mu]"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Ie1", "\[Rule]", "\[EmptySet]"}], ",", "\[Mu]"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Re1", "\[Rule]", "\[EmptySet]"}], ",", "\[Mu]"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"R1", "\[Rule]", "S1"}], ",", "\[Gamma]"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"I1", "\[Rule]", "S1"}], ",", "\[Gamma]"}], "}"}], ",", 
    RowBox[{"Erl", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<S\>\"", "\[Rule]", "\"\<I\>\""}], ",", 
        RowBox[{"\[Beta]", "*", "\[Epsilon]"}]}], "}"}], ",", "1"}], "]"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myModel", "=", 
   RowBox[{"CreateModel", "[", "SIRmodel", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
    RowBox[{"modelName", "<>", "\"\< model:  \>\""}], ",", 
    RowBox[{"TableForm", "[", "myModel", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"TeXForm", "[", "myModel", "]"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.503859022267272*^9, 3.503859121357876*^9}, {
   3.5038603005899343`*^9, 3.5038603055848083`*^9}, {3.5038640569979057`*^9, 
   3.503864061243537*^9}, {3.503864237496333*^9, 3.5038642871930113`*^9}, {
   3.50386433178071*^9, 3.503864423323838*^9}, 3.50386514097641*^9, 
   3.503865520377159*^9, {3.503914987033308*^9, 3.503915006749672*^9}, 
   3.5039168804350243`*^9, 3.503917180519896*^9, {3.5039188172897387`*^9, 
   3.503918848583185*^9}, {3.503918891126548*^9, 3.5039189275592327`*^9}, {
   3.50391902429675*^9, 3.503919024648535*^9}, {3.5039201011011057`*^9, 
   3.5039201019386597`*^9}, {3.503928381302099*^9, 3.5039283821241913`*^9}, {
   3.5039295548584633`*^9, 3.503929555511919*^9}, {3.5039295972097178`*^9, 
   3.5039295975512657`*^9}, {3.50392999384197*^9, 3.503929996552438*^9}, {
   3.5039308653047333`*^9, 3.503930866149879*^9}, 3.5039335149144707`*^9, 
   3.503933622359679*^9, {3.503934277371558*^9, 3.503934278824788*^9}, 
   3.503934416400301*^9, 3.503935276065384*^9, {3.504002646089019*^9, 
   3.504002647491871*^9}, {3.504002836942268*^9, 3.504002837427663*^9}, {
   3.504002896607499*^9, 3.5040029010047407`*^9}, {3.504003000962614*^9, 
   3.5040030016874113`*^9}, {3.5040061204418783`*^9, 3.50400612107161*^9}, {
   3.5044461126801233`*^9, 3.504446113758349*^9}, {3.50444618785183*^9, 
   3.504446188649231*^9}, 3.504446495676833*^9, {3.505103045864646*^9, 
   3.505103047099794*^9}, {3.505103864582054*^9, 3.505103865324728*^9}, {
   3.505104245054082*^9, 3.505104245884164*^9}, {3.5051050319557467`*^9, 
   3.505105033713414*^9}, {3.5051054612676888`*^9, 3.505105462011035*^9}, {
   3.505105755460568*^9, 3.5051057563540697`*^9}, {3.505109218279338*^9, 
   3.505109219980589*^9}, {3.505110001226849*^9, 3.505110002455867*^9}, {
   3.505111530198309*^9, 3.5051115320969152`*^9}, {3.5051197167189007`*^9, 
   3.5051197172540703`*^9}, {3.50512784825399*^9, 3.5051278801259413`*^9}, {
   3.505133989072032*^9, 3.505133989837524*^9}, {3.5051358956270237`*^9, 
   3.505135897760253*^9}, {3.505137374572546*^9, 3.5051373756492434`*^9}, {
   3.505138271017625*^9, 3.505138272047871*^9}, {3.5051427729175*^9, 
   3.5051427735358763`*^9}, {3.5051906098512573`*^9, 3.505190610671092*^9}, {
   3.505372050754636*^9, 3.50537207128763*^9}, {3.505372136176656*^9, 
   3.50537213688588*^9}, {3.505462877534851*^9, 3.505462891263986*^9}, {
   3.505468242789816*^9, 3.505468243372069*^9}, {3.505468504979075*^9, 
   3.505468506335166*^9}, {3.5054689906763887`*^9, 3.505468991911978*^9}, {
   3.5054697664112473`*^9, 3.505469767999443*^9}, {3.505471222659822*^9, 
   3.5054712274759827`*^9}, {3.505471279658731*^9, 3.505471300824974*^9}, {
   3.5054713332974977`*^9, 3.505471342278831*^9}, {3.50547366504744*^9, 
   3.505473770302843*^9}, 3.505478594034131*^9, {3.505478756373755*^9, 
   3.505478779226779*^9}, 3.505479811967811*^9, {3.5072928899699297`*^9, 
   3.507292908231587*^9}, {3.5074740334884653`*^9, 3.5074740339675217`*^9}, {
   3.507474557483212*^9, 3.507474589487465*^9}, {3.507474644854435*^9, 
   3.507474650836193*^9}, {3.5075670232036467`*^9, 3.507567026694827*^9}, {
   3.508049444634857*^9, 3.508049446979166*^9}, {3.5080729507490997`*^9, 
   3.508073014277507*^9}, {3.5082208184872303`*^9, 3.5082208651544323`*^9}, {
   3.50822097348514*^9, 3.508220991248362*^9}, {3.5082332598016653`*^9, 
   3.508233260527316*^9}, {3.50823330987969*^9, 3.508233310542643*^9}, {
   3.508559404603986*^9, 3.5085594063850737`*^9}, {3.508559504269672*^9, 
   3.508559504867083*^9}, {3.508559601550565*^9, 3.5085596019478283`*^9}, {
   3.5150553801881*^9, 3.515055380608342*^9}, {3.51505596141469*^9, 
   3.515055985428459*^9}, {3.515056099845557*^9, 3.5150561001386538`*^9}, {
   3.5150561603314667`*^9, 3.515056160689032*^9}, {3.515059884903595*^9, 
   3.515059886584361*^9}, {3.515060673916522*^9, 3.515060674171661*^9}, {
   3.515062211849927*^9, 3.5150622129849653`*^9}, 3.5150643878362417`*^9, {
   3.5150647756179743`*^9, 3.515064776591717*^9}, {3.515065479459201*^9, 
   3.515065480858795*^9}, {3.51513173319696*^9, 3.515131733866755*^9}, {
   3.515137581502265*^9, 3.515137582217935*^9}, {3.515144915124106*^9, 
   3.515144917185536*^9}, {3.515153890451981*^9, 3.515153891362544*^9}, {
   3.515155121810442*^9, 3.515155122567174*^9}, {3.515155225683505*^9, 
   3.5151552265129557`*^9}, {3.515155790870696*^9, 3.515155791456925*^9}, {
   3.5151584441932898`*^9, 3.515158445126533*^9}, {3.515158684117449*^9, 
   3.515158684907422*^9}, {3.515159097446154*^9, 3.515159098267071*^9}, {
   3.5151607016983137`*^9, 3.515160702439641*^9}, {3.5151726375247717`*^9, 
   3.515172640570359*^9}, {3.515178967801066*^9, 3.5151789697316647`*^9}, {
   3.515183385122834*^9, 3.515183389311871*^9}, {3.51524637789336*^9, 
   3.515246382739459*^9}, {3.515246479934434*^9, 3.5152464818928537`*^9}, {
   3.515246574596964*^9, 3.515246574954603*^9}, {3.51526294000915*^9, 
   3.515262942024782*^9}, {3.5152927282010317`*^9, 3.515292730007978*^9}, {
   3.515298984295508*^9, 3.515298984495076*^9}, {3.515323450385654*^9, 
   3.515323451189445*^9}, {3.51655986612394*^9, 3.516559867996263*^9}, {
   3.517137093908635*^9, 3.517137124648159*^9}, {3.517219080657855*^9, 
   3.51721908618406*^9}, {3.5174765632231197`*^9, 3.517476563619327*^9}, {
   3.5174860303944473`*^9, 3.517486032936713*^9}, {3.518973332876937*^9, 
   3.518973424445551*^9}, 3.51897370790375*^9, {3.519008339192823*^9, 
   3.519008356084858*^9}, {3.519008419639181*^9, 3.519008429710267*^9}, 
   3.5190085952188063`*^9, {3.519014324681898*^9, 3.519014333440147*^9}, {
   3.519014446203442*^9, 3.5190145108625917`*^9}, {3.51901594777169*^9, 
   3.519015953561892*^9}, {3.5256019202584047`*^9, 3.525601920771635*^9}, {
   3.525601999422374*^9, 3.5256020094832077`*^9}, {3.525602568224533*^9, 
   3.5256025738549843`*^9}, {3.52560308310832*^9, 3.525603104492304*^9}, {
   3.527948953773205*^9, 3.52794898710606*^9}, {3.537884684825634*^9, 
   3.53788468619976*^9}, {3.53788472515095*^9, 3.537884732676684*^9}, {
   3.542091152276196*^9, 3.542091158831235*^9}, {3.542111507842339*^9, 
   3.54211156166362*^9}, {3.542111663782318*^9, 3.542111707737369*^9}, {
   3.542112496277895*^9, 3.54211253131561*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"SIR model:  \"\>", "\[InvisibleSpace]", 
   TagBox[GridBox[{
      {
       OverscriptBox[
        RowBox[{"Se1", "\[Rule]", "Ie1"}], "Ie1"], "\[Beta]"},
      {
       RowBox[{"Ie1", "\[Rule]", "Re1"}], "\[Nu]"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Function[BoxForm`e$, 
     TableForm[BoxForm`e$]]]}],
  SequenceForm["SIR model:  ", 
   TableForm[{{
      Overscript[$CellContext`Se1 -> $CellContext`Ie1, $CellContext`Ie1], \
$CellContext`\[Beta]}, {$CellContext`Ie1 -> $CellContext`Re1, $CellContext`\
\[Nu]}}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.515323452382473*^9, 3.5165598700838337`*^9, 3.516978408095312*^9, 
   3.517038303519329*^9, 3.517137129169705*^9, 3.517219390978629*^9, 
   3.517476564380254*^9, 3.51748603941296*^9, {3.518973336602323*^9, 
   3.518973347411072*^9}, 3.518973387593258*^9, 3.518973425700961*^9, 
   3.5189737086811123`*^9, 3.519008358282915*^9, {3.519008420563513*^9, 
   3.5190084306099052`*^9}, 3.519008595770761*^9, 3.5190102879156923`*^9, 
   3.519010398530087*^9, 3.519011405230378*^9, 3.51901198250049*^9, {
   3.519014306626358*^9, 3.51901433423842*^9}, 3.519014513678207*^9, 
   3.519015954571024*^9, 3.5190162014387817`*^9, 3.525601856496311*^9, 
   3.525601928735165*^9, 3.525602010973111*^9, 3.525602469691833*^9, 
   3.5256025757409678`*^9, 3.5256031054086933`*^9, {3.527948976317363*^9, 
   3.527948988019333*^9}, {3.5378847136421022`*^9, 3.5378847346014433`*^9}, 
   3.5420910612941017`*^9, 3.542091160218286*^9, 3.542091744396317*^9, 
   3.542111567620941*^9, {3.5421116851776323`*^9, 3.542111708520423*^9}, 
   3.5421119864540453`*^9, 3.542112543734099*^9, 3.543030513054167*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["DiffApp", "Subsubsection",
 CellChangeTimes->{{3.542092265367395*^9, 3.542092267350608*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"depReac", "=", 
    RowBox[{"lastClass", "[", 
     RowBox[{"\"\<Re\>\"", ",", "Rshape"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"depReac", "=", 
     RowBox[{"{", "}"}]}], ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"minSystem", "=", "False"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DiffApp", "[", 
   RowBox[{
   "myModel", ",", "depReac", ",", "\[CapitalOmega]", ",", "minSystem", ",", 
    RowBox[{"{", 
     RowBox[{"Se1", ",", "Ie1"}], "}"}], ",", "assumptions"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"1", "er", " ", 
     RowBox[{"arg", ":", " ", 
      RowBox[{
      "le", " ", "model", " ", "comme", " ", "sp\[EAcute]cifi\[EAcute]", " ", 
       "plus", " ", "haut"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"2", "e", " ", 
      RowBox[{"arg", ":", " ", 
       RowBox[{"variable", 
        RowBox[{"(", "s", ")"}], " ", 
        RowBox[{"d", "'"}], "\[EAcute]tat", " ", "\[AGrave]", " ", 
        "\[EAcute]liminer", " ", "en", " ", "cas", " ", "de", " ", 
        "d\[EAcute]pendance", " ", 
        RowBox[{"(", 
         RowBox[{
         "par", " ", "exemple", " ", "quand", " ", "la", " ", "taille", " ", 
          "de", " ", "pop", " ", "est", " ", "constante"}], ")"}]}]}]}], ";", 
     " ", "\[IndentingNewLine]", 
     RowBox[{"3", "e", " ", 
      RowBox[{"arg", ":", " ", 
       RowBox[{"taille", " ", "de", " ", "la", " ", "pop"}]}]}]}], ",", " ", 
    RowBox[{"4", "e", " ", 
     RowBox[{"arg", ":", " ", 
      RowBox[{
      "True", " ", "ou", " ", "False", " ", "pour", " ", "r\[EAcute]duire", 
       " ", "automatiquement", " ", "la", " ", "taille", " ", "du", " ", 
       "syst\[EGrave]me", " ", "en", " ", "d\[EAcute]gageant", " ", "les", 
       " ", "variables", "\[IndentingNewLine]", "d\[EAcute]pendantes", " ", 
       RowBox[{"(", 
        RowBox[{"si", " ", 
         RowBox[{"t", "'"}], "as", " ", "pas", " ", "donn\[EAcute]", " ", 
         "de", " ", "2", "e", " ", "argument", " ", "il", " ", 
         "\[EAcute]limine", " ", "automatiquement", " ", "par", " ", "ordre", 
         " ", "alphab\[EAcute]tique"}], ")"}]}]}]}], ",", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"5", "e", " ", 
     RowBox[{"arg", ":", " ", 
      RowBox[{
      "nouvel", " ", "ordre", " ", "pour", " ", "les", " ", "variables", " ", 
       
       RowBox[{"d", "'"}], "\[EAcute]tat", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
         "par", " ", "d\[EAcute]fault", " ", "les", " ", "variables", " ", 
          "sont", " ", "class\[EAcute]es", " ", "par", " ", "ordre", " ", 
          "\[IndentingNewLine]", "alphab\[EAcute]tique"}], ",", " ", 
         RowBox[{
         "cet", " ", "argument", " ", "permet", " ", "de", " ", "les", " ", 
          "r\[EAcute]ordonner", " ", "ainsi", " ", "que", " ", "les", " ", 
          "matrices", " ", "Dmat", " ", "et", " ", "Lmat", " ", "et", " ", 
          "le", " ", "vecteur", " ", "Avect"}]}], ")"}]}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"6", "e", " ", 
     RowBox[{"arg", ":", " ", 
      RowBox[{
      "contraintes", " ", "sur", " ", "les", " ", "variables", " ", "et", " ",
        "les", " ", "param\[EGrave]tres"}]}]}], ",", " ", 
    RowBox[{"permet", " ", "de", " ", 
     RowBox[{"(", "grandement", ")"}], " ", "simplifier", " ", "les", " ", 
     RowBox[{"expr\[EAcute]ssions", "."}]}]}], "\[IndentingNewLine]", 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.5420922552986794`*^9, 3.542092291528366*^9}, {
  3.542105095840239*^9, 3.542105102415271*^9}, {3.542105301570558*^9, 
  3.542105326016346*^9}, {3.5421104954415417`*^9, 3.542110496165914*^9}, {
  3.542110581712935*^9, 3.542110607047827*^9}, {3.5421106832589493`*^9, 
  3.542110687529805*^9}, {3.542110951874976*^9, 3.542111003766129*^9}, {
  3.542111090068675*^9, 3.542111117886533*^9}, {3.542111485390093*^9, 
  3.5421115008635473`*^9}, {3.542111588968837*^9, 3.54211161033353*^9}, {
  3.542111720550886*^9, 3.542111721358267*^9}, {3.542112021027204*^9, 
  3.5421124860667667`*^9}, {3.543032867781974*^9, 3.543032871552137*^9}, {
  3.543033269270369*^9, 3.54303327226902*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "Ie1", ",", "Se1"}], "}"}]], "Print",
 CellChangeTimes->{
  3.542092298218733*^9, 3.542093777204427*^9, 3.542094839260713*^9, {
   3.5420948717032747`*^9, 3.542094921302524*^9}, 3.54210156734844*^9, {
   3.542105089785268*^9, 3.542105106954144*^9}, {3.5421053039141817`*^9, 
   3.542105326806841*^9}, {3.5421104976242733`*^9, 3.542110521550446*^9}, {
   3.542110578866027*^9, 3.542110608007266*^9}, {3.542110679171774*^9, 
   3.542110688187872*^9}, {3.542110748776181*^9, 3.542110776189592*^9}, 
   3.542110861317292*^9, {3.5421109748232307`*^9, 3.542111004561257*^9}, {
   3.542111046569253*^9, 3.542111064185132*^9}, {3.542111097941761*^9, 
   3.542111118746067*^9}, 3.5421114898451147`*^9, {3.54211159604528*^9, 
   3.542111611535727*^9}, 3.5421117245462303`*^9, 3.542111989475625*^9, 
   3.542112547635586*^9, 3.5430305299828777`*^9, 3.5430327352839746`*^9, {
   3.5430328145305033`*^9, 3.543032826752915*^9}, {3.543032872927043*^9, 
   3.5430329002729397`*^9}, 3.543033194024732*^9, 3.5430332734139023`*^9, 
   3.5430333354055357`*^9, 3.543033489539072*^9, 3.543039305427911*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Ie1", ",", "Se1"}], "}"}]], "Print",
 CellChangeTimes->{
  3.542092298218733*^9, 3.542093777204427*^9, 3.542094839260713*^9, {
   3.5420948717032747`*^9, 3.542094921302524*^9}, 3.54210156734844*^9, {
   3.542105089785268*^9, 3.542105106954144*^9}, {3.5421053039141817`*^9, 
   3.542105326806841*^9}, {3.5421104976242733`*^9, 3.542110521550446*^9}, {
   3.542110578866027*^9, 3.542110608007266*^9}, {3.542110679171774*^9, 
   3.542110688187872*^9}, {3.542110748776181*^9, 3.542110776189592*^9}, 
   3.542110861317292*^9, {3.5421109748232307`*^9, 3.542111004561257*^9}, {
   3.542111046569253*^9, 3.542111064185132*^9}, {3.542111097941761*^9, 
   3.542111118746067*^9}, 3.5421114898451147`*^9, {3.54211159604528*^9, 
   3.542111611535727*^9}, 3.5421117245462303`*^9, 3.542111989475625*^9, 
   3.542112547635586*^9, 3.5430305299828777`*^9, 3.5430327352839746`*^9, {
   3.5430328145305033`*^9, 3.543032826752915*^9}, {3.543032872927043*^9, 
   3.5430329002729397`*^9}, 3.543033194024732*^9, 3.5430332734139023`*^9, 
   3.5430333354055357`*^9, 3.543033489539072*^9, 3.543039305429788*^9}],

Cell[BoxData["\<\"P\"\>"], "Print",
 CellChangeTimes->{
  3.542092298218733*^9, 3.542093777204427*^9, 3.542094839260713*^9, {
   3.5420948717032747`*^9, 3.542094921302524*^9}, 3.54210156734844*^9, {
   3.542105089785268*^9, 3.542105106954144*^9}, {3.5421053039141817`*^9, 
   3.542105326806841*^9}, {3.5421104976242733`*^9, 3.542110521550446*^9}, {
   3.542110578866027*^9, 3.542110608007266*^9}, {3.542110679171774*^9, 
   3.542110688187872*^9}, {3.542110748776181*^9, 3.542110776189592*^9}, 
   3.542110861317292*^9, {3.5421109748232307`*^9, 3.542111004561257*^9}, {
   3.542111046569253*^9, 3.542111064185132*^9}, {3.542111097941761*^9, 
   3.542111118746067*^9}, 3.5421114898451147`*^9, {3.54211159604528*^9, 
   3.542111611535727*^9}, 3.5421117245462303`*^9, 3.542111989475625*^9, 
   3.542112547635586*^9, 3.5430305299828777`*^9, 3.5430327352839746`*^9, {
   3.5430328145305033`*^9, 3.543032826752915*^9}, {3.543032872927043*^9, 
   3.5430329002729397`*^9}, 3.543033194024732*^9, 3.5430332734139023`*^9, 
   3.5430333354055357`*^9, 3.543033489539072*^9, 3.543039305470047*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{
  3.542092298218733*^9, 3.542093777204427*^9, 3.542094839260713*^9, {
   3.5420948717032747`*^9, 3.542094921302524*^9}, 3.54210156734844*^9, {
   3.542105089785268*^9, 3.542105106954144*^9}, {3.5421053039141817`*^9, 
   3.542105326806841*^9}, {3.5421104976242733`*^9, 3.542110521550446*^9}, {
   3.542110578866027*^9, 3.542110608007266*^9}, {3.542110679171774*^9, 
   3.542110688187872*^9}, {3.542110748776181*^9, 3.542110776189592*^9}, 
   3.542110861317292*^9, {3.5421109748232307`*^9, 3.542111004561257*^9}, {
   3.542111046569253*^9, 3.542111064185132*^9}, {3.542111097941761*^9, 
   3.542111118746067*^9}, 3.5421114898451147`*^9, {3.54211159604528*^9, 
   3.542111611535727*^9}, 3.5421117245462303`*^9, 3.542111989475625*^9, 
   3.542112547635586*^9, 3.5430305299828777`*^9, 3.5430327352839746`*^9, {
   3.5430328145305033`*^9, 3.543032826752915*^9}, {3.543032872927043*^9, 
   3.5430329002729397`*^9}, 3.543033194024732*^9, 3.5430332734139023`*^9, 
   3.5430333354055357`*^9, 3.543033489539072*^9, 3.543039305555896*^9}],

Cell[BoxData["\<\"Q\"\>"], "Print",
 CellChangeTimes->{
  3.542092298218733*^9, 3.542093777204427*^9, 3.542094839260713*^9, {
   3.5420948717032747`*^9, 3.542094921302524*^9}, 3.54210156734844*^9, {
   3.542105089785268*^9, 3.542105106954144*^9}, {3.5421053039141817`*^9, 
   3.542105326806841*^9}, {3.5421104976242733`*^9, 3.542110521550446*^9}, {
   3.542110578866027*^9, 3.542110608007266*^9}, {3.542110679171774*^9, 
   3.542110688187872*^9}, {3.542110748776181*^9, 3.542110776189592*^9}, 
   3.542110861317292*^9, {3.5421109748232307`*^9, 3.542111004561257*^9}, {
   3.542111046569253*^9, 3.542111064185132*^9}, {3.542111097941761*^9, 
   3.542111118746067*^9}, 3.5421114898451147`*^9, {3.54211159604528*^9, 
   3.542111611535727*^9}, 3.5421117245462303`*^9, 3.542111989475625*^9, 
   3.542112547635586*^9, 3.5430305299828777`*^9, 3.5430327352839746`*^9, {
   3.5430328145305033`*^9, 3.543032826752915*^9}, {3.543032872927043*^9, 
   3.5430329002729397`*^9}, 3.543033194024732*^9, 3.5430332734139023`*^9, 
   3.5430333354055357`*^9, 3.543033489539072*^9, 3.5430393055571947`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Ie1", " ", "Se1", " ", "\[Beta]"}], ",", 
     RowBox[{"Ie1", " ", "\[Nu]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"Ie1", ",", "Re1", ",", "Se1"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{
  3.542092298218733*^9, 3.542093777204427*^9, 3.542094839260713*^9, {
   3.5420948717032747`*^9, 3.542094921302524*^9}, 3.54210156734844*^9, {
   3.542105089785268*^9, 3.542105106954144*^9}, {3.5421053039141817`*^9, 
   3.542105326806841*^9}, {3.5421104976242733`*^9, 3.542110521550446*^9}, {
   3.542110578866027*^9, 3.542110608007266*^9}, {3.542110679171774*^9, 
   3.542110688187872*^9}, {3.542110748776181*^9, 3.542110776189592*^9}, 
   3.542110861317292*^9, {3.5421109748232307`*^9, 3.542111004561257*^9}, {
   3.542111046569253*^9, 3.542111064185132*^9}, {3.542111097941761*^9, 
   3.542111118746067*^9}, 3.5421114898451147`*^9, {3.54211159604528*^9, 
   3.542111611535727*^9}, 3.5421117245462303`*^9, 3.542111989475625*^9, 
   3.542112547635586*^9, 3.5430305299828777`*^9, 3.5430327352839746`*^9, {
   3.5430328145305033`*^9, 3.543032826752915*^9}, {3.543032872927043*^9, 
   3.5430329002729397`*^9}, 3.543033194024732*^9, 3.5430332734139023`*^9, 
   3.5430333354055357`*^9, 3.543033489539072*^9, 3.5430393055587797`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Substitution:\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"Re1", "\[Rule]", 
     RowBox[{"1", "-", "Ie1", "-", "Se1"}]}], "}"}]}],
  SequenceForm[
  "Substitution:", {$CellContext`Re1 -> 
    1 - $CellContext`Ie1 - $CellContext`Se1}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.542092298218733*^9, 3.542093777204427*^9, 3.542094839260713*^9, {
   3.5420948717032747`*^9, 3.542094921302524*^9}, 3.54210156734844*^9, {
   3.542105089785268*^9, 3.542105106954144*^9}, {3.5421053039141817`*^9, 
   3.542105326806841*^9}, {3.5421104976242733`*^9, 3.542110521550446*^9}, {
   3.542110578866027*^9, 3.542110608007266*^9}, {3.542110679171774*^9, 
   3.542110688187872*^9}, {3.542110748776181*^9, 3.542110776189592*^9}, 
   3.542110861317292*^9, {3.5421109748232307`*^9, 3.542111004561257*^9}, {
   3.542111046569253*^9, 3.542111064185132*^9}, {3.542111097941761*^9, 
   3.542111118746067*^9}, 3.5421114898451147`*^9, {3.54211159604528*^9, 
   3.542111611535727*^9}, 3.5421117245462303`*^9, 3.542111989475625*^9, 
   3.542112547635586*^9, 3.5430305299828777`*^9, 3.5430327352839746`*^9, {
   3.5430328145305033`*^9, 3.543032826752915*^9}, {3.543032872927043*^9, 
   3.5430329002729397`*^9}, 3.543033194024732*^9, 3.5430332734139023`*^9, 
   3.5430333354055357`*^9, 3.543033489539072*^9, 3.543039305560066*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"New order: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"Se1", ",", "Ie1"}], "}"}]}],
  SequenceForm["New order: ", {$CellContext`Se1, $CellContext`Ie1}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.542092298218733*^9, 3.542093777204427*^9, 3.542094839260713*^9, {
   3.5420948717032747`*^9, 3.542094921302524*^9}, 3.54210156734844*^9, {
   3.542105089785268*^9, 3.542105106954144*^9}, {3.5421053039141817`*^9, 
   3.542105326806841*^9}, {3.5421104976242733`*^9, 3.542110521550446*^9}, {
   3.542110578866027*^9, 3.542110608007266*^9}, {3.542110679171774*^9, 
   3.542110688187872*^9}, {3.542110748776181*^9, 3.542110776189592*^9}, 
   3.542110861317292*^9, {3.5421109748232307`*^9, 3.542111004561257*^9}, {
   3.542111046569253*^9, 3.542111064185132*^9}, {3.542111097941761*^9, 
   3.542111118746067*^9}, 3.5421114898451147`*^9, {3.54211159604528*^9, 
   3.542111611535727*^9}, 3.5421117245462303`*^9, 3.542111989475625*^9, 
   3.542112547635586*^9, 3.5430305299828777`*^9, 3.5430327352839746`*^9, {
   3.5430328145305033`*^9, 3.543032826752915*^9}, {3.543032872927043*^9, 
   3.5430329002729397`*^9}, 3.543033194024732*^9, 3.5430332734139023`*^9, 
   3.5430333354055357`*^9, 3.543033489539072*^9, 3.5430393055612173`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"stateVar :\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"Se1"},
        {"Ie1"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["stateVar :", 
   MatrixForm[{$CellContext`Se1, $CellContext`Ie1}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.542092298218733*^9, 3.542093777204427*^9, 3.542094839260713*^9, {
   3.5420948717032747`*^9, 3.542094921302524*^9}, 3.54210156734844*^9, {
   3.542105089785268*^9, 3.542105106954144*^9}, {3.5421053039141817`*^9, 
   3.542105326806841*^9}, {3.5421104976242733`*^9, 3.542110521550446*^9}, {
   3.542110578866027*^9, 3.542110608007266*^9}, {3.542110679171774*^9, 
   3.542110688187872*^9}, {3.542110748776181*^9, 3.542110776189592*^9}, 
   3.542110861317292*^9, {3.5421109748232307`*^9, 3.542111004561257*^9}, {
   3.542111046569253*^9, 3.542111064185132*^9}, {3.542111097941761*^9, 
   3.542111118746067*^9}, 3.5421114898451147`*^9, {3.54211159604528*^9, 
   3.542111611535727*^9}, 3.5421117245462303`*^9, 3.542111989475625*^9, 
   3.542112547635586*^9, 3.5430305299828777`*^9, 3.5430327352839746`*^9, {
   3.5430328145305033`*^9, 3.543032826752915*^9}, {3.543032872927043*^9, 
   3.5430329002729397`*^9}, 3.543033194024732*^9, 3.5430332734139023`*^9, 
   3.5430333354055357`*^9, 3.543033489539072*^9, 3.543039305562559*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Avect :\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         RowBox[{
          RowBox[{"-", "Ie1"}], " ", "Se1", " ", "\[Beta]"}]},
        {
         RowBox[{"Ie1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Se1", " ", "\[Beta]"}], "-", "\[Nu]"}], ")"}]}]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["Avect :", 
   MatrixForm[{-$CellContext`Ie1 $CellContext`Se1 $CellContext`\[Beta], \
$CellContext`Ie1 ($CellContext`Se1 $CellContext`\[Beta] - \
$CellContext`\[Nu])}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.542092298218733*^9, 3.542093777204427*^9, 3.542094839260713*^9, {
   3.5420948717032747`*^9, 3.542094921302524*^9}, 3.54210156734844*^9, {
   3.542105089785268*^9, 3.542105106954144*^9}, {3.5421053039141817`*^9, 
   3.542105326806841*^9}, {3.5421104976242733`*^9, 3.542110521550446*^9}, {
   3.542110578866027*^9, 3.542110608007266*^9}, {3.542110679171774*^9, 
   3.542110688187872*^9}, {3.542110748776181*^9, 3.542110776189592*^9}, 
   3.542110861317292*^9, {3.5421109748232307`*^9, 3.542111004561257*^9}, {
   3.542111046569253*^9, 3.542111064185132*^9}, {3.542111097941761*^9, 
   3.542111118746067*^9}, 3.5421114898451147`*^9, {3.54211159604528*^9, 
   3.542111611535727*^9}, 3.5421117245462303`*^9, 3.542111989475625*^9, 
   3.542112547635586*^9, 3.5430305299828777`*^9, 3.5430327352839746`*^9, {
   3.5430328145305033`*^9, 3.543032826752915*^9}, {3.543032872927043*^9, 
   3.5430329002729397`*^9}, 3.543033194024732*^9, 3.5430332734139023`*^9, 
   3.5430333354055357`*^9, 3.543033489539072*^9, 3.543039305564353*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Dmat :\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"Ie1", " ", "Se1", " ", "\[Beta]"}], 
        RowBox[{
         RowBox[{"-", "Ie1"}], " ", "Se1", " ", "\[Beta]"}]},
       {
        RowBox[{
         RowBox[{"-", "Ie1"}], " ", "Se1", " ", "\[Beta]"}], 
        RowBox[{"Ie1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Se1", " ", "\[Beta]"}], "+", "\[Nu]"}], ")"}]}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["Dmat :", 
   MatrixForm[{{$CellContext`Ie1 $CellContext`Se1 $CellContext`\[Beta], \
-$CellContext`Ie1 $CellContext`Se1 $CellContext`\[Beta]}, {-$CellContext`Ie1 \
$CellContext`Se1 $CellContext`\[Beta], $CellContext`Ie1 ($CellContext`Se1 \
$CellContext`\[Beta] + $CellContext`\[Nu])}}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.542092298218733*^9, 3.542093777204427*^9, 3.542094839260713*^9, {
   3.5420948717032747`*^9, 3.542094921302524*^9}, 3.54210156734844*^9, {
   3.542105089785268*^9, 3.542105106954144*^9}, {3.5421053039141817`*^9, 
   3.542105326806841*^9}, {3.5421104976242733`*^9, 3.542110521550446*^9}, {
   3.542110578866027*^9, 3.542110608007266*^9}, {3.542110679171774*^9, 
   3.542110688187872*^9}, {3.542110748776181*^9, 3.542110776189592*^9}, 
   3.542110861317292*^9, {3.5421109748232307`*^9, 3.542111004561257*^9}, {
   3.542111046569253*^9, 3.542111064185132*^9}, {3.542111097941761*^9, 
   3.542111118746067*^9}, 3.5421114898451147`*^9, {3.54211159604528*^9, 
   3.542111611535727*^9}, 3.5421117245462303`*^9, 3.542111989475625*^9, 
   3.542112547635586*^9, 3.5430305299828777`*^9, 3.5430327352839746`*^9, {
   3.5430328145305033`*^9, 3.543032826752915*^9}, {3.543032872927043*^9, 
   3.5430329002729397`*^9}, 3.543033194024732*^9, 3.5430332734139023`*^9, 
   3.5430333354055357`*^9, 3.543033489539072*^9, 3.543039305565978*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Lmat :\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        FractionBox[
         SqrtBox[
          RowBox[{"Ie1", " ", "Se1", " ", "\[Beta]"}]], 
         SqrtBox["\[CapitalOmega]"]], "0"},
       {
        RowBox[{"-", 
         FractionBox[
          SqrtBox[
           RowBox[{"Ie1", " ", "Se1", " ", "\[Beta]"}]], 
          SqrtBox["\[CapitalOmega]"]]}], 
        FractionBox[
         SqrtBox[
          RowBox[{"Ie1", " ", "\[Nu]"}]], 
         SqrtBox["\[CapitalOmega]"]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["Lmat :", 
   MatrixForm[{{($CellContext`Ie1 $CellContext`Se1 $CellContext`\[Beta])^
       Rational[1, 2] $CellContext`\[CapitalOmega]^Rational[-1, 2], 
      0}, {-($CellContext`Ie1 $CellContext`Se1 $CellContext`\[Beta])^
       Rational[1, 2] $CellContext`\[CapitalOmega]^
       Rational[-1, 2], ($CellContext`Ie1 $CellContext`\[Nu])^
       Rational[1, 2] $CellContext`\[CapitalOmega]^Rational[-1, 2]}}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.542092298218733*^9, 3.542093777204427*^9, 3.542094839260713*^9, {
   3.5420948717032747`*^9, 3.542094921302524*^9}, 3.54210156734844*^9, {
   3.542105089785268*^9, 3.542105106954144*^9}, {3.5421053039141817`*^9, 
   3.542105326806841*^9}, {3.5421104976242733`*^9, 3.542110521550446*^9}, {
   3.542110578866027*^9, 3.542110608007266*^9}, {3.542110679171774*^9, 
   3.542110688187872*^9}, {3.542110748776181*^9, 3.542110776189592*^9}, 
   3.542110861317292*^9, {3.5421109748232307`*^9, 3.542111004561257*^9}, {
   3.542111046569253*^9, 3.542111064185132*^9}, {3.542111097941761*^9, 
   3.542111118746067*^9}, 3.5421114898451147`*^9, {3.54211159604528*^9, 
   3.542111611535727*^9}, 3.5421117245462303`*^9, 3.542111989475625*^9, 
   3.542112547635586*^9, 3.5430305299828777`*^9, 3.5430327352839746`*^9, {
   3.5430328145305033`*^9, 3.543032826752915*^9}, {3.543032872927043*^9, 
   3.5430329002729397`*^9}, 3.543033194024732*^9, 3.5430332734139023`*^9, 
   3.5430333354055357`*^9, 3.543033489539072*^9, 3.5430393056078176`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->None,
WindowSize->{1001, 752},
WindowMargins->{{Automatic, 60}, {Automatic, 0}},
ShowSelection->True,
FrontEndVersion->"7.0 for Mac OS X x86 (32-bit) (November 10, 2008)",
StyleDefinitions->FrontEnd`FileName[{"Creative"}, "PastelColor.nb", 
  CharacterEncoding -> "UTF-8"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 278, 6, 113, "Title"],
Cell[CellGroupData[{
Cell[870, 32, 301, 5, 72, "Section",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1196, 41, 149, 3, 37, "Input",
 InitializationCell->True],
Cell[1348, 46, 405, 7, 51, "Print"]
}, Open  ]],
Cell[1768, 56, 53, 1, 37, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[1858, 62, 149, 2, 72, "Section"],
Cell[2010, 66, 2845, 54, 98, "Input"],
Cell[4858, 122, 26, 0, 37, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4921, 127, 212, 3, 72, "Section",
 InitializationCell->True],
Cell[5136, 132, 24049, 572, 1778, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[29222, 709, 148, 2, 72, "Section",
 InitializationCell->True],
Cell[29373, 713, 62929, 1460, 4636, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[92339, 2178, 187, 3, 42, "Section",
 InitializationCell->True],
Cell[92529, 2183, 57556, 1367, 4197, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[150122, 3555, 305, 5, 42, "Section",
 InitializationCell->True,
 InitializationGroup->True],
Cell[150430, 3562, 25495, 507, 1088, "Input",
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[175962, 4074, 225, 4, 42, "Section",
 InitializationCell->True,
 InitializationGroup->True],
Cell[176190, 4080, 29784, 619, 1373, "Input",
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[206011, 4704, 159, 2, 42, "Section",
 InitializationGroup->True],
Cell[206173, 4708, 31275, 762, 1808, "Input",
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[237485, 5475, 263, 5, 42, "Section",
 InitializationCell->True,
 InitializationGroup->True],
Cell[237751, 5482, 27658, 544, 1193, "Input",
 InitializationCell->True,
 InitializationGroup->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[265446, 6031, 140, 2, 72, "Section"],
Cell[CellGroupData[{
Cell[265611, 6037, 442, 6, 34, "Subsection"],
Cell[CellGroupData[{
Cell[266078, 6047, 108, 1, 24, "Subsubsection"],
Cell[CellGroupData[{
Cell[266211, 6052, 9076, 168, 193, "Input"],
Cell[275290, 6222, 2078, 43, 48, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[277417, 6271, 98, 1, 24, "Subsubsection"],
Cell[CellGroupData[{
Cell[277540, 6276, 4304, 96, 233, "Input"],
Cell[CellGroupData[{
Cell[281869, 6376, 1133, 17, 20, "Print"],
Cell[283005, 6395, 1123, 17, 20, "Print"],
Cell[284131, 6414, 1082, 15, 20, "Print"],
Cell[285216, 6431, 1943, 48, 20, "Print"],
Cell[287162, 6481, 1084, 15, 20, "Print"],
Cell[288249, 6498, 1313, 23, 20, "Print"],
Cell[289565, 6523, 1374, 24, 20, "Print"],
Cell[290942, 6549, 1295, 21, 20, "Print"],
Cell[292240, 6572, 1895, 39, 38, "Print"],
Cell[294138, 6613, 2205, 47, 38, "Print"],
Cell[296346, 6662, 2393, 49, 38, "Print"],
Cell[298742, 6713, 2589, 55, 66, "Print"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
